"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[152,313],{28265:(e,n,t)=>{t.d(n,{Z:()=>Z});var a=t(98283),s=t(72539),o=t(503),l=t(47746),r=t(86432),i=t(92794),c=t(66198),p=t(61851),u=t(79410),d=t(58489),g=t(52903);const h=["value","totals","onChange"],w=(0,p.X)([...o.yd]);function Z(e){let{value:n,totals:t,onChange:p}=e,Z=(0,a.Z)(e,h);const f=(0,l.Z)(),m=!(0,r.Z)(f.breakpoints.up("sm"));return(0,g.tZ)(d.Z,Object.assign({exclusive:!0,value:n},Z,{children:o.yd.map((e=>{var a;return(0,g.BX)(i.Z,{value:e,sx:{p:m?1:void 0,minWidth:m?0:"6em",display:"flex",gap:m?0:1},onClick:()=>p(w(n,e)),children:[(0,g.tZ)(u.Z,{src:null==(a=s.CL.weaponTypes)?void 0:a[e],size:2,sideMargin:!0}),(0,g.tZ)(c.Z,{label:t[e],size:"small"})]},e)}))}))}},35072:(e,n,t)=>{t.r(n),t.d(n,{default:()=>$});var a=t(45492),s=t(42745),o=t(503),l=t(92252),r=t(67550),i=t(7671),c=t(13780),p=t(79906),u=t(83249),d=t(41075),g=t(2784),h=t(61877),w=t(11141),Z=t(24264),f=t(66146),m=t(90844),y=t(28265),x=t(25616),v=t(6853),W=t(54578),b=t(7794),C=t(2313),k=t(73501),I=t(52903);const P=g.lazy((()=>Promise.all([t.e(592),t.e(690)]).then(t.bind(t,18571)))),T=(0,g.lazy)((()=>Promise.all([t.e(515),t.e(262),t.e(188)]).then(t.bind(t,64262)))),S={xs:1,sm:2,md:3,lg:3,xl:4},B={xs:10,sm:12,md:24,lg:24,xl:24},E=Object.keys(W.gd);function $(){const{t:e}=(0,w.$G)(["page_weapon","ui","weaponNames_gen"]),{database:n}=(0,g.useContext)(v.t),[t,$]=(0,g.useState)(n.displayWeapon.get());(0,g.useEffect)((()=>n.displayWeapon.follow(((e,n)=>$(n)))),[n]);const[j,z]=(0,g.useState)(!1),[N,X]=(0,a.NW)(),M=(0,g.useRef)(null),[D,O]=(0,g.useState)(0);(0,g.useEffect)((()=>(h.ZP.send({hitType:"pageview",page:"/weapon"}),n.weapons.followAny(((e,n)=>("new"===n||"remove"===n)&&X())))),[X,n]);const A=(0,a.JT)(),U=B[A],_=(0,g.useCallback)((async a=>{const s=n.weapons.get(a);if(!s)return;const o=e(`weaponNames_gen:${s.key}`);window.confirm(e("removeWeapon",{value:o}))&&(n.weapons.remove(a),t.editWeaponId===a&&n.displayWeapon.set({editWeaponId:""}))}),[t.editWeaponId,n,e]),G=(0,g.useCallback)((e=>{n.displayWeapon.set({editWeaponId:e})}),[n]),H=(0,g.useCallback)((e=>{G(n.weapons.new((0,b.xg)(e)))}),[n,G]),[L,V]=(0,g.useState)(""),q=(0,g.useDeferredValue)(L),{sortType:F,ascending:J,weaponType:K,rarity:Q}=t,{weaponIdList:R,totalWeaponNum:Y}=(0,g.useMemo)((()=>{var e;const t=n.weapons.values,a=t.length,o=t.filter((0,s.CZ)({weaponType:K,rarity:Q,name:q},(0,W.Xg)())).sort((0,s.ef)(null!=(e=W.gd[F])?e:[],J,(0,W.Sn)())).map((e=>e.id));return N&&{weaponIdList:o,totalWeaponNum:a}}),[N,n,F,J,Q,K,q]),{weaponIdsToShow:ee,numPages:ne,currentPageIndex:te}=(0,g.useMemo)((()=>{const e=Math.ceil(R.length/U),n=(0,s.re)(D,0,e-1);return{weaponIdsToShow:R.slice(n*U,(n+1)*U),numPages:e,currentPageIndex:n}}),[R,D,U]),ae=R.length!==Y?`${R.length}/${Y}`:`${Y}`,se=(0,g.useCallback)(((e,n)=>{var t;null==(t=M.current)||t.scrollIntoView({behavior:"smooth"}),O(n-1)}),[O,M]),oe=(0,g.useCallback)((()=>n.displayWeapon.set({editWeaponId:""})),[n]),{editWeaponId:le}=t;(0,g.useEffect)((()=>{le&&(n.weapons.get(le)||oe())}),[n,le,oe]);const re=(0,g.useMemo)((()=>(0,C.W)(o.yd,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,x.ub)(t.key).weaponType;e[a].total++,R.includes(n)&&e[a].current++}))))),[n,R]),ie=(0,g.useMemo)((()=>(0,C.W)(o.U1,(e=>Object.entries(n.weapons.data).forEach((([n,t])=>{const a=(0,x.ub)(t.key).rarity;e[a].total++,R.includes(n)&&e[a].current++}))))),[n,R]),ce={count:ne,page:te+1,onChange:se},pe={numShowing:ee.length,total:ae,t:e},ue={sortKeys:[...E],value:F,onChange:e=>n.displayWeapon.set({sortType:e}),ascending:J,onChangeAsc:e=>n.displayWeapon.set({ascending:e})};return(0,I.BX)(r.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,I.tZ)(g.Suspense,{fallback:!1,children:(0,I.tZ)(P,{show:j,onHide:()=>z(!1),onSelect:H})}),(0,I.tZ)(g.Suspense,{fallback:!1,children:(0,I.tZ)(T,{weaponId:le,footer:!0,onClose:oe})}),(0,I.tZ)(Z.Z,{ref:M,children:(0,I.BX)(i.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,I.BX)(r.Z,{display:"flex",flexWrap:"wrap",gap:1,alignItems:"stretch",children:[(0,I.tZ)(y.Z,{onChange:e=>n.displayWeapon.set({weaponType:e}),value:K,totals:re,size:"small"}),(0,I.tZ)(m.Z,{sx:{height:"100%"},onChange:e=>n.displayWeapon.set({rarity:e}),value:Q,totals:ie,size:"small"}),(0,I.tZ)(r.Z,{flexGrow:1}),(0,I.tZ)(c.Z,{autoFocus:!0,size:"small",value:L,onChange:e=>V(e.target.value),label:e("weaponName"),sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})]}),(0,I.tZ)(r.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:(0,I.tZ)(f.Z,{paginationProps:ce,showingTextProps:pe,displaySort:!0,sortByButtonProps:ue})})]})}),(0,I.BX)(g.Suspense,{fallback:(0,I.tZ)(p.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:500}}),children:[(0,I.tZ)(u.Z,{fullWidth:!0,onClick:()=>z(!0),color:"info",startIcon:(0,I.tZ)(l.Z,{}),children:e("page_weapon:addWeapon")}),(0,I.tZ)(d.ZP,{container:!0,spacing:1,columns:S,children:ee.map((e=>(0,I.tZ)(d.ZP,{item:!0,xs:1,children:(0,I.tZ)(k.Z,{weaponId:e,onDelete:_,onEdit:G,canEquip:!0})},e)))})]}),ne>1&&(0,I.tZ)(Z.Z,{children:(0,I.tZ)(i.Z,{children:(0,I.tZ)(r.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:(0,I.tZ)(f.Z,{paginationProps:ce,showingTextProps:pe})})})})]})}},30311:(e,n,t)=>{t.d(n,{Z:()=>l});var a=t(13073),s=t(2784),o=t(6853);function l(e=""){const{database:n}=(0,s.useContext)(o.t);return(0,a.Y)(n.weapons,e)}},7794:(e,n,t)=>{function a(e){switch(e){case"sword":default:return"DullBlade";case"bow":return"HuntersBow";case"claymore":return"WasterGreatsword";case"polearm":return"BeginnersProtector";case"catalyst":return"ApprenticesNotes"}}t.d(n,{Qu:()=>s,mT:()=>a,xg:()=>o});const s=(e="sword")=>o(a(e)),o=e=>({id:"",key:e,level:1,ascension:0,refinement:1,location:"",lock:!1})},2313:(e,n,t)=>{t.d(n,{A:()=>s,W:()=>o});var a=t(42745);function s(e,n){const t=(0,a.vU)(e,(e=>l(e)));return n(t),(0,a.vU)(t,(e=>r(e)))}function o(e,n){const t=l(e);return n(t),r(t)}function l(e){return Object.fromEntries(e.map((e=>[e,{total:0,current:0}])))}function r(e){return(0,a.vU)(e,(({total:e,current:n})=>n===e?`${e}`:`${n}/${e}`))}}}]);