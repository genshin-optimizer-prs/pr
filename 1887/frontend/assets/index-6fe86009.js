import{W as R,f as i,p as a,N as o,q as t,T as w,B as A,X as pt,Y as K,C as g,Z as J,D as W,_ as E,$ as mt,r as yt,a as bt,i as gt,u as S,d as $,v as q,U as v,a0 as j,a1 as xt,a2 as At,a3 as Y,O as L,a4 as wt,a5 as kt,t as vt,a6 as Dt,Q as Ct,R as Z}from"./index-2fe9c882.js";import{u as St,f as _t,s as It,a as Et,d as Tt,S as Pt}from"./StarDisplay-b2caaf19.js";import{u as tt}from"./useDisplayArtifact-53d24a41.js";import{d as et,A as rt,a as Ft,b as Mt,p as $t,c as qt,e as Q}from"./ArtifactSort-8c47aa88.js";import{S as Ut,A as Ot}from"./StatEditorList-3b90e0fc.js";import{d as it}from"./Close-af5ad338.js";import{d as Rt}from"./InfoTooltip-a198404d.js";import{d as Kt,a as Lt}from"./LockOpen-9837f9f4.js";import{d as Wt}from"./Replay-da273378.js";import{S as M}from"./SqBadge-aecc7870.js";import{C as jt}from"./StatIcon-a1f808b6.js";import{C as Bt}from"./ColoredText-bf4e427a.js";import"./DropdownButton-8ba1b17f.js";import"./index-58c2d164.js";import"./SlotIcon-e0fb55c2.js";import"./util-3e22b532.js";import"./ConditionalWrapper-c24dc758.js";import"./BootstrapTooltip-ac564553.js";import"./index-06472ec0.js";import"./CardActionArea-d8895efe.js";import"./Link-fb35f223.js";const zt=r=>r[Math.floor(Math.random()*r.length)];function Vt({pageKey:r,text:e="",modalTitle:n="",children:d}){const[f,h,c]=R(localStorage.getItem(`infoShown_${r}`)!=="true"),[u]=i.useState(Array.isArray(e)?zt(e):e),m=i.useCallback(()=>{c(),localStorage.setItem(`infoShown_${r}`,"true")},[c,r]);return a(K,{children:[a(o,{container:!0,children:[t(o,{item:!0,flexGrow:1,children:t(w,{variant:"caption",pl:1,children:u})}),t(o,{item:!0,xs:"auto",children:t(A,{size:"small",color:"info",variant:"contained",onClick:h,startIcon:t(Rt,{}),children:t(pt,{ns:"ui",key18:"info"})})})]}),t(mt,{containerProps:{maxWidth:"xl"},open:f,onClose:m,children:a(K,{children:[a(g,{sx:{py:1,display:"flex"},children:[t(w,{variant:"h6",children:n}),t(J,{onClick:m,sx:{ml:"auto"},children:t(it,{})})]}),t(W,{}),t(g,{children:t(i.Suspense,{fallback:t(E,{variant:"rectangular",width:"100%",height:500}),children:d})})]})})]})}var B={},Gt=gt;Object.defineProperty(B,"__esModule",{value:!0});var at=B.default=void 0,Ht=Gt(yt()),Nt=bt(),Qt=(0,Ht.default)((0,Nt.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");at=B.default=Qt;const Xt=i.lazy(()=>j(()=>import("./ArtifactFilterDisplay-90c34d73.js").then(r=>r.b),["./ArtifactFilterDisplay-90c34d73.js","./index-2fe9c882.js","./index-ef270dff.css","./useDisplayArtifact-53d24a41.js","./SlotIcon-e0fb55c2.js","./StarDisplay-b2caaf19.js","./DropdownButton-8ba1b17f.js","./ColoredText-bf4e427a.js","./index-58c2d164.js","./SqBadge-aecc7870.js","./LockOpen-9837f9f4.js","./SolidToggleButtonGroup-211fccab.js","./totalUtils-b2c02248.js","./BootstrapTooltip-ac564553.js","./ArtifactStatKeyDisplay-c2c8825a.js","./util-3e22b532.js","./ConditionalWrapper-c24dc758.js","./index-06472ec0.js","./StatIcon-a1f808b6.js"],import.meta.url));function Jt({numShowing:r,total:e,artifactIds:n}){const{t:d}=S(["artifact","ui"]),f=$(),{filterOption:h}=tt(),c=i.useCallback(u=>f.displayArtifact.set({filterOption:{...h,...u}}),[f,h]);return t(i.Suspense,{fallback:t(E,{variant:"rectangular",width:"100%",height:300}),children:t(q,{children:a(g,{children:[a(o,{container:!0,children:[t(o,{item:!0,children:t(w,{variant:"h6",children:t(v,{t:d,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(o,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&a(w,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(o,{item:!0,children:t(A,{size:"small",color:"error",onClick:()=>f.displayArtifact.set({action:"reset"}),startIcon:t(Wt,{}),children:t(v,{t:d,i18nKey:"ui:reset"})})})]}),t(i.Suspense,{fallback:t(E,{variant:"rectangular",width:"100%",height:200}),children:t(Xt,{filterOption:h,filterOptionDispatch:c,filteredIds:n})})]})})})}function Yt({artifactIds:r}){const{t:e}=S(["artifact","ui"]),n=$(),{numDelete:d,numUnequip:f,numUnlock:h,numLock:c}=i.useMemo(()=>{const l=r.map(x=>n.arts.get(x)),p=l.reduce((x,C)=>x+(C.lock?0:1),0),y=l.length-p,k=p,U=l.reduce((x,C)=>x+(C.location?1:0),0);return{numDelete:k,numUnequip:U,numUnlock:p,numLock:y}},[r,n]);return a(o,{container:!0,spacing:1,alignItems:"center",children:[t(o,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!f,onClick:()=>window.confirm(`Are you sure you want to unequip ${f} artifacts currently equipped on characters?`)&&r.map(l=>n.arts.set(l,{location:""})),startIcon:t(at,{}),children:[t(v,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t(M,{sx:{ml:1},color:f?"success":"secondary",children:f})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!d,onClick:()=>window.confirm(`Are you sure you want to delete ${d} artifacts?`)&&r.map(l=>{var p;return!((p=n.arts.get(l))!=null&&p.lock)&&n.arts.remove(l)}),startIcon:t(xt,{}),children:[t(v,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t(M,{sx:{ml:1},color:d?"success":"secondary",children:d})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to unlock ${c} artifacts?`)&&r.map(l=>n.arts.set(l,{lock:!1})),startIcon:t(Kt,{}),children:[t(v,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t(M,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(o,{item:!0,xs:12,sm:6,md:3,children:a(A,{fullWidth:!0,color:"error",disabled:!h,onClick:()=>window.confirm(`Are you sure you want to lock ${h} artifacts?`)&&r.map(l=>n.arts.set(l,{lock:!0})),startIcon:t(Lt,{}),children:[t(v,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t(M,{sx:{ml:1},color:h?"success":"secondary",children:h})]})}),t(o,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(w,{variant:"caption",color:"text.secondary",children:a(v,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function Zt({show:r,onHide:e}){const{t:n}=S("artifact");return t(At,{open:r,onClose:e,children:a(K,{children:[t(jt,{title:a(w,{variant:"h6",flexGrow:1,display:"flex",alignItems:"center",children:[t(et,{sx:{verticalAlign:"text-top",mr:1}}),n`showDup`]}),action:t(J,{onClick:e,children:t(it,{})})}),t(W,{}),t(g,{children:t(te,{})})]})})}function te(){const{t:r}=S("artifact"),e=$(),[n,d]=Y();i.useEffect(()=>e.arts.followAny(d),[d,e]);const f=i.useMemo(()=>{const c=n&&[];let u=e.arts.keys;for(;u.length!==0;){const m=u.shift();if(!m)continue;const _=e.arts.get(m);if(!_)continue;const{duplicated:D}=e.arts.findDups(_,u);if(!D.length)continue;const l=D.map(p=>p.id);c.push([m,...l].sort(p=>{var y;return((y=e.arts.get(p))==null?void 0:y.location)??""?-1:1})),u=u.filter(p=>!l.includes(p))}return c},[e,n]),h=i.useMemo(()=>({}),[]);return a(kt,{spacing:2,children:[f.map(c=>t(q,{sx:{overflowX:"scroll"},children:t(g,{sx:{display:"flex",gap:1},children:c.map(u=>t(L,{sx:{minWidth:300},children:t(rt,{artifactId:u,canEquip:!0,onDelete:()=>e.arts.remove(u),editorProps:h})},u))})},c.join())),!f.length&&t(wt,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const ee=[...Dt];function re({probabilityFilter:r={},setProbabilityFilter:e,disabled:n=!1}){const{t:d}=S("artifact");return a(q,{children:[t(g,{sx:{py:1},children:t(w,{variant:"h6",children:"Roll Probability Calculator"})}),t(W,{}),t(g,{children:a(o,{container:!0,spacing:1,children:[t(o,{item:!0,xs:12,md:6,children:t(vt,{children:t(g,{children:a(w,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",a(Bt,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(o,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(Ut,{statKeys:ee,statFilters:r,setStatFilters:e,disabled:n,label:d("probabilityFilter.label")})})]})})]})}const ie=Z.lazy(()=>j(()=>import("./ArtifactEditor-69de7d07.js"),["./ArtifactEditor-69de7d07.js","./index-2fe9c882.js","./index-ef270dff.css","./ChevronRight-80eb67fc.js","./index-58c2d164.js","./ColoredText-bf4e427a.js","./SqBadge-aecc7870.js","./Close-af5ad338.js","./InfoTooltip-a198404d.js","./BootstrapTooltip-ac564553.js","./LockOpen-9837f9f4.js","./ArtifactRarityDropdown-2923a23a.js","./index-06472ec0.js","./ConditionalWrapper-c24dc758.js","./StarDisplay-b2caaf19.js","./DropdownButton-8ba1b17f.js","./ArtifactStatKeyDisplay-c2c8825a.js","./util-3e22b532.js","./SlotIcon-e0fb55c2.js","./Replay-da273378.js","./StatIcon-a1f808b6.js","./ArtifactSort-8c47aa88.js","./CardActionArea-d8895efe.js","./TextButton-c82c2330.js"],import.meta.url)),ae=Z.lazy(()=>j(()=>import("./index-9e2b75d0.js"),["./index-9e2b75d0.js","./index-2fe9c882.js","./index-ef270dff.css","./Settings-d4161c54.js","./StarDisplay-b2caaf19.js","./DropdownButton-8ba1b17f.js","./ColoredText-bf4e427a.js","./index-58c2d164.js","./SqBadge-aecc7870.js","./ImgFullwidth-eaaf0343.js","./ArtifactSort-8c47aa88.js","./SlotIcon-e0fb55c2.js","./util-3e22b532.js","./ConditionalWrapper-c24dc758.js","./BootstrapTooltip-ac564553.js","./InfoTooltip-a198404d.js","./index-06472ec0.js","./StatIcon-a1f808b6.js","./CardActionArea-d8895efe.js","./Link-fb35f223.js"],import.meta.url)),X={xs:1,sm:2,md:3,lg:3,xl:4},ne={xs:5,sm:6,md:12,lg:12,xl:12};function Ie(){const{t:r}=S(["artifact","ui"]),e=$(),n=tt(),[d,f,h]=R(!1),[c,u,m]=R(!1),_=St(),{sortType:D,effFilter:l,ascending:p,probabilityFilter:y}=n,k=D==="probability",[U,x]=Y(),C=i.useDeferredValue(U),I=i.useMemo(()=>new Set(l),[l]),nt=i.useCallback(s=>e.arts.remove(s),[e]);i.useEffect(()=>(Ct.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>x())),[e,x]);const ot=i.useCallback(s=>e.displayArtifact.set({probabilityFilter:s}),[e]),st=i.useMemo(()=>!e.arts.values.length,[e]),z=i.useMemo(()=>Ft(I,y),[I,y]),V=i.useMemo(()=>Mt(I),[I]),G=i.useDeferredValue(n),H=i.useDeferredValue(y);i.useEffect(()=>{if(k)return e.arts.values.forEach(s=>e.arts.setProbability(s.id,$t(s,H))),()=>e.arts.values.forEach(s=>e.arts.setProbability(s.id,-1))},[e,k,H]);const{artifactIds:b,totalArtNum:T}=i.useMemo(()=>{const{sortType:s=Q[0],ascending:ft=!1,filterOption:ht}=G;let P=e.arts.values;return k&&(P=P.filter(F=>F.probability&&F.probability!==1)),{artifactIds:P.filter(_t(ht,V)).sort(It(qt[s]??[],ft,z)).map(F=>F.id),totalArtNum:P.length,...C}},[G,C,e,z,V,k]),{numShow:N,setTriggerElement:lt}=Et(ne[_],b.length),O=i.useMemo(()=>b.slice(0,N),[b,N]),ct=b.length!==T?`${b.length}/${T}`:`${T}`,dt={numShowing:O.length,total:ct,t:r,namespace:"artifact"},ut={sortKeys:[...Q],value:D,onChange:s=>e.displayArtifact.set({sortType:s}),ascending:p,onChangeAsc:s=>e.displayArtifact.set({ascending:s})};return a(L,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(i.Suspense,{fallback:!1,children:t(ie,{artifactIdToEdit:d?"new":"",cancelEdit:h,allowUpload:!0,allowEmpty:!0})}),t(i.Suspense,{fallback:!1,children:t(Zt,{show:c,onHide:m})}),t(Vt,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(ae,{})}),st&&t(Ot,{}),t(Jt,{numShowing:b.length,total:T,artifactIds:b}),t(q,{children:a(g,{children:[t(L,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(Pt,{showingTextProps:dt,sortByButtonProps:ut})}),t(Yt,{artifactIds:b})]})}),k&&t(re,{probabilityFilter:y,setProbabilityFilter:ot}),a(o,{container:!0,columns:X,spacing:1,children:[t(o,{item:!0,xs:!0,children:t(A,{fullWidth:!0,onClick:f,color:"info",startIcon:t(Tt,{}),children:r`addNew`})}),t(o,{item:!0,xs:1,children:t(A,{fullWidth:!0,onClick:u,color:"info",startIcon:t(et,{}),children:r`showDup`})})]}),a(i.Suspense,{fallback:t(E,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[t(o,{container:!0,spacing:1,columns:X,children:O.map(s=>t(o,{item:!0,xs:1,children:t(rt,{artifactId:s,effFilter:I,onDelete:nt,editorProps:{},canEquip:!0})},s))}),b.length!==O.length&&t(E,{ref:s=>{s&&lt(s)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}export{Ie as default};
