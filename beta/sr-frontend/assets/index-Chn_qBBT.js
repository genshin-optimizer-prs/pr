import{c as f,j as x,i as X,k as Y,m as R,q as a,n as e,H as s,X as m,aG as O,G as l,aW as F,L as w,N as Q,r as o,cD as Z,Y as p,bH as ee,E as S,K as u,W as te,cE as ae}from"./index-s80YPb2n.js";import{u as ne}from"./useBoolState-BG4uby9J.js";const oe=f(x.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),re=f(x.jsx("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download"),se=f(x.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),le=f(x.jsx("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var k={},ce=Y;Object.defineProperty(k,"__esModule",{value:!0});var V=k.default=void 0,ie=ce(X()),de=x,ue=(0,ie.default)((0,de.jsx)("path",{d:"M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"}),"ContentPaste");V=k.default=ue;function he(){const{t:c}=R("page_settings");return a(w,{bgt:"light",children:[e(m,{sx:{py:1},children:e(s,{variant:"subtitle1",children:c`DatabaseCard.title`})}),e(O,{}),e(m,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(l,{container:!0,spacing:2,columns:{xs:1,md:2},children:F(0,3).map(b=>e(l,{item:!0,xs:1,children:e(pe,{index:b})},b))})})]})}function pe({index:c}){const{databases:b,database:g,setDatabase:E}=Q(),t=b[c],[{name:r,lastEdit:j},I]=o.useState(t.dbMeta.get());o.useEffect(()=>t.dbMeta.follow((h,v)=>I(v)),[t]),o.useEffect(()=>I(t.dbMeta.get()),[t]);const i=g===t,[K,L,M]=ne(),{t:n}=R("page_settings"),_=t.chars.keys.length,B=t.relics.keys.length,W=t.lightCones.keys.length,z=t.teams.keys.length,T=t.builds.keys.length,C=!!(_||B||W||z||T),$=o.useCallback(()=>navigator.clipboard.writeText(JSON.stringify(t.exportSROD())).then(()=>alert("Copied database to clipboard.")).catch(console.error),[t]),N=o.useCallback(()=>{window.confirm(`Are you sure you want to delete "${r}"?`)&&(t.clear(),t.toExtraLocalDB())},[t,r]),G=o.useCallback(()=>{const v=new Date().toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),U=JSON.stringify(t.exportSROD()),A=`${r.trim().replaceAll(" ","_")}_${v}.json`,J="application/json;charset=utf-8",d=document.createElement("a");d.download=A,d.href=`data:${J},${encodeURIComponent(U)}`,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d)},[t,r]),q=o.useCallback(()=>{i||(g.toExtraLocalDB(),t.swapStorage(g),E(c,t))},[c,E,g,i,t]),[y,H]=o.useState(r);o.useEffect(()=>H(r),[r]);const D=o.useCallback(()=>{t.dbMeta.set({name:y}),t.toExtraLocalDB()},[y,t]),P=o.useCallback(h=>h.key==="Enter"&&D(),[D]);return a(w,{sx:{height:"100%",boxShadow:i?"0px 0px 0px 2px green inset":void 0},children:[a(m,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[e(Z,{value:y,sx:{borderRadius:1,px:1,flexGrow:1},onChange:h=>H(h.target.value),onBlur:D,onKeyDown:P}),!i&&e(p,{startIcon:e(se,{}),onClick:q,color:"warning",children:n`DatabaseCard.button.swap`}),e(ee,{color:i?"success":"secondary",sx:{alignSelf:"center"},label:i?n`DatabaseCard.currentDB`:`${n`DatabaseCard.title`} ${t.dbIndex}`})]}),e(O,{}),e(m,{children:a(S,{display:"flex",gap:2,children:[a(S,{flexGrow:1,children:[a(s,{noWrap:!0,children:[e(u,{t:n,i18nKey:"count.chars"})," ",e("strong",{children:_})]}),a(s,{noWrap:!0,children:[e(u,{t:n,i18nKey:"count.relics"})," ",e("strong",{children:B})]}),a(s,{noWrap:!0,children:[e(u,{t:n,i18nKey:"count.lightCones"})," ",e("strong",{children:W})]}),a(s,{noWrap:!0,children:[e(u,{t:n,i18nKey:"count.teams"})," ",e("strong",{children:z})]}),a(s,{noWrap:!0,children:[e(u,{t:n,i18nKey:"count.builds"})," ",e("strong",{children:T})]})]}),a(S,{children:[a(l,{container:!0,spacing:1,columns:{xs:2},children:[e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!C,color:"info",onClick:$,startIcon:e(V,{}),children:e(u,{t:n,i18nKey:"DatabaseCard.button.copy"})})}),a(l,{item:!0,xs:1,children:[e(te,{open:K,onClose:M,children:e(ae,{index:c,onReplace:M})}),e(p,{fullWidth:!0,component:"span",color:"info",startIcon:e(le,{}),onClick:L,children:n`DatabaseCard.button.upload`})]}),e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!C,onClick:G,startIcon:e(re,{}),children:n`DatabaseCard.button.download`})}),e(l,{item:!0,xs:1,children:e(p,{fullWidth:!0,disabled:!C,color:"error",onClick:N,startIcon:e(oe,{}),children:n`DatabaseCard.button.delete`})})]}),!!j&&e(s,{noWrap:!0,align:"center",style:{paddingTop:"1.5em"},children:e("strong",{children:new Date(j).toLocaleString()})})]})]})})]})}function be(){return e(w,{sx:{my:1},children:e(m,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(he,{})})})}export{be as default};
