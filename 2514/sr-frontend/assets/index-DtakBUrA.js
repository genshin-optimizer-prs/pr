import{N as k,r as p,al as $e,am as E,an as ze,n as e,ao as Oe,ap as Pe,m as S,ak as ie,U as ce,V as le,q as h,ac as Ne,E as g,H as x,X as _,L as B,I as Q,aq as J,W as de,ar as Le,as as Z,Y as L,F as ue,at as W,S as he,au as We,av as Ae,ab as M,B as Ee,aw as qe,ax as Ke,ay as F,az as A,G as T,aA as je,aa as ee,aB as pe,aC as me,aD as Ge,aE as Ve,aF as te,aG as Re,$ as ge,aH as Je,aI as Fe,aJ as ae}from"./index-DmKSsOiz.js";import{u as H,a as He,b as Ue,c as Xe,d as Qe,e as X,T as ne,f as Ye,C as Ze,t as fe,N as Ce,I as be,g as et,h as tt,S as at,i as nt,B as ot,M as st,L as rt,j as it,k as ct,D as lt,l as dt,A as q,m as K,n as j,o as G,p as ut}from"./TrendingUp-DNCvAftj.js";import{c as ht,u as xe,S as N,b as z,C as pt,a as mt}from"./CharacterEditor-BNb-RfFK.js";import{s as gt,t as ft,w as Ct,c as bt,l as xt,r as yt,a as kt}from"./index-BvCLiwi-.js";import{d as ye}from"./Close-CJWERuBR.js";import{C as ke}from"./CardActionArea-f5uXYp6j.js";import{C as ve}from"./useForceUpdate-CMXwZ7hf.js";import{u as vt}from"./useBoolState-Znd4gpyK.js";import{M as I,D as O}from"./DropdownButton-BL3_ie1Q.js";import{D as Te,a as Tt}from"./LocationAutocomplete-_6haSHfn.js";import{I as St}from"./InfoTooltip-CtcH4gbg.js";import"./index-DqGSnlAP.js";const Dt=ht(),wt=Dt;function Se(t){const{database:a}=k();return H(a.loadouts,t??"")}function De(t){const{database:a}=k();return H(a.teams,t)}function _t({teamId:t,currentChar:a,children:o}){const{database:s}=k(),l=De(t),d=V(l.loadoutMetadata[0]),r=V(l.loadoutMetadata[1]),u=V(l.loadoutMetadata[2]),i=V(l.loadoutMetadata[3]),n=p.useMemo(()=>gt([...ft(l.loadoutMetadata.map(m=>{var f;return((f=s.loadouts.get(m==null?void 0:m.loadoutId))==null?void 0:f.key)??void 0}).filter($e)),...d?R(d):[],...r?R(r):[],...u?R(u):[],...i?R(i):[],E.common.lvl.add(80),E.common.res.add(.1),E.common.isBroken.add(0),E.common.maxToughness.add(100),ze.common.critMode.add("avg")]),[d,r,u,i,l.loadoutMetadata,s]),c=p.useMemo(()=>(a&&(n==null?void 0:n.withTag({src:a,dst:a})))??null,[n,a]);return e(Oe.Provider,{value:c,children:o})}function V(t){const a=Se(t==null?void 0:t.loadoutId),o=xe(a==null?void 0:a.key),s=He(t==null?void 0:t.buildId),l=Ue(s==null?void 0:s.lightConeId),d=Xe(s==null?void 0:s.relicIds),r=p.useMemo(()=>Object.fromEntries(Object.entries((a==null?void 0:a.conditional)??{}).map(([u,i])=>[u,i])),[a]);return p.useMemo(()=>({character:o,lightCone:l,relics:d,conditionals:r,bonusStats:(a==null?void 0:a.bonusStats)??[]}),[o,l,d,r,a])}function R({character:t,lightCone:a,relics:o,conditionals:s,bonusStats:l}){return t?[...Ct(t.key,...bt(t),...xt(a),...yt(Object.values(o).filter(r=>!!r).map(r=>({set:r.setKey,stats:[...r.substats.filter(({key:u})=>u!=="").map(u=>({key:u.key,value:u.accurateValue})),{key:r.mainStatKey,value:r.mainStatVal}]}))),...l.map(({tag:r,value:u})=>({tag:{...r},value:Pe(u)}))),...kt(t.key,s)]:[]}function Bt({teamId:t,charKey:a,tab:o=""}){const{t:s}=S("page_team"),l=ie(),{database:d}=k(),r=d.teams.get(t),{loadoutMetadata:u}=r,i=ce(),n=le(i.breakpoints.down("md")),[c,m]=p.useState(!1),f=C=>{d.teams.set(t,{name:C})},v=C=>{d.teams.set(t,{description:C})};return h(g,{sx:()=>({borderBottom:"1px rgb(200,200,200,0.3) solid","& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"},"& .Mui-selected":{color:"white !important"},"& .MuiTabs-indicator":{height:"4px",backgroundColor:"rgb(200,200,200,0.5)"}}),children:[e(ke,{onClick:()=>m(!0),children:e(Ne,{placement:"top",title:h(g,{children:[h(g,{sx:{display:"flex",color:"info.light",gap:1},children:[e(Qe,{}),e(x,{children:e("strong",{children:s`team.editNameDesc`})})]}),!!r.description&&e(x,{children:r.description})]}),children:e(_,{sx:{display:"flex",justifyContent:"center","&:hover":{color:"info.light"}},children:h(x,{variant:"h5",sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",textShadow:"#000 0 0 10px !important"},children:[e(X,{}),r.name]})})})}),e(de,{open:c,onClose:()=>m(!1),children:h(B,{children:[e(ve,{title:s`team.editNameDesc`,avatar:e(X,{}),titleTypographyProps:{variant:"h6"},action:e(Q,{onClick:()=>m(!1),children:e(ye,{})})}),e(J,{}),e(_,{children:h(g,{display:"flex",flexDirection:"column",gap:2,sx:{mt:2},children:[e(ne,{label:s`team.name`,value:r.name,onChange:C=>f(C),autoFocus:!0}),e(ne,{label:s`team.desc`,value:r.description,onChange:C=>v(C),multiline:!0,minRows:4})]})})]})}),e(J,{}),h(Le,{variant:"fullWidth",value:a??"team",orientation:n?"vertical":"horizontal",children:[e(Z,{icon:e(X,{}),iconPosition:"start",value:"team",label:"Team Settings",onClick:()=>l(`/teams/${t}/`)}),u.map((C,b)=>{var D;const y=C&&((D=d.loadouts.get(C==null?void 0:C.loadoutId))==null?void 0:D.key);return e(Z,{icon:e(Ye,{}),iconPosition:"start",value:y??b,disabled:!u[b],label:y?e(x,{children:s(`charNames_gen:${y}`)}):`Character ${b+1}`,onClick:()=>y&&l(`/teams/${t}/${y}/${o}`)},b)})]})]})}function Mt({teamId:t}){const{database:a}=k(),o=a.teams.get(t);return h(g,{children:[t,o.loadoutMetadata.map((s,l)=>e(It,{loadoutMetadataIndex:l,teamId:t},`${l}_${s==null?void 0:s.loadoutId}`))]})}function It({loadoutMetadataIndex:t,teamId:a}){var u;const{database:o}=k(),s=o.teams.get(a),l=(u=s.loadoutMetadata[t])==null?void 0:u.loadoutId,d=o.loadouts.get(l);function r(i){if(i===""){o.teams.set(a,c=>c.loadoutMetadata[t]=void 0);return}o.chars.getOrCreate(i);const n=s.loadoutMetadata.findIndex(c=>{var m;return c&&((m=o.loadouts.get(c.loadoutId))==null?void 0:m.key)===i});if(n===-1){let c=o.loadouts.keys.find(m=>o.loadouts.get(m).key===i);c||(c=o.loadouts.new(i)),o.teams.set(a,m=>{m.loadoutMetadata[t]={loadoutId:c}})}else{if(n===t)return;const c=s.loadoutMetadata[n],m=s.loadoutMetadata[t];o.teams.set(a,f=>{f.loadoutMetadata[t]=c,f.loadoutMetadata[n]=m})}}return e(Ze,{charKey:(d==null?void 0:d.key)??"",setCharKey:r})}function $t(){const[t,a,o]=vt();return h(ue,{children:[e(L,{onClick:a,children:"Bonus Stats"}),e(zt,{open:t,onClose:o})]})}function zt({open:t,onClose:a}){const{database:o}=k(),{loadout:{bonusStats:s},loadoutId:l}=p.useContext(W),d=r=>{const u=Ot(r);o.loadouts.set(l,i=>{i.bonusStats.push({tag:u,value:0})})};return e(de,{open:t,onClose:a,children:h(B,{children:[e(ve,{title:"Bonus Stats"}),e(J,{}),e(_,{children:h(N,{spacing:1,children:[s.map(({tag:r,value:u},i)=>e(Lt,{tag:r,value:u,setValue:n=>{o.loadouts.set(l,c=>{c.bonusStats[i].value=n})},onDelete:()=>{o.loadouts.set(l,n=>{n.bonusStats.splice(i,1)})},setTag:n=>{o.loadouts.set(l,c=>{c.bonusStats[i].tag=n})}},JSON.stringify(r)+i)),e(Nt,{onSelect:d})]})})]})})}function Ot(t){return{et:"own",q:t,qt:"premod",sheet:"agg"}}const Pt=["hp","hp_","def","def_","atk","atk_","spd","spd_","dmg_","enerRegen_","brEffect_","crit_","crit_dmg_","eff_","eff_res_","heal_"];function Nt({tag:t={},onSelect:a}){var o;return e(O,{title:(t&&((o=fe.subset(t)[0])==null?void 0:o.title))??"Add Bonus Stat",children:Pt.map(s=>e(I,{onClick:()=>a(s),children:s},s))})}function Lt({tag:t,setTag:a,value:o,setValue:s,onDelete:l}){var r;const d=(r=t.name||t.q)==null?void 0:r.endsWith("_");return e(B,{bgt:"light",children:h(_,{sx:{display:"flex",gap:1,justifyContent:"space-around"},children:[e(he,{sx:{m:"auto"},children:t.q}),t.q==="dmg_"&&e(Wt,{tag:t,setElementalType:u=>{const{elementalType:i,...n}=t;a(u?{...n,elementalType:u}:n)}}),e(Ce,{float:!0,value:o,sx:{flexBasis:150,flexGrow:1,height:"100%"},onChange:s,placeholder:"Stat Value",size:"small",inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:h(be,{position:"end",sx:{ml:0},children:[d?"%":void 0," ",e(Q,{"aria-label":"Delete Bonus Stat",onClick:l,edge:"end",children:e(Te,{fontSize:"small"})})]})}})]})})}function Wt({tag:t,setElementalType:a}){return h(O,{title:t.elementalType??"No Element",children:[e(I,{onClick:()=>a(null),children:"No Element"}),We.map(o=>e(I,{onClick:()=>a(o),children:o},o))]})}function oe({tag:t}){var a;return e(Ae,{color:et(t),children:((a=fe.subset(t)[0])==null?void 0:a.title)||t.name||t.q})}function Y({optTarget:t,setOptTarget:a,buttonProps:o={}}){const{t:s}=S("optimize"),l=z();return e(O,{title:h(g,{sx:{display:"flex",gap:1},children:[s("optTarget"),t?e(oe,{tag:t}):null]}),...o,children:l==null?void 0:l.listFormulas(M.listing.formulas).map((d,r)=>h(I,{onClick:()=>a(d.tag),children:[e(Tt,{children:e(oe,{tag:d.tag})}),e(g,{sx:{display:"flex",gap:1,ml:1},children:tt(d.tag).map(u=>e(he,{children:u},u))})]},`${r}_${d.tag.sheet||d.tag.q}_${d.tag.name}`))})}function At({statFilters:t,setStatFilters:a,disabled:o=!1}){const s=p.useCallback((i,n)=>{const c=structuredClone(t);typeof n>"u"?c.push({tag:i,value:0,isMax:!1,disabled:!1}):c[n].tag=i,a(c)},[a,t]),l=p.useCallback(i=>{const n=structuredClone(t);n.splice(i,1),a(n)},[a,t]),d=p.useCallback((i,n)=>{const c=structuredClone(t);c[i].value=n,a(c)},[a,t]),r=p.useCallback((i,n)=>{const c=structuredClone(t);c[i].isMax=n,a(c)},[a,t]),u=p.useCallback((i,n)=>{const c=structuredClone(t);c[i].disabled=n,a(c)},[a,t]);return h(g,{display:"flex",flexDirection:"column",gap:1,children:[t.map((i,n)=>e(Et,{statFilter:i,setTarget:c=>s(c,n),delTarget:()=>l(n),setTargetValue:c=>d(n,c),setTargetisMax:c=>r(n,c),setDisabled:c=>u(n,c),disabled:o},n+JSON.stringify(i))),e(Y,{setOptTarget:i=>s(i)})]})}function Et({statFilter:t,setTarget:a,delTarget:o,setTargetValue:s,setTargetisMax:l,setDisabled:d,disabled:r}){var f;const{tag:u,value:i,isMax:n,disabled:c}=t,m=(f=u.name||u.q)==null?void 0:f.endsWith("_");return h(g,{sx:{display:"flex",gap:1},children:[h(Ee,{sx:{"& .MuiButtonGroup-grouped":{minWidth:24},width:"100%",flexGrow:1},children:[e(L,{color:c?"secondary":"success",onClick:()=>d(!c),disabled:r,size:"small",children:c?e(qe,{}):e(Ke,{})}),e(Y,{optTarget:u,setOptTarget:a,buttonProps:{sx:{flexGrow:1},size:"small"}}),e(L,{onClick:()=>l(!n),size:"small",children:e("strong",{children:n?"<=":">="})})]}),e(Ce,{float:!0,value:i,sx:{flexBasis:150,flexGrow:1,height:"100%"},disabled:r,onChange:s,placeholder:"Stat Value",size:"small",inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:h(be,{position:"end",sx:{ml:0},children:[m?"%":void 0," ",e(Q,{"aria-label":"Delete Stat Constraint",onClick:o,edge:"end",children:e(Te,{fontSize:"small"})})]})}})]})}function qt({disabled:t=!1}){const{t:a}=S("page_character_optimize"),{loadout:{optConfigId:o}}=p.useContext(W),{database:s}=k(),{statFilters:l}=H(s.optConfigs,o),d=p.useCallback(r=>s.optConfigs.set(o,{statFilters:r}),[s,o]);return e(g,{children:h(B,{bgt:"light",children:[e(_,{sx:{display:"flex",gap:1,justifyContent:"space-between",flexDirection:"column"},children:h(g,{display:"flex",justifyContent:"space-between",children:[e(x,{sx:{fontWeight:"bold"},children:a`constraintFilter.title`}),e(St,{title:e(x,{children:a`constraintFilter.tooltip`})})]})}),e(J,{}),e(At,{statFilters:l,setStatFilters:d,disabled:t})]})})}function Kt({numWorkers:t,setNumWorkers:a}){const{t:o}=S("optimize"),s=navigator.hardwareConcurrency||8;return e(O,{title:`${o("numWorkers")}: ${t}`,children:F(1,s).map(l=>e(I,{onClick:()=>a(l),children:o("workers",{count:l})},l))})}function jt(){const{t}=S("optimize"),{database:a}=k(),o=z(),[s,l]=p.useState(8),[d,r]=p.useState(void 0),{loadout:u}=p.useContext(W),i=H(a.optConfigs,u.optConfigId),n=i==null?void 0:i.optimizationTarget,c=p.useCallback(w=>{a.optConfigs.set(u.optConfigId,{optimizationTarget:w})},[a.optConfigs,u.optConfigId]),m=p.useMemo(()=>a.relics.values.reduce((w,$)=>(w[$.slotKey].push($),w),{head:[],hands:[],feet:[],body:[],sphere:[],rope:[]}),[a.relics.values]),f=Object.values(m).reduce((w,$)=>w*$.length,1),[v,C]=p.useState(void 0),[b,y]=p.useState(!1),D=p.useRef(()=>{});p.useEffect(()=>()=>D.current(),[]);const we=p.useCallback(async()=>{if(!n||!o)return;const w=new Promise(P=>D.current=P);r(void 0),y(!0);const $=((i==null?void 0:i.statFilters)??[]).filter(({disabled:P})=>!P).map(({tag:P,value:Me,isMax:Ie})=>({tag:P,value:Me,isMax:Ie})),U=new at(u.key,o,n,$,m,s,r);w.then(async()=>await U.terminate());const Be=await U.optimize();await U.terminate(),D.current=()=>{},y(!1),C(Be[0])},[o,u.key,s,i==null?void 0:i.statFilters,n,m]),_e=p.useCallback(()=>{D.current(),y(!1)},[D]);return e(B,{bgt:"dark",children:h(_,{children:[e(qt,{}),h(N,{children:[e(x,{variant:"h5",children:t("optimize")}),h(g,{children:[e(Y,{optTarget:n,setOptTarget:c}),e(Kt,{numWorkers:s,setNumWorkers:l}),e(L,{onClick:b?_e:we,color:b?"error":"primary",startIcon:b?e(ye,{}):e(nt,{}),children:t(b?"cancel":"optimize")})]}),d&&e(Gt,{progress:d,totalPermutations:f}),v&&h(g,{children:[h(x,{children:["Best: ",v.value]}),e(ot,{build:v.ids})]})]})]})})}function Gt({progress:t,totalPermutations:a}){const{t:o}=S("optimize");return h(g,{children:[h(x,{children:[o("totalProgress"),": ",t.numBuildsComputed.toLocaleString()," /"," ",a.toLocaleString()]}),h(x,{children:[o("buildsKept"),": ",t.numBuildsKept.toLocaleString()," /"," ",st.toLocaleString()]}),e(rt,{variant:"determinate",value:t.numBuildsComputed/a*100})]})}const Vt={xs:12,sm:6,md:4};function Rt(){const{loadout:{key:t}}=A(),a=z(),{database:o}=k(),s=["basic","skill","ult","talent"],l=ce(),d=le(l.breakpoints.up("lg")),r=it[t],u=(a==null?void 0:a.compute(M.char.eidolon).val)??0,i=p.useMemo(()=>r&&F(1,pe).map(n=>{const c=r[`eidolon${n}`];return c?e(se,{talentKey:`eidolon${n}`,sheetElement:c,onClickTitle:()=>o.chars.set(t,{eidolon:n===u?n-1:n})}):null}),[t,r,o.chars,u]);if(!(!r||!a))return e(ue,{children:h(T,{container:!0,spacing:1,children:[d&&h(T,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(re,{}),i&&i.map((n,c)=>e(g,{sx:{opacity:u>=c+1?1:.5},children:n},c))]}),e(T,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:s.map(n=>{const c=r[n];return c?e(T,{item:!0,...Vt,children:e(se,{talentKey:n,sheetElement:c})},n):null})}),!d&&e(T,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:e(T,{item:!0,xs:12,children:e(re,{})})})]})})}function se({sheetElement:t,talentKey:a,onClickTitle:o}){const{loadout:{key:s}}=A(),l=p.useCallback(n=>e(ke,{onClick:o,children:n}),[o]);let d=null;d=null,dt(a)&&(d=e(Jt,{talentKey:a,dropDownButtonProps:{sx:{borderRadius:0}},setTalent:n=>u.chars.set(s,c=>{c[a]=n})}));const{loadoutId:r}=p.useContext(W),{database:u}=k(),i=p.useCallback((n,c,m,f)=>{u.loadouts.set(r,v=>(v=structuredClone(v),je(v.conditional,[n,c,m],f),v))},[u,r]);return h(B,{bgt:"light",sx:{height:"100%"},children:[d,h(_,{children:[e(ct,{condition:!!o,wrapper:l,children:h(T,{container:!0,sx:{flexWrap:"nowrap"},children:[e(T,{item:!0,children:e(g,{component:ee?ee:"img",src:t==null?void 0:t.img,sx:{width:60,height:"auto"}})}),h(T,{item:!0,flexGrow:1,sx:{pl:1},children:[e(x,{variant:"h6",children:t==null?void 0:t.title}),t.subtitle&&e(x,{variant:"subtitle1",children:t.subtitle})]})]})}),e(wt,{spacing:1,children:t.documents.map((n,c)=>e(lt,{document:n,collapse:!0,setConditional:i},c))})]})]})}function re(){const{t}=S("sheet_gen"),a=z(),{loadout:{key:o}}=A(),{database:s}=k();if(!a)return null;const l=a.compute(M.char.eidolon).val;return e(O,{fullWidth:!0,title:h("span",{children:[t("eidolonLvl")," ",l]}),color:"primary",children:F(0,pe).map(d=>e(I,{selected:l===d,disabled:l===d,onClick:()=>s.chars.set(o,{eidolon:d}),children:h("span",{children:[t("eidolonLvl")," ",d]})},d))})}function Jt({talentKey:t,setTalent:a,dropDownButtonProps:o}){const{t:s}=S("sheet_gen"),{character:l}=me(),d=z();if(!d||!l)return null;const r=0,u=d.compute(M.char[t]).val,i=d.compute(M.char.ascension).val;return e(O,{fullWidth:!0,title:h("span",{children:[s("lvl")," ",u]}),color:"primary",...o,children:F(1,Ge[i]).map(n=>e(I,{selected:l[t]===n,disabled:l[t]===n,onClick:()=>a(n),children:h("span",{children:[s("lvl")," ",n+r]})},n))})}function Ft({tab:t}){const{loadout:{key:a}}=A(),{character:o}=me(),s=z(),[l,d]=p.useState(void 0);return h(g,{children:[t,e(pt,{characterKey:l,onClose:()=>d(void 0)}),e(mt,{character:o}),h(N,{gap:1,pt:1,children:[e(B,{bgt:"dark",children:h(_,{children:[e(L,{disabled:!a,onClick:()=>a&&d(a),children:"Edit Character"}),e($t,{}),h(q,{children:[e(K,{expandIcon:e(j,{}),children:"All target listings"}),e(G,{children:e(N,{children:s==null?void 0:s.listFormulas(M.listing.formulas).map((r,u)=>{const i=s.compute(r),n=r.tag.name||r.tag.q;return h(g,{children:[h(x,{children:[n,": ",i.val]}),h(q,{children:[h(K,{expandIcon:e(j,{}),children:["debug for ",n]}),h(G,{children:["conds:"," ",JSON.stringify(i.meta.conds,void 0,2),e(x,{component:"pre",children:JSON.stringify(s.toDebug().compute(r),void 0,2)})]})]})]},`${n}${u}`)})})})]}),h(q,{children:[e(K,{expandIcon:e(j,{}),children:"All target buffs"}),e(G,{children:e(N,{children:s==null?void 0:s.listFormulas(M.listing.buffs).map((r,u)=>{const i=s.compute(r),n=r.tag.name||r.tag.q;return h(g,{children:[h(x,{children:[n,": ",i.val]}),h(q,{children:[h(K,{expandIcon:e(j,{}),children:["debug for ",n]}),h(G,{children:["conds:"," ",JSON.stringify(i.meta.conds,void 0,2),e(x,{component:"pre",children:JSON.stringify(s.toDebug().compute(r),void 0,2)})]})]})]},`${n}${u}`)})})})]})]})}),e(Rt,{}),e(jt,{})]})]})}const Ht=e(ge,{variant:"rectangular",width:"100%",height:1e3});function la(){const{database:t}=k(),{teamId:a}=Ve(),o=!a||!t.teams.keys.includes(a);return p.useEffect(()=>{o||t.teams.set(a,{lastEdit:Date.now()})},[a,t.teams,o]),o?e(Je,{to:"/teams"}):e(g,{display:"flex",flexDirection:"column",gap:1,children:e(p.Suspense,{fallback:Ht,children:a&&e(Ut,{teamId:a})})})}function Ut({teamId:t}){var C;const{database:a}=k(),o=ie(),s=De(t),{loadoutMetadata:l}=s,{params:{characterKey:d}}=te({path:"/teams/:teamId/:characterKey",end:!1})??{params:{}},{params:{tab:r}}=te({path:"/teams/:teamId/:characterKey/:tab"})??{params:{}},u=p.useMemo(()=>l.findIndex(b=>{var y;return(b==null?void 0:b.loadoutId)&&((y=a.loadouts.get(b.loadoutId))==null?void 0:y.key)===d}),[l,a.loadouts,d]),i=p.useMemo(()=>l[u],[l,u]);p.useEffect(()=>{window.scrollTo({top:0})},[]),p.useEffect(()=>{i||o("",{replace:!0})},[i,o]);const n=i==null?void 0:i.loadoutId,c=(C=a.loadouts.get(n))==null?void 0:C.key,{t:m}=S(["charNames_gen","page_character"]);ut(p.useMemo(()=>{const b=m(c?"charNames_gen:Character":"Team Settings"),y=r?m(`page_character:tabs.${r}`):c?m("Loadout/Build"):r;return`${s.name} - ${b}${y?` - ${y}`:""}`},[c,m,r,s.name]));const f=Se(n??""),v=p.useMemo(()=>{if(!(!n||!f||!i))return{teamId:t,team:s,loadoutId:n,loadout:f,loadoutMetadatum:i}},[n,f,i,s,t]);return e(_t,{teamId:t,currentChar:c,children:h(g,{sx:{display:"flex",gap:1,flexDirection:"column",mx:1,mt:2},children:[e(B,{children:e(Bt,{teamId:t,charKey:c,tab:r})}),e(g,{children:v?e(W.Provider,{value:v,children:e(Xt,{})}):e(Mt,{teamId:t})})]})})}function Xt({tab:t}){const{loadout:{key:a}}=A(),o=xe(a),s=p.useMemo(()=>o&&{character:o},[o]);return s?e(Re.Provider,{value:s,children:e(Fe,{children:e(ae,{path:":characterKey",children:e(ae,{path:"*",index:!0,element:e(Ft,{tab:t})})})})}):e(ge,{variant:"rectangular",width:"100%",height:1e3})}export{la as default};
