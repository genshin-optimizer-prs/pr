import{e as n,p as e,n as h,aH as X,aI as V,U as I,aJ as Y,aK as Z,q as ee,r as te,i as ae,j as se,u as F,a9 as re,b as H,d as ne,ap as oe,X as le,aE as ie,Q as ce,aL as ue,K as T,J as P,C as B,aA as W,B as _,D as me,T as de,aM as he,aN as pe}from"./index-c71d53b2.js";import{T as D,A as ge,C as fe,f as ye,s as Ce,u as xe,a as ve,S as Se}from"./StarDisplay-b16c1e02.js";import{a as we,T as Te,d as Ie}from"./TeamCard-d16c9e76.js";import{M as be}from"./DropdownButton-9d3c7f76.js";import{C as Me}from"./CardHeader-4d97f779.js";import"./ColoredText-e0066e51.js";import"./index-a1969b31.js";import"./SqBadge-1e0a774b.js";import"./BootstrapTooltip-2032e6c6.js";import"./FieldDisplay-ef0709bc.js";import"./Groups-c3c77b8b.js";import"./index-7d8a6ed0.js";import"./index-c869ddce.js";import"./Artifact-6d99cf30.js";import"./SlotIcon-655b1d7b.js";import"./useWeapon-2bf6bbea.js";import"./CardActionArea-3beac088.js";function Ne({options:o,valueKeys:s,label:c,onChange:l,toImg:d,toExItemLabel:i,toExLabel:f,chipProps:x,...v}){const y=n.useMemo(()=>s.map(t=>o.find(r=>r.key===t)).filter(t=>t),[o,s]);return e(ge,{autoHighlight:!0,options:o,multiple:!0,disableCloseOnSelect:!0,value:y,onChange:(t,r,u)=>u==="clear"?l([]):r!==null&&l(r.map(m=>m.key)),isOptionEqualToValue:(t,r)=>t.key===r.key,renderInput:t=>e(D,{...t,label:c,inputProps:{...t.inputProps,autoComplete:"new-password"},color:s.length?"success":"primary"}),renderOption:(t,r)=>h(be,{value:r.key,...t,children:[e(X,{children:d(r.key)}),e(V,{children:e(n.Suspense,{fallback:e(I,{variant:"text",width:100}),children:h(Y,{color:r.color,sx:{display:"flex",gap:1},children:[s.includes(r.key)?e("strong",{children:r.label}):e("span",{children:r.label}),i==null?void 0:i(r.key)]})})}),!!r.favorite&&e(we,{})]}),renderTags:(t,r)=>t.map(({key:u,label:m,color:C},w)=>Z(ee,{...x,...r({index:w}),key:`${w}${u}${m}`,icon:d(u),label:f?h("span",{children:[m," ",f(u)]}):m,color:C})),filterOptions:(t,{inputValue:r})=>t.filter(u=>{var m;return u.label.toLowerCase().includes(r.toLowerCase())||((m=u.alternateNames)==null?void 0:m.some(C=>C.toLowerCase().includes(r.toLowerCase())))}),...v})}var K={},_e=ae;Object.defineProperty(K,"__esModule",{value:!0});var $=K.default=void 0,ke=_e(te()),De=se,$e=(0,ke.default)((0,De.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");$=K.default=$e;function Ke({charKeys:o,setCharKey:s,acProps:c}){const{t:l}=F(["sillyWisher_charNames","charNames_gen"]),{silly:d}=n.useContext(re),i=H(),{gender:f}=ne(),x=n.useCallback(t=>i.charMeta.get(t).favorite,[i.charMeta]),v=n.useCallback(t=>e(fe,{characterKey:t}),[]),y=n.useMemo(()=>i.chars.keys.map(t=>({key:t,label:l(`${d?"sillyWisher_charNames":"charNames_gen"}:${oe(t,f)}`),favorite:x(t)})),[i,f,d,x,l]);return e(n.Suspense,{fallback:e(I,{variant:"text",width:100}),children:e(Ne,{label:"Characters",options:y,toImg:v,valueKeys:o,onChange:t=>s(t),...c})})}function Oe(){return{name:o=>o.name??"",lastEdit:o=>o.lastEdit??0}}const Ee={name:["name","lastEdit"],lastEdit:["lastEdit"]};function je(o){return{charKeys:(s,c)=>{var l;return!c.length||!!((l=o.teams.get(s))!=null&&l.teamCharIds.some(d=>{var i;return c.includes((i=o.teamChars.get(d))==null?void 0:i.key)}))},name:(s,c)=>{var l;return!c||!!((l=o.teams.get(s))!=null&&l.name.toLowerCase().includes(c.toLowerCase()))}}}const Ae={xs:1,sm:2,md:3,lg:4,xl:4},k={xs:6,sm:12,md:18,lg:24,xl:24};function tt(){const{t:o}=F(["page_teams","sillyWisher_charNames","charNames_gen"]),s=H(),[c,l]=le(),d=ie();n.useEffect(()=>s.teams.followAny((a,g)=>(g==="new"||g==="remove"||g==="update")&&l()),[l,s]);const i=()=>{const a=s.teams.new();d(a)},[f,x,v]=ce(),[y,t]=n.useState(""),r=()=>{try{const a=JSON.parse(y);s.teams.import(a)||window.alert("Data verification failed."),v()}catch(a){window.alert(`Data Import failed. ${a}`);return}},{sortType:u,ascending:m}=ue(s.displayTeam),[C,w]=n.useState([]),[O,J]=n.useState(""),E=n.useDeferredValue(O),{teamIds:p,totalTeamNum:b}=n.useMemo(()=>{const a=s.teams.keys.length,g=s.teams.keys.filter(ye({charKeys:C,name:E},je(s))).sort((z,Q)=>Ce(Ee[u],m,Oe())(s.teams.get(z),s.teams.get(Q)));return c&&{teamIds:g,totalTeamNum:a}},[c,s,C,E,u,m]),S=xe(),[M,j]=n.useState(k[S]);n.useEffect(()=>{p&&j(k[S])},[p,S]);const[U,q]=n.useState(),A=ve(U)&&M<p.length;n.useEffect(()=>{A&&j(a=>a+k[S])},[A,S]);const N=n.useMemo(()=>p.slice(0,M),[p,M]),G=p.length!==b?`${p.length}/${b}`:`${b}`,L={numShowing:N.length,total:G,t:o,namespace:"page_character"},R={sortKeys:[...pe],value:u,onChange:a=>s.displayTeam.set({sortType:a}),ascending:m,onChangeAsc:a=>s.displayTeam.set({ascending:a})};return h(T,{my:1,display:"flex",flexDirection:"column",gap:1,children:[e(W,{children:h(B,{sx:{display:"flex",flexDirection:"column",gap:1},children:[h(T,{display:"flex",gap:1,alignItems:"stretch",children:[e(Ke,{charKeys:C,setCharKey:w,acProps:{sx:{flexGrow:1}}}),e(D,{autoFocus:!0,value:O,onChange:a=>J(a.target.value),label:"Team Name",sx:{height:"100%",flexGrow:1},InputProps:{sx:{height:"100%"}}})]}),e(T,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:e(Se,{showingTextProps:L,sortByButtonProps:R})})]})}),h(T,{sx:{display:"flex",gap:1},children:[e(_,{fullWidth:!0,onClick:i,color:"info",startIcon:e(Ie,{}),children:"Add Team"}),e(he,{open:f,onClose:v,children:h(W,{children:[e(Me,{title:"Import Team"}),e(me,{}),h(B,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(de,{children:"Import a team in JSON form below."}),e(D,{fullWidth:!0,label:"JSON Data",placeholder:"Paste your Team JSON here",value:y,onChange:a=>t(a.target.value),multiline:!0,rows:4}),e(_,{startIcon:e($,{}),disabled:!y,onClick:r,children:"Import"})]})]})}),e(_,{fullWidth:!0,onClick:x,color:"info",startIcon:e($,{}),children:"Import Team"})]}),e(n.Suspense,{fallback:e(I,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:e(P,{container:!0,spacing:1,columns:Ae,children:N.map(a=>e(P,{item:!0,xs:1,children:e(Te,{teamId:a,bgt:"light",onClick:g=>d(`${a}${g?`/${g}`:""}`)})},a))})}),p.length!==N.length&&e(I,{ref:a=>{a&&q(a)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})}export{tt as default};
