import{u as z,e as m,n as h,p as t,dN as re,dO as ie,b_ as G,B as S,dP as H,dQ as le,dR as ce,a0 as de,dS as ue,dT as pe,a2 as me,a1 as fe,T as L,K as D,dU as W,b as M,b9 as B,cI as _,dV as j,br as N,bq as U,D as V,dW as v,C as R,am as q,R as J,t as E,dX as he,Q as xe,J as g,s as Ce,V as ge,_ as be}from"./index-0db396d8.js";import{T as ye,x as ve,v as ke,w as we,u as I}from"./index-d56c85de.js";import{u as De}from"./useWeapon-7fecc06f.js";import{c as Le,e as Se,f as Ie}from"./LocationAutocomplete-b0eeef03.js";import{C as Te}from"./CloseButton-2ea8a6a8.js";import{D as y,d as Q,b as We,a as Me,L as Oe}from"./FieldDisplay-eef74b9a.js";import{M as T,D as A}from"./DropdownButton-948e4078.js";import{S as X}from"./SqBadge-d0a04107.js";import{B as P}from"./ColoredText-ba60365a.js";import{a as Re}from"./InfoTooltip-20db6794.js";import{b as Be}from"./StarDisplay-4cd50d08.js";import{g as _e}from"./index-5534f660.js";import{C as je}from"./CardHeader-3858d105.js";function Ve({level:e,ascension:s,setBoth:n,useLow:i=!1,disabled:c=!1}){const{t:u}=z("ui"),a=i?ce:G,d=m.useCallback((o=1)=>{o=de(o,1,i?ue:pe);const p=a.findIndex(f=>o<=f);n({level:o,ascension:p})},[n,a,i]),r=m.useCallback(()=>{const o=a.findIndex(p=>e!==90&&e===p);n(s===o?{ascension:s+1}:{ascension:o})},[n,a,s,e]);return h(P,{sx:{bgcolor:o=>o.palette.contentNormal.main},children:[t(fe,{children:t(me,{onChange:d,value:e,startAdornment:"Lv. ",disabled:c,inputProps:{min:1,max:90,sx:{textAlign:"center",width:"3em"}},sx:{height:"100%",pl:2}})}),t(S,{sx:{pl:1,whiteSpace:"nowrap"},disabled:!(i?re:ie)(e)||c,onClick:r,children:h("strong",{children:["/ ",G[s]]})}),t(A,{title:u("selectlevel"),sx:{flexGrow:1},disabled:c,children:[...i?H:le].map(([o,p])=>{const f=o===e&&p===s;return t(T,{selected:f,disabled:f,onClick:()=>n({level:o,ascension:p}),children:o===a[p]?`Lv. ${o}`:`Lv. ${o}/${a[p]}`},`${o}/${p}`)})})]})}function Ee({avatar:e,title:s,action:n}){return h(D,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,t(L,{variant:"subtitle1",sx:{flexGrow:1},children:s}),n&&t(L,{variant:"caption",children:n})]})}const F=m.createContext({teamChar:{},team:{}});function Ae({conditional:e,disabled:s=!1}){const{data:n}=m.useContext(y);return Object.keys(W(e.states,n)).length===1&&"path"in e?t(Pe,{conditional:e,disabled:s}):"path"in e?t(Fe,{conditional:e,disabled:s}):t($e,{conditional:e,disabled:s})}function Pe({conditional:e,disabled:s}){const{teamCharId:n}=m.useContext(F),{data:i}=m.useContext(y),c=M(),u=m.useCallback(f=>{c.teamChars.set(n,b=>{const C=B(b.conditional);f?_(C,e.path,f):j(C,e.path),b.conditional=C})},[c,e.path,n]),a=i.get(e.value).value,[d,r]=Object.entries(W(e.states,i))[0],o=Z(r.name),p=$(e.name);return h(S,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:a?"success":"primary",onClick:()=>u(a?void 0:d),disabled:s,startIcon:a?t(N,{}):t(U,{}),children:[p," ",o]})}function Fe({conditional:e,disabled:s}){const{teamCharId:n}=m.useContext(F),{data:i}=m.useContext(y),c=M(),u=m.useCallback(f=>{c.teamChars.set(n,b=>{const C=B(b.conditional);f?_(C,e.path,f):j(C,e.path),b.conditional=C})},[c,e.path,n]),a=i.get(e.value).value,d=W(e.states,i),r=a?d[a]:void 0,o=r?Z(r.name):t(X,{color:"secondary",children:"Not Active"}),p=$(e.name);return h(A,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:a&&r?"success":"primary",title:h("span",{children:[p," ",o]}),disabled:s,children:[t(T,{onClick:()=>u(),selected:!r,disabled:!r,children:t("span",{children:"Not Active"})}),t(V,{}),Object.entries(d).map(([f,b])=>t(T,{onClick:()=>u(f),selected:a===f,disabled:a===f,children:b.name},f))]})}function $e({conditional:e,disabled:s}){const{teamCharId:n}=m.useContext(F),{data:i}=m.useContext(y),c=M(),u=m.useCallback((a,d)=>{c.teamChars.set(n,r=>{const o=B(r.conditional);d?_(o,a,d):j(o,a),r.conditional=o})},[c,n]);return t(P,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(W(e.states,i)).map(([a,d])=>{const r=i.get(d.value).value,o=r===a;return t(S,{color:o?"success":"primary",disabled:s,fullWidth:!0,onClick:()=>u(d.path,r?void 0:a),size:"small",startIcon:o?t(N,{}):t(U,{}),sx:{borderRadius:0},children:$(d.name)},a)})})}function Y(e){return typeof e!="string"}function Z(e){if(!e)return"";let s="primary",n=e;return e&&Y(e)&&e.props.color&&(s=e.props.color,n=t("span",{children:e.props.children})),t(X,{sx:{ml:.5},color:s,children:n})}function $(e){if(Y(e)){const s=e.props.key18,n=e.props.ns,i=e.props.values;return t(ye,{ns:n,key18:s,values:i,useBadge:!0})}return e}function Ge({conditional:e,hideHeader:s=!1,hideDesc:n=!1,disabled:i=!1,component:c=E}){var r;const{data:u}=m.useContext(y);let a;if("path"in e){const o=u.get(e.value).value,p=v(e.states,u);a=o&&((r=p[o])==null?void 0:r.fields)}else{const o=v(e.states,u);a=Object.values(o).flatMap(p=>u.get(p.value).value?p.fields:[])}const d=h(q,{children:[!v(s,e)&&t(K,{header:e.header,hideDesc:n}),t(R,{sx:{p:0,"&:last-child":{pb:0}},children:t(Ae,{conditional:e,disabled:i})}),a&&t(Q,{fields:a})]});return J.createElement(c,{children:d})}function ze({sections:e,teamBuffOnly:s,hideDesc:n=!1,hideHeader:i=!1,disabled:c=!1,component:u}){const{data:a}=m.useContext(y);if(!e.length)return null;const d=e.map((r,o)=>r.canShow&&!a.get(r.canShow).value||s&&!r.teamBuff?null:t(He,{section:r,hideDesc:n,hideHeader:i,disabled:c,component:u},o)).filter(r=>r);return d.length?t(D,{display:"flex",flexDirection:"column",gap:1,children:d}):null}function He({section:e,hideDesc:s=!1,hideHeader:n=!1,disabled:i=!1,component:c}){return"fields"in e?t(Ne,{section:e,hideDesc:s,hideHeader:n}):"states"in e?t(Ge,{conditional:e,hideDesc:s,hideHeader:n,disabled:i,component:c}):t(Ue,{section:e})}function Ne({section:e,hideDesc:s,hideHeader:n}){return h(E,{children:[!v(n,e)&&e.header&&t(K,{header:e.header,hideDesc:s,hideDivider:e.fields.length===0}),t(Q,{fields:e.fields})]})}function Ue({section:e}){const{data:s}=m.useContext(y);return t("div",{children:v(e.text,s)})}function K({header:e,hideDesc:s,hideDivider:n}){const{data:i}=m.useContext(y),{icon:c,title:u,action:a}=e,d=v(c,i),r=!s&&v(e.description,i);return h(q,{children:[t(Ee,{avatar:d,title:s?u:h("span",{children:[u,t(Re,{title:t(L,{children:r})})]}),action:a}),!n&&t(V,{})]})}function qe({refinement:e,setRefinement:s,disabled:n=!1}){const{t:i}=z("ui");return t(A,{title:i("refinement",{value:e}),disabled:n,children:he.map(c=>t(T,{onClick:()=>s(c),selected:e===c,disabled:e===c,children:i("refinement",{value:c})},c))})}const Je=J.lazy(()=>be(()=>import("./WeaponSelectionModal-be61288a.js"),["./WeaponSelectionModal-be61288a.js","./index-0db396d8.js","./index-45d7191e.css","./index-d56c85de.js","./ColoredText-ba60365a.js","./SqBadge-d0a04107.js","./index-5534f660.js","./totalUtils-5f577bef.js","./CloseButton-2ea8a6a8.js","./StarDisplay-4cd50d08.js","./DropdownButton-948e4078.js","./WeaponCard-fed170aa.js","./useWeapon-7fecc06f.js","./LocationAutocomplete-b0eeef03.js","./CardActionArea-8bcdde05.js"],import.meta.url));function Qe({weaponId:e,footer:s=!1,onClose:n,extraButtons:i}){const{data:c}=m.useContext(y),u=M(),a=De(e),{key:d="",level:r=0,refinement:o=1,ascension:p=0,lock:f,location:b="",id:C}=a??{},l=d?_e(d):void 0,k=m.useCallback(x=>{u.weapons.set(e,x)},[e,u]),ee=m.useCallback(x=>C&&u.weapons.set(C,{location:x}),[u,C]),te=m.useCallback(x=>x.weaponTypeKey===(l==null?void 0:l.weaponType),[l]),[ne,ae,se]=xe(),oe=d?ve(d,p>=2):"";m.useEffect(()=>{if(!(!l||!k||l.key!==(a==null?void 0:a.key))&&l.rarity<=2&&(r>70||p>4)){const[x,w]=H[0];k({level:x,ascension:w})}},[l,a,k,r,p]);const O=m.useMemo(()=>l&&a&&ke([l.data,we(a)]),[l,a]);return t(ge,{open:!!e,onClose:n,containerProps:{maxWidth:"md"},children:h(Ce,{children:[t(Je,{ascension:p,show:ne,onHide:se,onSelect:x=>k({key:x}),weaponTypeFilter:l&&l.weaponType}),t(R,{children:l&&O&&h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:12,sm:3,children:h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:6,sm:12,children:t(D,{component:"img",src:oe,className:`grad-${l.rarity}star`,sx:{maxWidth:256,width:"100%",height:"auto",borderRadius:1}})}),t(g,{item:!0,xs:6,sm:12,children:t(L,{children:t("small",{children:l.description})})})]})}),h(g,{item:!0,xs:12,sm:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[t(D,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:h(P,{children:[t(S,{color:"info",onClick:ae,children:(l==null?void 0:l.name)??"Select a Weapon"}),(l==null?void 0:l.hasRefinement)&&t(qe,{refinement:o,setRefinement:x=>k({refinement:x})}),i]})}),h(D,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:[l&&t(Ve,{level:r,ascension:p,setBoth:k,useLow:!l.hasRefinement}),t(S,{color:"error",onClick:()=>C&&u.weapons.set(C,{lock:!f}),startIcon:f?t(Le,{}):t(Se,{}),children:f?"Locked":"Unlocked"})]}),t(Be,{stars:l.rarity}),t(L,{variant:"subtitle1",children:t("strong",{children:l.passiveName})}),t(L,{gutterBottom:!0,children:l.passiveName&&l.passiveDescription(O.get(I.weapon.refinement).value-1)}),h(D,{display:"flex",flexDirection:"column",gap:1,children:[h(E,{children:[t(je,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),t(V,{}),t(We,{children:[I.weapon.main,I.weapon.sub,I.weapon.sub2].map(x=>{const w=O.get(x);return w.isEmpty||!w.value?null:t(Me,{node:w,component:Oe},JSON.stringify(w.info))})})]}),c&&l.document&&t(ze,{sections:l.document})]})]})]})}),s&&C&&t(R,{sx:{py:1},children:h(g,{container:!0,spacing:1,children:[t(g,{item:!0,flexGrow:1,children:t(Ie,{location:b,setLocation:ee,filter:te,autoCompleteProps:{getOptionDisabled:x=>!x.key}})}),t(g,{item:!0,flexGrow:2}),!!n&&t(g,{item:!0,children:t(Te,{sx:{height:"100%"},large:!0,onClick:n})})]})})]})})}const ct=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{Ee as C,ze as D,Ve as L,qe as R,F as T,Qe as W,ct as a};
