import{u as q,e as o,a9 as A,b as N,d as j,Y as J,dM as S,h as Y,f as Q,p as e,n as i,C as E,K as r,D as R,J as F,t as X,W as Z,at as H,v as ee,dL as te,U as ae,aA as se,T as x,c4 as oe,s as ne}from"./index-e3e78834.js";import{f as re,s as ie,T as le,k as ce,F as de,c as pe}from"./StarDisplay-f730c097.js";import{g as b,V as me}from"./index-1a05a278.js";import{c as G,E as he,o as ue,k as fe,a as xe,l as ye,p as ge,b as Ce,e as ve}from"./CharacterSort-4bbd854b.js";import{C as Te}from"./CloseButton-53ba2933.js";import{S as I}from"./SqBadge-cb26f779.js";import{W as we}from"./WeaponUtil-de8df2a9.js";import{D as be}from"./FieldDisplay-7547eeec.js";import{c as z}from"./totalUtils-87d1abcc.js";import{C as De}from"./CardActionArea-f8bf999d.js";import"./DropdownButton-6764d8bc.js";import"./ColoredText-421face3.js";import"./index-6a4b0350.js";import"./index-32633845.js";import"./Artifact-dd02e3ae.js";import"./Help-0edbbf0a.js";import"./SlotIcon-cd8206d5.js";import"./Groups-dfcfe71a.js";const Me=Object.keys(G);function qe({show:n,onHide:c,onSelect:d,filter:s=()=>!0,newFirst:m=!1}){const{t:y}=q(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:h}=o.useContext(A),a=N(),[g,C]=o.useState(()=>a.displayCharacter.get());o.useEffect(()=>a.displayCharacter.follow((t,l)=>C(l)),[a,C]);const{gender:u}=j(),[D,v]=J();o.useEffect(()=>a.charMeta.followAny(()=>v()),[v,a]);const[T,w]=o.useState(""),M=o.useDeferredValue(T),k=o.useDeferredValue(g),B=o.useDeferredValue(D),f=o.useMemo(()=>{const{element:t,weaponType:l,sortType:p,ascending:K}=k,O=[...m?["new"]:[],...G[p]??[]];return B&&S.filter(W=>s(a.chars.get(W),b(W,u))).filter(re({element:t,weaponType:l,name:M},Ce(a,h))).sort(ie(O,K,ve(a,h),["new","favorite"]))},[k,m,B,M,a,h,s,u]),L=o.useMemo(()=>z(Y,t=>S.forEach(l=>{const p=b(l,a.gender).weaponTypeKey;t[p].total++,f.includes(l)&&t[p].current++})),[f,a]),V=o.useMemo(()=>z(Q,t=>S.forEach(l=>{const p=b(l,a.gender).elementKey;t[p].total++,f.includes(l)&&t[p].current++})),[f,a]),{weaponType:_,element:P,sortType:U,ascending:$}=g;return e(Z,{open:n,onClose:c,sx:{"& .MuiContainer-root":{justifyContent:"normal"}},children:i(X,{children:[i(E,{sx:{py:1,display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e(we,{sx:{height:"100%"},onChange:t=>a.displayCharacter.set({weaponType:t}),value:_,totals:L,size:"small"}),e(he,{sx:{height:"100%"},onChange:t=>a.displayCharacter.set({element:t}),value:P,totals:V,size:"small"}),e(r,{flexGrow:1,children:e(le,{autoFocus:!0,value:T,onChange:t=>w(t.target.value),label:y("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})}),e(ce,{sx:{height:"100%"},sortKeys:Me,value:U,onChange:t=>a.displayCharacter.set({sortType:t}),ascending:$,onChangeAsc:t=>a.displayCharacter.set({ascending:t})}),e(Te,{onClick:c})]}),e(R,{}),e(be.Provider,{value:{teamData:void 0},children:e(E,{children:e(F,{container:!0,spacing:1,columns:{xs:2,sm:3,md:4,lg:5},children:f.map(t=>e(F,{item:!0,xs:1,children:e(ke,{characterKey:t,onClick:()=>{c(),d==null||d(t)}})},t))})})})]})})}const Se=H(({className:n,...c})=>e(ee,{...c,classes:{popper:n}}))({[`& .${te.tooltip}`]:{padding:0}});function ke({characterKey:n,onClick:c}){const{gender:d}=j(),s=b(n,d),m=ue(n),{favorite:y}=fe(n),h=N(),{silly:a}=o.useContext(A),[g,C,u]=ae(),{level:D=1,ascension:v=0,constellation:T=0}=m??{},w=me(n,"banner",d);return e(Se,{enterDelay:300,enterNextDelay:300,arrow:!0,placement:"bottom",open:g,onClose:u,onOpen:C,title:e(r,{sx:{width:300},children:e(xe,{hideStats:!0,characterKey:n})}),children:e(r,{children:i(ne,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e(r,{sx:{position:"absolute",opacity:.7,zIndex:2},children:e(se,{sx:{p:.25},onClick:M=>{u(),h.charMeta.set(n,{favorite:!y})},children:y?e(de,{}):e(ye,{})})}),e(De,{onClick:c,children:i(r,{display:"flex",position:"relative",className:w?void 0:`grad-${s==null?void 0:s.rarity}star`,sx:{"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7,backgroundImage:`url(${w})`,backgroundPosition:"center",backgroundSize:"cover"}},width:"100%",children:[e(r,{flexShrink:1,sx:{maxWidth:{xs:"33%",lg:"30%"}},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,children:e(r,{component:"img",src:ge(n,d,a),width:"100%",height:"auto",maxWidth:256,sx:{mt:"auto"}})}),i(r,{flexGrow:1,sx:{pr:1,pt:1},display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly",children:[e(x,{variant:"body2",sx:{flexGrow:1},children:e(I,{color:s==null?void 0:s.elementKey,sx:{opacity:.85,textShadow:"0 0 5px gray"},children:s==null?void 0:s.name})}),m?i(r,{sx:{display:"flex",gap:1,alignItems:"center"},children:[i(r,{sx:{textShadow:"0 0 5px gray"},children:[i(x,{variant:"body2",component:"span",whiteSpace:"nowrap",children:["Lv. ",D]}),i(x,{variant:"body2",component:"span",color:"text.secondary",children:["/",oe[v]]})]}),i(x,{variant:"body2",children:["C",T]})]}):e(x,{component:"span",variant:"body2",children:e(I,{children:"NEW"})}),e(pe,{stars:(s==null?void 0:s.rarity)??1,colored:!0})]})]})})]})})})}export{qe as default};
