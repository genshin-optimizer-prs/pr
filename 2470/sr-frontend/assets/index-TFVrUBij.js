import{g as We,a as Ue,c as V,j as m,s as E,P as Ge,b as J,d as ue,l as pe,_ as D,r as f,u as Te,e as qe,I as _e,f as Fe,h as Ve,i as H,k as W,v as Ee,m as B,n as e,o as Qe,p as Ze,F as Me,q as Je,t as Xe,w as p,B as $e,x as Ye,C as et,y as tt,z as Z,A as fe,D as ve,T as st,E as A,S as rt,G as _,H as O,J as Ke,K as at,L as z,M as lt,N as ke,O as ot,Q as nt,R as he,U as it,V as ct,W as dt,X as Ae,Y as k,Z as ut,$ as X,a0 as pt}from"./index-DYP54tmQ.js";import{u as Ie,C as ft}from"./useForceUpdate-C_nLAoKT.js";import{M as G,D as T,T as vt}from"./DropdownButton-Dmnz_Ew8.js";import{u as me,S as ye,a as q,R as F,b as ht,c as ge,d as Y}from"./RelicStatKeyDisplay-L40pLL1k.js";import{d as ee}from"./Add-BTHq_w8E.js";import{C as mt,G as yt,L as te,a as gt,d as xt,b as bt}from"./LocationAutocomplete-BuBd4sYp.js";import{u as St,a as Ct}from"./useInfScroll-LWtIRWlS.js";function Rt(s){return Ue("MuiAlert",s)}const _t=We("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),xe=_t,Mt=V(m.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),$t=V(m.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Kt=V(m.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),kt=V(m.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),At=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],It=s=>{const{variant:l,color:i,severity:r,classes:u}=s,n={root:["root",`color${J(i||r)}`,`${l}${J(i||r)}`,`${l}`],icon:["icon"],message:["message"],action:["action"]};return Ve(n,Rt,u)},jt=E(Ge,{name:"MuiAlert",slot:"Root",overridesResolver:(s,l)=>{const{ownerState:i}=s;return[l.root,l[i.variant],l[`${i.variant}${J(i.color||i.severity)}`]]}})(({theme:s})=>{const l=s.palette.mode==="light"?ue:pe,i=s.palette.mode==="light"?pe:ue;return D({},s.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(s.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:s.vars?s.vars.palette.Alert[`${r}Color`]:l(s.palette[r].light,.6),backgroundColor:s.vars?s.vars.palette.Alert[`${r}StandardBg`]:i(s.palette[r].light,.9),[`& .${xe.icon}`]:s.vars?{color:s.vars.palette.Alert[`${r}IconColor`]}:{color:s.palette[r].main}}})),...Object.entries(s.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:s.vars?s.vars.palette.Alert[`${r}Color`]:l(s.palette[r].light,.6),border:`1px solid ${(s.vars||s).palette[r].light}`,[`& .${xe.icon}`]:s.vars?{color:s.vars.palette.Alert[`${r}IconColor`]}:{color:s.palette[r].main}}})),...Object.entries(s.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:D({fontWeight:s.typography.fontWeightMedium},s.vars?{color:s.vars.palette.Alert[`${r}FilledColor`],backgroundColor:s.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:s.palette.mode==="dark"?s.palette[r].dark:s.palette[r].main,color:s.palette.getContrastText(s.palette[r].main)})}))]})}),wt=E("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(s,l)=>l.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Lt=E("div",{name:"MuiAlert",slot:"Message",overridesResolver:(s,l)=>l.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),be=E("div",{name:"MuiAlert",slot:"Action",overridesResolver:(s,l)=>l.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Se={success:m.jsx(Mt,{fontSize:"inherit"}),warning:m.jsx($t,{fontSize:"inherit"}),error:m.jsx(Kt,{fontSize:"inherit"}),info:m.jsx(kt,{fontSize:"inherit"})},Dt=f.forwardRef(function(l,i){const r=Te({props:l,name:"MuiAlert"}),{action:u,children:n,className:o,closeText:c="Close",color:y,components:M={},componentsProps:I={},icon:g,iconMapping:t=Se,onClose:x,role:v="alert",severity:C="success",slotProps:d={},slots:h={},variant:U="standard"}=r,w=qe(r,At),b=D({},r,{color:y,severity:C,variant:U,colorSeverity:y||C}),K=It(b),R={slots:D({closeButton:M.CloseButton,closeIcon:M.CloseIcon},h),slotProps:D({},I,d)},[$,j]=me("closeButton",{elementType:_e,externalForwardedProps:R,ownerState:b}),[Q,P]=me("closeIcon",{elementType:mt,externalForwardedProps:R,ownerState:b});return m.jsxs(jt,D({role:v,elevation:0,ownerState:b,className:Fe(K.root,o),ref:i},w,{children:[g!==!1?m.jsx(wt,{ownerState:b,className:K.icon,children:g||t[C]||Se[C]}):null,m.jsx(Lt,{ownerState:b,className:K.message,children:n}),u!=null?m.jsx(be,{ownerState:b,className:K.action,children:u}):null,u==null&&x?m.jsx(be,{ownerState:b,className:K.action,children:m.jsx($,D({size:"small","aria-label":c,title:c,color:"inherit",onClick:x},j,{children:m.jsx(Q,D({fontSize:"small"},P))}))}):null]}))}),zt=Dt;var se={},Pt=W;Object.defineProperty(se,"__esModule",{value:!0});var je=se.default=void 0,Ot=Pt(H()),Nt=m,Bt=(0,Ot.default)((0,Nt.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");je=se.default=Bt;var re={},Ht=W;Object.defineProperty(re,"__esModule",{value:!0});var we=re.default=void 0,Wt=Ht(H()),Ut=m,Gt=(0,Wt.default)((0,Ut.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");we=re.default=Gt;var ae={},Tt=W;Object.defineProperty(ae,"__esModule",{value:!0});var Le=ae.default=void 0,qt=Tt(H()),Ft=m,Vt=(0,qt.default)((0,Ft.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");Le=ae.default=Vt;var le={},Et=W;Object.defineProperty(le,"__esModule",{value:!0});var De=le.default=void 0,Qt=Et(H()),Zt=m,Jt=(0,Qt.default)((0,Zt.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");De=le.default=Jt;var oe={},Xt=W;Object.defineProperty(oe,"__esModule",{value:!0});var ze=oe.default=void 0,Yt=Xt(H()),es=m,ts=(0,Yt.default)((0,es.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");ze=oe.default=ts;var ne={},ss=W;Object.defineProperty(ne,"__esModule",{value:!0});var Pe=ne.default=void 0,rs=ss(H()),as=m,ls=(0,rs.default)((0,as.jsx)("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update");Pe=ne.default=ls;function os(s,l){const r=(()=>{switch(l.type){case"reset":return;case"substat":{const{index:u,substat:n}=l,o=[...s.substats],c=n.key?o.findIndex(y=>y.key===n.key):-1;if(c===-1||c===u)o[u]={...n};else{const y=o[u];o[u]={...o[c]},o[c]={...y}}return{...s,substats:o}}case"overwrite":return l.relic;case"update":return{...s,...l.relic}}})();return r&&Ee(r,!0)}function ns({rarity:s,onRarityChange:l,filter:i,...r}){const{t:u}=B("relic");return e(T,{...r,title:s?e(ye,{stars:s,inline:!0}):u`editor.rarity`,color:s?"success":"primary",children:Qe.map(n=>e(G,{disabled:!i(n),onClick:()=>l(n),children:e(ye,{stars:n,inline:!0})},n))})}function is({relicSetKey:s,setRelicSetKey:l,label:i="",...r}){const{t:u}=B(["relic","relicNames_gen"]);i=i||u("relic:autocompleteLabels.set");const n=f.useMemo(()=>Ze.map(c=>({key:c,label:u(`relicNames_gen:${c}`)})),[u]),o=f.useCallback(c=>l(c??""),[l]);return e(yt,{options:n,valueKey:s,onChange:o,toImg:()=>e(Me,{children:" "}),label:i,...r})}function cs({index:s,relic:l,setSubstat:i}){const{t:r}=B("relic"),{mainStatKey:u="",rarity:n=5}=l??{},{key:o="",value:c=0,rolls:y=[],efficiency:M=0}=(l==null?void 0:l.substats[s])??{},I=y.length;let g="",t=[],x=0;if(l){const d=l.rarity,{numUpgrades:h,high:U}=lt[d];x=h+U-3-I,t=o?Je(o,d):[]}const v=7-t.length;x<0&&(g=g||r("editor.substat.error.noOverRoll",{value:x+I}));const C=f.useMemo(()=>o?[{value:0},...Xe(n,o).map(d=>({value:d}))]:[{value:0}],[o,n]);return p(z,{bgt:"light",children:[e(A,{sx:{display:"flex"},children:p($e,{size:"small",sx:{width:"100%",display:"flex"},children:[p(T,{startIcon:o?e(q,{statKey:o}):void 0,title:o?e(F,{statKey:o}):r("editor.substat.substatFormat",{value:s+1}),disabled:!l,color:o?"success":"primary",sx:{whiteSpace:"nowrap"},children:[o&&e(G,{onClick:()=>i(s,{key:"",value:0}),children:r`editor.substat.noSubstat`}),Ye.filter(d=>u!==d).map(d=>p(G,{selected:o===d,disabled:o===d,onClick:()=>i(s,{key:d,value:0}),children:[e(te,{children:e(q,{statKey:d})}),e(gt,{children:e(F,{statKey:d})})]},d))]}),e(et,{sx:{flexBasis:30,flexGrow:1},children:e(tt,{float:Z(o)==="%",placeholder:r`editor.substat.selectSub`,value:o?fe(ve(c,o),o):void 0,onChange:d=>{let h=d??0;Z(o)==="%"&&(h=h/100),i(s,{key:o,value:h})},disabled:!o,error:!!g,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!t.length&&e(st,{children:r`editor.substat.nextRolls`})]})}),e(A,{px:2,children:e(ds,{value:fe(ve(c,o),o),marks:C,setValue:d=>{let h=d??0;Z(o)==="%"&&(h=h/100),i(s,{key:o,value:h})},disabled:!o})}),e(A,{sx:{px:1,pb:1},children:g?e(rt,{color:"error",children:r`ui:error`}):p(_,{container:!0,children:[e(_,{item:!0,flexGrow:1,children:!!y.length&&[...y].sort().map((d,h)=>e(O,{component:"span",color:`roll${Ke(v+t.indexOf(d),1,6)}.main`,sx:{ml:1},children:d},`${h}.${d}`))}),e(_,{item:!0,xs:"auto",flexShrink:1,children:e(O,{children:p(at,{t:r,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",M]})})})]})})]})}function ds({value:s,setValue:l,marks:i,disabled:r=!1}){var o,c;const[u,n]=f.useState(s);return f.useEffect(()=>n(s),[s]),e(ht,{value:u,step:.1,disabled:r,min:((o=i[1])==null?void 0:o.value)??0,max:((c=i[i.length-1])==null?void 0:c.value)??0,onChange:(y,M)=>n(M),onChangeCommitted:(y,M)=>l(M),valueLabelDisplay:"auto"})}const Ce={rarity:[5,4,3,2],setEffects:{}};function us({relicIdToEdit:s="new",cancelEdit:l,fixedSlotKey:i,allowEmpty:r=!1,disableSet:u=!1}){const{t:n}=B("relic"),{t:o}=B(["slotKey_gen","statKey_gen"]),{database:c}=ke(),[y,M]=Ie();f.useEffect(()=>c.relics.followAny(M),[c,M]);const[I,g]=f.useState(!1);f.useEffect(()=>{s==="new"&&(g(!0),x({type:"reset"}));const a=s&&y&&c.relics.get(s);a&&(g(!0),x({type:"overwrite",relic:ot(a)}))},[s,c,y]);const[t,x]=f.useReducer(os,void 0),{relic:v,errors:C}=f.useMemo(()=>t?nt(t,s):{relic:void 0,errors:[]},[t,s]),{prev:d,prevEditType:h}=f.useMemo(()=>{const a=y&&s&&c.relics.get(s);if(a)return{prev:a,prevEditType:"edit"};if(t===void 0)return{prev:void 0,prevEditType:""};const{duplicated:S,upgraded:L}=y&&c.relics.findDups(t);return{prev:S[0]??L[0],prevEditType:S.length!==0?"duplicate":"upgrade"}},[t,s,c,y]),U=!["new",""].includes(s)&&!!(t!=null&&t.location)||!!i||!!s&&s!=="new",{rarity:w=5,level:b=0}=t??{},K=f.useMemo(()=>(t==null?void 0:t.slotKey)??i??"head",[i,t]),R=t?Ce:void 0,$=f.useCallback(a=>{const S=a.setKey?Ce:R;function L(N,de,He){return N&&de.includes(N)?N:He??de[0]}a.setKey&&(a.rarity=L(t==null?void 0:t.rarity,S.rarity,Math.max(...S.rarity)),a.slotKey=L(t==null?void 0:t.slotKey,["head","hands"])),a.rarity&&(a.level=(t==null?void 0:t.level)??0),a.level&&(a.level=Ke(a.level,0,3*(a.rarity??t.rarity))),a.slotKey&&(a.mainStatKey=L(t==null?void 0:t.mainStatKey,he[a.slotKey])),a.mainStatKey&&(a.substats=[0,1,2,3].map(N=>t&&t.substats[N].key!==a.mainStatKey?t.substats[N]:{key:"",value:0})),x({type:"update",relic:a})},[t,R,x]),j=f.useCallback(()=>{l==null||l(),x({type:"reset"})},[l,x]),Q=f.useCallback((a,S)=>x({type:"substat",index:a,substat:S}),[]),P=!C.length,ie=f.useCallback(a=>{if(!s&&t&&!window.confirm(n`editor.clearPrompt`)){a==null||a.preventDefault();return}g(!1),j()},[n,s,t,g,j]),Oe=it(),Ne=ct(Oe.breakpoints.up("md")),ce=s!=="new"&&s||(d==null?void 0:d.id),Be=()=>window.confirm(n`editor.clearPrompt`);return e(f.Suspense,{fallback:!1,children:e(dt,{open:I,onClose:ie,children:p(z,{bgt:"dark",children:[e(ft,{title:"Relic Editor",action:e(_e,{onClick:ie,children:e(xt,{})})}),p(Ae,{sx:{display:"flex",flexDirection:"column",gap:1},children:[p(_,{container:!0,spacing:1,columns:{xs:1,md:2},children:[p(_,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[p(A,{sx:{display:"flex",gap:1},children:[e(is,{disabled:u,size:"small",relicSetKey:(t==null?void 0:t.setKey)??"",setRelicSetKey:a=>$({setKey:a}),sx:{flexGrow:1},label:t!=null&&t.setKey?"":n`editor.unknownSetName`}),e(ns,{rarity:t?w:void 0,onRarityChange:a=>$({rarity:a}),filter:a=>{var S,L;return!!((L=(S=R==null?void 0:R.rarity)==null?void 0:S.includes)!=null&&L.call(S,a))},disabled:!R})]}),p(A,{component:"div",display:"flex",children:[e(vt,{label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:b,disabled:!R,onChange:a=>{const S=parseInt(a.target.value)||0;$({level:S})}}),p($e,{children:[e(k,{onClick:()=>$({level:b-1}),disabled:!R||b===0,children:"-"}),w?[...Array(w+1).keys()].map(a=>3*a).map(a=>e(k,{onClick:()=>$({level:a}),disabled:!R||b===a,children:a},a)):null,e(k,{onClick:()=>$({level:b+1}),disabled:!R||b===w*3,children:"+"})]})]}),p(A,{component:"div",display:"flex",children:[e(T,{startIcon:t!=null&&t.slotKey?e(ge,{slotKey:t.slotKey}):void 0,title:t?o(t.slotKey):n`slot`,value:K,disabled:U||!R,color:t?"success":"primary",children:ut.map(a=>p(G,{selected:K===a,disabled:K===a,onClick:()=>$({slotKey:a}),children:[e(te,{children:e(ge,{slotKey:a})}),o(a)]},a))}),e(z,{bgt:"light",sx:{p:1,ml:1,flexGrow:1},children:e(f.Suspense,{fallback:e(X,{width:"60%"}),children:e(O,{color:"text.secondary",children:o(`slotKey_gen:${K}`)})})})]}),p(A,{component:"div",display:"flex",gap:1,children:[e(T,{startIcon:t!=null&&t.mainStatKey?e(q,{statKey:t.mainStatKey}):void 0,title:e("b",{children:t?e(F,{statKey:t.mainStatKey}):n`mainStat`}),disabled:!R,color:t?"success":"primary",children:he[K].map(a=>p(G,{selected:(t==null?void 0:t.mainStatKey)===a,disabled:(t==null?void 0:t.mainStatKey)===a,onClick:()=>$({mainStatKey:a}),children:[e(te,{children:e(q,{statKey:a})}),e(F,{statKey:a})]},a))}),e(z,{bgt:"light",sx:{p:1,flexGrow:1},children:e(O,{color:"text.secondary",children:t?pt(w,t.mainStatKey,b):n`mainStat`})}),e(k,{onClick:()=>$({lock:!(t!=null&&t.lock)}),color:t!=null&&t.lock?"success":"primary",disabled:!t,children:t!=null&&t.lock?e(De,{}):e(ze,{})})]}),e(bt,{locKey:(v==null?void 0:v.location)??"",setLocKey:a=>$({location:a})})]}),e(_,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[0,1,2,3].map(a=>e(cs,{index:a,relic:v,setSubstat:Q},a))})]}),d&&p(_,{container:!0,sx:{justifyContent:"space-around"},spacing:1,children:[e(_,{item:!0,xs:12,md:5.5,lg:4,children:p(z,{bgt:"light",children:[e(O,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:h!=="edit"?h==="duplicate"?n`editor.dupeRelic`:n`editor.updateRelic`:n`editor.beforeEdit`}),e(Y,{relic:d})]})}),Ne&&e(_,{item:!0,md:1,display:"flex",alignItems:"center",justifyContent:"center",children:e(z,{bgt:"light",sx:{display:"flex"},children:e(we,{sx:{fontSize:40}})})}),e(_,{item:!0,xs:12,md:5.5,lg:4,children:p(z,{bgt:"light",children:[e(O,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:n`editor.preview`}),v&&e(Y,{relic:v})]})})]}),!P&&e(zt,{variant:"filled",severity:"error",children:C.map((a,S)=>e("div",{children:a},S))}),p(A,{display:"flex",gap:2,children:[h==="edit"?e(k,{startIcon:e(ee,{}),onClick:()=>{t&&c.relics.set(d.id,t),r||(g(!1),l()),j()},disabled:!t||!P,color:"primary",children:n`editor.btnSave`}):e(k,{startIcon:e(ee,{}),onClick:()=>{c.relics.new(t),r||(g(!1),l()),j()},disabled:!t||!P,color:h==="duplicate"?"warning":"primary",children:n`editor.btnAdd`}),r&&e(k,{startIcon:e(je,{}),disabled:!t,onClick:()=>{Be()&&j()},color:"error",children:n`editor.btnClear`}),d&&h!=="edit"&&e(k,{startIcon:e(Pe,{}),onClick:()=>{t&&c.relics.set(d.id,t),j(),r||g(!1)},disabled:!t||!P,color:"success",children:n`editor.btnUpdate`}),!!ce&&e(k,{startIcon:e(Le,{}),onClick:()=>{window.confirm(n`editor.confirmDelete`)&&(c.relics.remove(ce),j(),r||g(!1))},disabled:!t||!P,color:"error",children:n`editor.delete`})]})]})]})})})}const Re={xs:1,sm:2,md:3,lg:3,xl:4},ps={xs:10,sm:12,md:24,lg:24,xl:24};function fs({onAdd:s,onEdit:l}){const{t:i}=B("relic"),{database:r}=ke(),[u,n]=Ie();f.useEffect(()=>r.relics.followAny(n),[r,n]);const{relicIds:o,totalRelicsNum:c}=f.useMemo(()=>{const v=r.relics.values,C=v.length,d=v.map(h=>h.id);return u&&{relicIds:d,totalRelicsNum:C}},[r,u]),y=St(),M=o.length!==c?`${o.length}/${c}`:c,{numShow:I,setTriggerElement:g}=Ct(ps[y],o.length),t=f.useMemo(()=>o.slice(0,I),[o,I]),x={numShowing:t.length,totalShowing:M};return p(Me,{children:[e(z,{bgt:"dark",children:e(Ae,{children:e(A,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:p(O,{color:"text.secondary",children:["Showing ",e("b",{children:x.numShowing})," out of"," ",x.totalShowing," Items"]})})})}),e(_,{container:!0,columns:Re,spacing:1,children:e(_,{item:!0,xs:!0,children:e(k,{fullWidth:!0,onClick:s,color:"info",startIcon:e(ee,{}),children:i`addNew`})})}),p(f.Suspense,{fallback:e(X,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[e(_,{container:!0,columns:Re,spacing:1,children:t.map(v=>e(_,{item:!0,xs:1,children:e(Y,{relic:r.relics.get(v),onEdit:()=>l==null?void 0:l(v),onDelete:()=>r.relics.remove(v),setLocation:C=>r.relics.set(v,{location:C}),onLockToggle:()=>r.relics.set(v,({lock:C})=>({lock:!C}))})},v))}),o.length!==t.length&&e(X,{ref:v=>{v&&g(v)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}function Ss(){const[s,l]=f.useState("");return p(A,{display:"flex",flexDirection:"column",gap:1,my:1,children:[e(us,{relicIdToEdit:s,cancelEdit:()=>l(""),allowEmpty:!0}),e(fs,{onAdd:()=>l("new"),onEdit:l})]})}export{Ss as default};
