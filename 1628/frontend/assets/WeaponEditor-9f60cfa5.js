import{e as u,n as p,p as t,T as S,K as w,dM as L,b as I,a_ as M,cr as R,dN as _,bv as A,bu as z,B,D as V,dO as b,C as W,t as E,am as te,u as ne,dP as ae,Q as se,J as x,s as oe,V as re,R as ie,_ as le,dQ as ce}from"./index-158f0932.js";import{T as de,w as ue,t as pe,f as fe,j as T}from"./index-50fce377.js";import{u as me}from"./useWeapon-e802802b.js";import{L as he,a as Ce,b as xe}from"./LocationAutocomplete-406eb2ee.js";import{C as ye}from"./CloseButton-b5d5c14f.js";import{D as v,d as G,F as ge,N as ve,L as be}from"./FieldDisplay-c1c2e16e.js";import{M as j,D as H}from"./DropdownButton-eed29567.js";import{S as U}from"./SqBadge-2b3e60d9.js";import{B as $}from"./ColoredText-5d4f1526.js";import{a as ke}from"./InfoTooltip-1c249f80.js";import{L as De}from"./LevelSelect-578a7fb6.js";import{b as we}from"./StarDisplay-bfc91ae8.js";import{g as Se}from"./index-8ec923a2.js";import{C as Te}from"./CardHeader-26bbb76f.js";const F=u.createContext({teamChar:{},team:{}});function Be({avatar:e,title:a,action:n}){return p(w,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,t(S,{variant:"subtitle1",sx:{flexGrow:1},children:a}),n&&t(S,{variant:"caption",children:n})]})}function Le({conditional:e,disabled:a=!1}){const{data:n}=u.useContext(v);return Object.keys(L(e.states,n)).length===1&&"path"in e?t(Ie,{conditional:e,disabled:a}):"path"in e?t(Oe,{conditional:e,disabled:a}):t(We,{conditional:e,disabled:a})}function Ie({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(F),{data:c}=u.useContext(v),l=I(),d=u.useCallback(h=>{l.teamChars.set(n,g=>{const C=M(g.conditional);h?R(C,e.path,h):_(C,e.path),g.conditional=C})},[l,e.path,n]),s=c.get(e.value).value,[o,i]=Object.entries(L(e.states,c))[0],m=N(i.name),y=P(e.name);return p(B,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s?"success":"primary",onClick:()=>d(s?void 0:o),disabled:a,startIcon:s?t(A,{}):t(z,{}),children:[y," ",m]})}function Oe({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(F),{data:c}=u.useContext(v),l=I(),d=u.useCallback(h=>{l.teamChars.set(n,g=>{const C=M(g.conditional);h?R(C,e.path,h):_(C,e.path),g.conditional=C})},[l,e.path,n]),s=c.get(e.value).value,o=L(e.states,c),i=s?o[s]:void 0,m=i?N(i.name):t(U,{color:"secondary",children:"Not Active"}),y=P(e.name);return p(H,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s&&i?"success":"primary",title:p("span",{children:[y," ",m]}),disabled:a,children:[t(j,{onClick:()=>d(),selected:!i,disabled:!i,children:t("span",{children:"Not Active"})}),t(V,{}),Object.entries(o).map(([h,g])=>t(j,{onClick:()=>d(h),selected:s===h,disabled:s===h,children:g.name},h))]})}function We({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(F),{data:c}=u.useContext(v),l=I(),d=u.useCallback((s,o)=>{l.teamChars.set(n,i=>{const m=M(i.conditional);o?R(m,s,o):_(m,s),i.conditional=m})},[l,n]);return t($,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(L(e.states,c)).map(([s,o])=>{const i=c.get(o.value).value,m=i===s;return t(B,{color:m?"success":"primary",disabled:a,fullWidth:!0,onClick:()=>d(o.path,i?void 0:s),size:"small",startIcon:m?t(A,{}):t(z,{}),sx:{borderRadius:0},children:P(o.name)},s)})})}function J(e){return typeof e!="string"}function N(e){if(!e)return"";let a="primary",n=e;return e&&J(e)&&e.props.color&&(a=e.props.color,n=t("span",{children:e.props.children})),t(U,{sx:{ml:.5},color:a,children:n})}function P(e){if(J(e)){const a=e.props.key18,n=e.props.ns,c=e.props.values;return t(de,{ns:n,key18:a,values:c,useBadge:!0})}return e}function je({conditional:e,hideHeader:a=!1,hideDesc:n=!1,disabled:c=!1}){var s;const{data:l}=u.useContext(v);let d;if("path"in e){const o=l.get(e.value).value,i=b(e.states,l);d=o&&((s=i[o])==null?void 0:s.fields)}else{const o=b(e.states,l);d=Object.values(o).flatMap(i=>l.get(i.value).value?i.fields:[])}return p(E,{children:[!b(a,e)&&t(Q,{header:e.header,hideDesc:n}),t(W,{sx:{p:0,"&:last-child":{pb:0}},children:t(Le,{conditional:e,disabled:c})}),d&&t(G,{fields:d})]})}function Me({sections:e,teamBuffOnly:a,hideDesc:n=!1,hideHeader:c=!1,disabled:l=!1}){const{data:d}=u.useContext(v);if(!e.length)return null;const s=e.map((o,i)=>o.canShow&&!d.get(o.canShow).value||a&&!o.teamBuff?null:t(Re,{section:o,hideDesc:n,hideHeader:c,disabled:l},i)).filter(o=>o);return s.length?t(w,{display:"flex",flexDirection:"column",gap:1,children:s}):null}function Re({section:e,hideDesc:a=!1,hideHeader:n=!1,disabled:c=!1}){return"fields"in e?t(_e,{section:e,hideDesc:a,hideHeader:n}):"states"in e?t(je,{conditional:e,hideDesc:a,hideHeader:n,disabled:c}):t(Ve,{section:e})}function _e({section:e,hideDesc:a,hideHeader:n}){return p(E,{children:[!b(n,e)&&e.header&&t(Q,{header:e.header,hideDesc:a,hideDivider:e.fields.length===0}),t(G,{fields:e.fields})]})}function Ve({section:e}){const{data:a}=u.useContext(v);return t("div",{children:b(e.text,a)})}function Q({header:e,hideDesc:a,hideDivider:n}){const{data:c}=u.useContext(v),{icon:l,title:d,action:s}=e,o=b(l,c),i=!a&&b(e.description,c);return p(te,{children:[t(Be,{avatar:o,title:a?d:p("span",{children:[d,t(ke,{title:t(S,{children:i})})]}),action:s}),!n&&t(V,{})]})}function Ee({refinement:e,setRefinement:a,disabled:n=!1}){const{t:c}=ne("ui");return t(H,{title:c("refinement",{value:e}),disabled:n,children:ae.map(l=>t(j,{onClick:()=>a(l),selected:e===l,disabled:e===l,children:c("refinement",{value:l})},l))})}const Fe=ie.lazy(()=>le(()=>import("./WeaponSelectionModal-72431bcc.js"),["./WeaponSelectionModal-72431bcc.js","./index-158f0932.js","./index-49338cde.css","./index-50fce377.js","./ColoredText-5d4f1526.js","./SqBadge-2b3e60d9.js","./index-8ec923a2.js","./totalUtils-138decb2.js","./CloseButton-b5d5c14f.js","./StarDisplay-bfc91ae8.js","./DropdownButton-eed29567.js","./WeaponCard-1ab28a74.js","./useWeapon-e802802b.js","./LocationAutocomplete-406eb2ee.js","./PageAndSortOptionSelect-862d1ff1.js","./CardActionArea-dc07d6b2.js","./WeaponToggle-4d48f4cb.js"],import.meta.url));function Pe({weaponId:e,footer:a=!1,onClose:n,extraButtons:c}){const{data:l}=u.useContext(v),d=I(),s=me(e),{key:o="",level:i=0,refinement:m=1,ascension:y=0,lock:h,location:g="",id:C}=s??{},r=o?Se(o):void 0,k=u.useCallback(f=>{d.weapons.set(e,f)},[e,d]),q=u.useCallback(f=>C&&d.weapons.set(C,{location:f}),[d,C]),X=u.useCallback(f=>f.weaponTypeKey===(r==null?void 0:r.weaponType),[r]),[Y,Z,K]=se(),ee=o?ue(o,y>=2):"";u.useEffect(()=>{if(!(!r||!k||r.key!==(s==null?void 0:s.key))&&r.rarity<=2&&(i>70||y>4)){const[f,D]=ce[0];k({level:f,ascension:D})}},[r,s,k,i,y]);const O=u.useMemo(()=>r&&s&&pe([r.data,fe(s)]),[r,s]);return t(re,{open:!!e,onClose:n,containerProps:{maxWidth:"md"},children:p(oe,{children:[t(Fe,{ascension:y,show:Y,onHide:K,onSelect:f=>k({key:f}),weaponTypeFilter:r&&r.weaponType}),t(W,{children:r&&O&&p(x,{container:!0,spacing:1.5,children:[t(x,{item:!0,xs:12,sm:3,children:p(x,{container:!0,spacing:1.5,children:[t(x,{item:!0,xs:6,sm:12,children:t(w,{component:"img",src:ee,className:`grad-${r.rarity}star`,sx:{maxWidth:256,width:"100%",height:"auto",borderRadius:1}})}),t(x,{item:!0,xs:6,sm:12,children:t(S,{children:t("small",{children:r.description})})})]})}),p(x,{item:!0,xs:12,sm:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[t(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:p($,{children:[t(B,{color:"info",onClick:Z,children:(r==null?void 0:r.name)??"Select a Weapon"}),(r==null?void 0:r.hasRefinement)&&t(Ee,{refinement:m,setRefinement:f=>k({refinement:f})}),c]})}),p(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:[r&&t(De,{level:i,ascension:y,setBoth:k,useLow:!r.hasRefinement}),t(B,{color:"error",onClick:()=>C&&d.weapons.set(C,{lock:!h}),startIcon:h?t(he,{}):t(Ce,{}),children:h?"Locked":"Unlocked"})]}),t(we,{stars:r.rarity}),t(S,{variant:"subtitle1",children:t("strong",{children:r.passiveName})}),t(S,{gutterBottom:!0,children:r.passiveName&&r.passiveDescription(O.get(T.weapon.refinement).value-1)}),p(w,{display:"flex",flexDirection:"column",gap:1,children:[p(E,{children:[t(Te,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),t(V,{}),t(ge,{children:[T.weapon.main,T.weapon.sub,T.weapon.sub2].map(f=>{const D=O.get(f);return D.isEmpty||!D.value?null:t(ve,{node:D,component:be},JSON.stringify(D.info))})})]}),l&&r.document&&t(Me,{sections:r.document})]})]})]})}),a&&C&&t(W,{sx:{py:1},children:p(x,{container:!0,spacing:1,children:[t(x,{item:!0,flexGrow:1,children:t(xe,{location:g,setLocation:q,filter:X,autoCompleteProps:{getOptionDisabled:f=>!f.key}})}),t(x,{item:!0,flexGrow:2}),!!n&&t(x,{item:!0,children:t(ye,{sx:{height:"100%"},large:!0,onClick:n})})]})})]})})}const et=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{Be as C,Me as D,Ee as R,F as T,Pe as W,et as a};
