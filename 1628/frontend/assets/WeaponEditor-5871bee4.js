import{e as u,n as f,p as t,T as S,K as w,dM as L,b as I,b2 as M,cs as R,dN as _,bz as P,by as A,B,D as V,dO as b,C as W,aA as z,am as te,u as ne,dP as ae,Q as se,J as y,t as oe,s as re,V as le,R as ie,_ as ce,dQ as de}from"./index-f0e7b885.js";import{T as ue,w as pe,H as fe,f as me,j as T}from"./index-67d8c015.js";import{u as he}from"./useWeapon-cd2723d8.js";import{L as Ce,a as xe,b as ye}from"./LocationAutocomplete-e9dd0f7a.js";import{C as ge}from"./CloseButton-8400d34a.js";import{D as v,d as G,F as ve,N as be,L as ke}from"./FieldDisplay-0c5a2463.js";import{M as j,D as H}from"./DropdownButton-9a04d807.js";import{S as U}from"./SqBadge-d117bee4.js";import{B as $}from"./ColoredText-eb0176d6.js";import{a as De}from"./InfoTooltip-04a556b3.js";import{L as we}from"./LevelSelect-801fd4e5.js";import{e as Se}from"./StarDisplay-89db295e.js";import{g as Te}from"./index-945c4762.js";import{C as Be}from"./CardHeader-4d80f530.js";const E=u.createContext({teamChar:{},team:{}});function Le({avatar:e,title:a,action:n}){return f(w,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,t(S,{variant:"subtitle1",sx:{flexGrow:1},children:a}),n&&t(S,{variant:"caption",children:n})]})}function Ie({conditional:e,disabled:a=!1}){const{data:n}=u.useContext(v);return Object.keys(L(e.states,n)).length===1&&"path"in e?t(Oe,{conditional:e,disabled:a}):"path"in e?t(We,{conditional:e,disabled:a}):t(je,{conditional:e,disabled:a})}function Oe({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(E),{data:l}=u.useContext(v),i=I(),d=u.useCallback(h=>{i.teamChars.set(n,g=>{const C=M(g.conditional);h?R(C,e.path,h):_(C,e.path),g.conditional=C})},[i,e.path,n]),s=l.get(e.value).value,[c,o]=Object.entries(L(e.states,l))[0],p=N(o.name),x=F(e.name);return f(B,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s?"success":"primary",onClick:()=>d(s?void 0:c),disabled:a,startIcon:s?t(P,{}):t(A,{}),children:[x," ",p]})}function We({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(E),{data:l}=u.useContext(v),i=I(),d=u.useCallback(h=>{i.teamChars.set(n,g=>{const C=M(g.conditional);h?R(C,e.path,h):_(C,e.path),g.conditional=C})},[i,e.path,n]),s=l.get(e.value).value,c=L(e.states,l),o=s?c[s]:void 0,p=o?N(o.name):t(U,{color:"secondary",children:"Not Active"}),x=F(e.name);return f(H,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s&&o?"success":"primary",title:f("span",{children:[x," ",p]}),disabled:a,children:[t(j,{onClick:()=>d(),selected:!o,disabled:!o,children:t("span",{children:"Not Active"})}),t(V,{}),Object.entries(c).map(([h,g])=>t(j,{onClick:()=>d(h),selected:s===h,disabled:s===h,children:g.name},h))]})}function je({conditional:e,disabled:a}){const{teamCharId:n}=u.useContext(E),{data:l}=u.useContext(v),i=I(),d=u.useCallback((s,c)=>{i.teamChars.set(n,o=>{const p=M(o.conditional);c?R(p,s,c):_(p,s),o.conditional=p})},[i,n]);return t($,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(L(e.states,l)).map(([s,c])=>{const o=l.get(c.value).value,p=o===s;return t(B,{color:p?"success":"primary",disabled:a,fullWidth:!0,onClick:()=>d(c.path,o?void 0:s),size:"small",startIcon:p?t(P,{}):t(A,{}),sx:{borderRadius:0},children:F(c.name)},s)})})}function J(e){return typeof e!="string"}function N(e){if(!e)return"";let a="primary",n=e;return e&&J(e)&&e.props.color&&(a=e.props.color,n=t("span",{children:e.props.children})),t(U,{sx:{ml:.5},color:a,children:n})}function F(e){if(J(e)){const a=e.props.key18,n=e.props.ns,l=e.props.values;return t(ue,{ns:n,key18:a,values:l,useBadge:!0})}return e}function Me({conditional:e,hideHeader:a=!1,hideDesc:n=!1,disabled:l=!1,bgt:i="normal"}){var c;const{data:d}=u.useContext(v);let s;if("path"in e){const o=d.get(e.value).value,p=b(e.states,d);s=o&&((c=p[o])==null?void 0:c.fields)}else{const o=b(e.states,d);s=Object.values(o).flatMap(p=>d.get(p.value).value?p.fields:[])}return f(z,{bgt:i,children:[!b(a,e)&&t(Q,{header:e.header,hideDesc:n}),t(W,{sx:{p:0,"&:last-child":{pb:0}},children:t(Ie,{conditional:e,disabled:l})}),s&&t(G,{bgt:i,fields:s})]})}function Re({sections:e,teamBuffOnly:a,hideDesc:n=!1,hideHeader:l=!1,disabled:i=!1,bgt:d="normal"}){const{data:s}=u.useContext(v);if(!e.length)return null;const c=e.map((o,p)=>o.canShow&&!s.get(o.canShow).value||a&&!o.teamBuff?null:t(_e,{section:o,hideDesc:n,hideHeader:l,disabled:i,bgt:d},p)).filter(o=>o);return c.length?t(w,{display:"flex",flexDirection:"column",gap:1,children:c}):null}function _e({section:e,hideDesc:a=!1,hideHeader:n=!1,disabled:l=!1,bgt:i="normal"}){return"fields"in e?t(Ve,{section:e,hideDesc:a,hideHeader:n,bgt:i}):"states"in e?t(Me,{conditional:e,hideDesc:a,hideHeader:n,disabled:l,bgt:i}):t(Ee,{section:e})}function Ve({section:e,hideDesc:a,hideHeader:n,bgt:l="normal"}){return f(z,{bgt:l,children:[!b(n,e)&&e.header&&t(Q,{header:e.header,hideDesc:a,hideDivider:e.fields.length===0}),t(G,{bgt:l,fields:e.fields})]})}function Ee({section:e}){const{data:a}=u.useContext(v);return t("div",{children:b(e.text,a)})}function Q({header:e,hideDesc:a,hideDivider:n}){const{data:l}=u.useContext(v),{icon:i,title:d,action:s}=e,c=b(i,l),o=!a&&b(e.description,l);return f(te,{children:[t(Le,{avatar:c,title:a?d:f("span",{children:[d,t(De,{title:t(S,{children:o})})]}),action:s}),!n&&t(V,{})]})}function Fe({refinement:e,setRefinement:a,disabled:n=!1}){const{t:l}=ne("ui");return t(H,{title:l("refinement",{value:e}),disabled:n,children:ae.map(i=>t(j,{onClick:()=>a(i),selected:e===i,disabled:e===i,children:l("refinement",{value:i})},i))})}const Pe=ie.lazy(()=>ce(()=>import("./WeaponSelectionModal-df983741.js"),["./WeaponSelectionModal-df983741.js","./index-f0e7b885.js","./index-3b646a07.css","./index-67d8c015.js","./ColoredText-eb0176d6.js","./SqBadge-d117bee4.js","./index-945c4762.js","./totalUtils-70e9a423.js","./CloseButton-8400d34a.js","./StarDisplay-89db295e.js","./DropdownButton-9a04d807.js","./WeaponCard-36fe97d6.js","./SolidToggleButtonGroup-4e8ff51e.js","./useWeapon-cd2723d8.js","./LocationAutocomplete-e9dd0f7a.js","./Autocomplete-1ed35f76.js","./CardActionArea-2857fde9.js","./WeaponToggle-a5fc8851.js"],import.meta.url));function Ae({weaponId:e,footer:a=!1,onClose:n,extraButtons:l}){const{data:i}=u.useContext(v),d=I(),s=he(e),{key:c="",level:o=0,refinement:p=1,ascension:x=0,lock:h,location:g="",id:C}=s??{},r=c?Te(c):void 0,k=u.useCallback(m=>{d.weapons.set(e,m)},[e,d]),q=u.useCallback(m=>C&&d.weapons.set(C,{location:m}),[d,C]),X=u.useCallback(m=>m.weaponTypeKey===(r==null?void 0:r.weaponType),[r]),[Y,Z,K]=se(),ee=c?pe(c,x>=2):"";u.useEffect(()=>{if(!(!r||!k||r.key!==(s==null?void 0:s.key))&&r.rarity<=2&&(o>70||x>4)){const[m,D]=de[0];k({level:m,ascension:D})}},[r,s,k,o,x]);const O=u.useMemo(()=>r&&s&&fe([r.data,me(s)]),[r,s]);return t(le,{open:!!e,onClose:n,containerProps:{maxWidth:"md"},children:f(re,{children:[t(Pe,{ascension:x,show:Y,onHide:K,onSelect:m=>k({key:m}),weaponTypeFilter:r&&r.weaponType}),t(W,{children:r&&O&&f(y,{container:!0,spacing:1.5,children:[t(y,{item:!0,xs:12,sm:3,children:f(y,{container:!0,spacing:1.5,children:[t(y,{item:!0,xs:6,sm:12,children:t(w,{component:"img",src:ee,className:`grad-${r.rarity}star`,sx:{maxWidth:256,width:"100%",height:"auto",borderRadius:1}})}),t(y,{item:!0,xs:6,sm:12,children:t(S,{children:t("small",{children:r.description})})})]})}),f(y,{item:!0,xs:12,sm:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[t(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:f($,{children:[t(B,{color:"info",onClick:Z,children:(r==null?void 0:r.name)??"Select a Weapon"}),(r==null?void 0:r.hasRefinement)&&t(Fe,{refinement:p,setRefinement:m=>k({refinement:m})}),l]})}),f(w,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:[r&&t(we,{level:o,ascension:x,setBoth:k,useLow:!r.hasRefinement}),t(B,{color:"error",onClick:()=>C&&d.weapons.set(C,{lock:!h}),startIcon:h?t(Ce,{}):t(xe,{}),children:h?"Locked":"Unlocked"})]}),t(Se,{stars:r.rarity}),t(S,{variant:"subtitle1",children:t("strong",{children:r.passiveName})}),t(S,{gutterBottom:!0,children:r.passiveName&&r.passiveDescription(O.get(T.weapon.refinement).value-1)}),f(w,{display:"flex",flexDirection:"column",gap:1,children:[f(oe,{children:[t(Be,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),t(V,{}),t(ve,{children:[T.weapon.main,T.weapon.sub,T.weapon.sub2].map(m=>{const D=O.get(m);return D.isEmpty||!D.value?null:t(be,{node:D,component:ke},JSON.stringify(D.info))})})]}),i&&r.document&&t(Re,{sections:r.document})]})]})]})}),a&&C&&t(W,{sx:{py:1},children:f(y,{container:!0,spacing:1,children:[t(y,{item:!0,flexGrow:1,children:t(ye,{location:g,setLocation:q,filter:X,autoCompleteProps:{getOptionDisabled:m=>!m.key}})}),t(y,{item:!0,flexGrow:2}),!!n&&t(y,{item:!0,children:t(ge,{sx:{height:"100%"},large:!0,onClick:n})})]})})]})})}const tt=Object.freeze(Object.defineProperty({__proto__:null,default:Ae},Symbol.toStringTag,{value:"Module"}));export{Le as C,Re as D,Fe as R,E as T,Ae as W,tt as a};
