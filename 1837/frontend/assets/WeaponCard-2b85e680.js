import{m as W,n as L,q as e,aq as S,p as t,s as _,Q as r,k as z,I,aC as k,c_ as B,u as U,d as J,f as h,cj as P,ck as V,bt as y,cl as E,$ as X,_ as Y,T as p,ci as Z,C as ee,b6 as ae,b7 as ne,w as se,B as T,a3 as te,t as oe}from"./index-59c4fd80.js";import{b as ie,C as re,i as le,l as ce}from"./LocationName-f05c2951.js";import{T as M,S as j,h as A}from"./SolidToggleButtonGroup-1f3f91b9.js";import{i as $}from"./index-6873d20e.js";import{u as pe}from"./useWeapon-9259db15.js";import{L as de,a as ue,b as me,d as he}from"./LocationAutocomplete-b798426d.js";import{g as ge}from"./index-714835cc.js";import{C as ye}from"./CardActionArea-9ac53781.js";const fe=A([...S]);function _e({value:a,totals:n,onChange:d,...u}){const g=W(),c=!L(g.breakpoints.up("sm"));return e(j,{exclusive:!0,value:a,...u,children:S.map(o=>e(M,{value:o,sx:{p:c?1:void 0,minWidth:c?0:"6em",display:"flex",gap:c?0:1},onClick:()=>d(fe(a,o)),children:t(r,{display:"flex",children:[e("strong",{children:o}),e(ie,{}),e(_,{label:n[o],size:"small"})]})},o))})}const xe=A([...z]);function ze({value:a,totals:n,onChange:d,...u}){const g=W(),c=!L(g.breakpoints.up("sm"));return e(j,{exclusive:!0,value:a,...u,children:z.map(o=>{var m;return t(M,{value:o,sx:{p:c?1:void 0,minWidth:c?0:"6em",display:"flex",gap:c?0:1},onClick:()=>d(xe(a,o)),children:[e(I,{src:(m=$.weaponTypes)==null?void 0:m[o],size:2,sideMargin:!0}),e(_,{label:n[o],size:"small"})]},o)})})}function Ie(){return{level:a=>a.level*(a.ascension+1),rarity:a=>k.weapon.data[a.key].rarity,name:a=>B.t(`weaponNames_gen:${a.key}`)}}function Be(){return{rarity:(a,n)=>n.includes(k.weapon.data[a.key].rarity),weaponType:(a,n)=>n.includes(k.weapon.data[a.key].weaponType),name:(a,n)=>B.t(`weaponNames_gen:${a.key}`).toLowerCase().includes(n.toLowerCase())}}const Me={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function je({weaponId:a,onClick:n,onEdit:d,onDelete:u,canEquip:g=!1,extraButtons:c}){const{t:o}=U(["page_weapon","ui"]),m=J(),l=pe(a),i=l!=null&&l.key?ge(l.key):void 0,D=h.useCallback(s=>s.weaponTypeKey===(i==null?void 0:i.weaponType),[i]),N=h.useCallback(s=>e(ye,{onClick:()=>n==null?void 0:n(a),children:s}),[n,a]),F=h.useCallback(s=>e(r,{children:s}),[]),K=h.useCallback(s=>a&&m.weapons.set(a,{location:s}),[m,a]),f=h.useMemo(()=>i&&l&&P([i.data,V(l)]),[i,l]);if(!l||!i||!f)return null;const{level:O,ascension:v,refinement:R,id:x,location:b="",lock:w}=l,G=f.get(y.weapon.type).value,H=[y.weapon.main,y.weapon.sub,y.weapon.sub2].map(s=>f.get(s)),q=E(l.key,v>=2);return e(h.Suspense,{fallback:e(X,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:300}}),children:t(oe,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t(re,{condition:!!n,wrapper:N,falseWrapper:F,children:[t(r,{className:`grad-${i.rarity}star`,sx:{position:"relative",pt:2,px:2},children:[!n&&e(Y,{color:"primary",onClick:()=>m.weapons.set(x,{lock:!w}),sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:w?e(de,{}):e(ue,{})}),t(r,{sx:{position:"relative",zIndex:1},children:[t(r,{component:"div",sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e(I,{size:2,src:$.weaponTypes[G]}),e(p,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1},children:e("strong",{children:i.name})})]}),t(p,{component:"span",variant:"h5",children:["Lv. ",O]}),t(p,{component:"span",variant:"h5",color:"text.secondary",children:["/",Z[v]]}),t(p,{variant:"h6",children:["Refinement ",e("strong",{children:R})]}),e(le,{stars:i.rarity,colored:!0})]}),e(r,{sx:{height:"100%",position:"absolute",right:0,top:0},children:e(r,{component:"img",src:q??"",width:"auto",height:"100%",sx:{float:"right"}})})]}),e(ee,{children:H.map(s=>{const{name:C,icon:Q}=ae(s.info);return C?t(r,{sx:{display:"flex"},children:[t(p,{flexGrow:1,children:[Q," ",C]}),e(p,{children:ne(s)})]},JSON.stringify(s.info)):null})})]}),t(r,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(r,{sx:{flexGrow:1},children:g?e(me,{location:b,setLocation:K,filter:D,autoCompleteProps:{getOptionDisabled:s=>!s.key}}):e(ce,{location:b})}),t(r,{display:"flex",gap:1,alignItems:"stretch",height:"100%",sx:{"& .MuiButton-root":{minWidth:0,height:"100%"}},children:[!!d&&e(se,{title:e(p,{children:o`page_weapon:edit`}),placement:"top",arrow:!0,children:e(T,{color:"info",size:"small",onClick:()=>d(x),children:e(he,{})})}),!!u&&e(T,{color:"error",size:"small",onClick:()=>u(x),disabled:!!b||w,children:e(te,{})}),c]})]})]})})}export{ze as W,_e as a,je as b,Be as c,Ie as d,Me as w};
