import{b as R,u as Ce,bh as ot,bg as rt,n as l,p as t,bI as _,bZ as ee,T as g,r as te,i as ae,j as ne,e as C,f as Q,E as it,bA as De,d8 as b,d9 as ct,da as v,db as M,bS as f,dc as z,dd as lt,de as _e,df as dt,ac as B,X as we,bY as Ie,cR as pe,cT as fe,cS as U,cQ as me,dg as ge,dh as G,cP as F,a4 as ut,d as $,b$ as ht,di as pt,c0 as X,cM as ft,dj as mt,cj as Me,cO as gt,b4 as q,c6 as yt,cD as vt,a1 as j,ab as xt,O as y,_ as se,t as O,be as bt,I as St,ci as Ct,bs as ye,ck as Dt,b5 as _t,b6 as wt,N as k,k as It,aw as oe,bb as Mt,dk as jt,cp as je,aj as ke,ba as re,b8 as Re,q as N,ch as Be,a7 as kt,dl as Rt,bn as Bt,o as Te,cu as Tt,a8 as $e,cf as Ne,c8 as $t,cg as Nt,bC as V,bi as Et,bG as ve,bv as Ot,dm as zt,c9 as Pt,ca as Wt,W as At,Y as Ee}from"./index-4f796d28.js";import{d as Ht}from"./Info-2062fba1.js";import{e as K,i as ie,l as Gt,C as Oe,h as Ft}from"./LocationName-a239e5e1.js";import{D as L}from"./DataContext-f7d69275.js";import{b as ze}from"./util-3e22b532.js";import{S as Vt}from"./SlotIcon-47b5e39b.js";import{b as qt,g as Kt}from"./index-d35a35f0.js";import{i as ce}from"./index-fe4eee67.js";import{u as Lt}from"./useWeapon-dfd13aff.js";import{g as Pe,W as We}from"./index-435ba63c.js";import{a as I,c as P,s as T,b as Z,g as W}from"./index-64f54c6e.js";import{C as E}from"./CardActionArea-7a43212c.js";function Ut(e){const a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(a,(s,r,o,i)=>r+r+o+o+i+i);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}function kn(e,a){if(e)return`rgba(${e.r},${e.g},${e.b},${a})`}function Yt(e){const a=R();return K(a.charMeta,e)}function Ae(e){const a=R();return K(a.chars,e)}function Qt(e){const a=R();return K(a.teams,e)}function Xt(e){const a=R();return K(a.teamChars,e)}function Zt({statKey:e,value:a,color:n,prefix:s="",typographyProps:r={}}){const{t:o}=Ce("statKey_gen"),i=ot(e),c=rt(a,i);return l(g,{color:n?`${n}.main`:void 0,...r,children:[t(ee,{statKey:e,iconProps:_})," ",o(e)," ",t("strong",{children:`${s}${c}${i}`})]},e)}var le={},Jt=ae;Object.defineProperty(le,"__esModule",{value:!0});var He=le.default=void 0,ea=Jt(te()),ta=ne,aa=(0,ea.default)((0,ta.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");He=le.default=aa;const na=C.createContext({});function sa({iconProps:e}){const[a,n]=C.useState(0);return C.useEffect(()=>{const s=setInterval(()=>n(r=>r+1),1e3);return()=>clearInterval(s)},[]),t(it,{ele:Q[a%Q.length],iconProps:e})}const x=e=>t(we,{ns:"elementalResonance_gen",key18:e}),J=e=>t(we,{ns:"elementalResonance",key18:e}),D=De(...Q.map(e=>b[e])),Ge=ct(Ie,e=>[`${e}_res_`,I(f.charKey,v(b.ele,4,M(.15)),{path:`${e}_res_`})]),oa={name:x("ProtectiveCanopy.name"),desc:x("ProtectiveCanopy.desc"),icon:l("span",{children:[t(sa,{iconProps:_})," x4"]}),canShow:e=>e.get(b.ele).value>=4,sections:[{teamBuff:!0,fields:Object.values(Ge).map(([e,a])=>({node:a}))}]},[ra,ia]=I(f.charKey,v(D,4,v(b.pyro,2,M(.25))),{path:"atk_"}),ca={name:x("FerventFlames.name"),desc:x("FerventFlames.desc"),icon:l("span",{children:[t(pe,{..._})," ",t(pe,{..._})]}),canShow:e=>e.get(b.pyro).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.cryo"),value:-40,unit:"%"},{node:ra}]}]},[la,da]=I(f.charKey,v(D,4,v(b.hydro,2,M(.25))),{path:"hp_"}),ua={name:x("SoothingWater.name"),desc:x("SoothingWater.desc"),icon:l("span",{children:[t(fe,{..._})," ",t(fe,{..._})]}),canShow:e=>e.get(b.hydro).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.pyro"),value:-40,unit:"%"},{node:la}]}]},Fe=["resonance","ShatteringIce"],Ve=P(Fe),[ha,pa]=I(f.charKey,v(D,4,v(b.cryo,2,z(Ve,"on",M(.15)))),{path:"critRate_"}),fa={name:x("ShatteringIce.name"),desc:x("ShatteringIce.desc"),icon:l("span",{children:[t(U,{..._})," ",t(U,{..._})]}),canShow:e=>e.get(b.cryo).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.electro"),value:-40,unit:"%"}]},{teamBuff:!0,path:Fe,value:Ve,name:T("enemyAffected.frozenOrCryo"),header:{title:x("ShatteringIce.name"),icon:t(U,{})},states:{on:{fields:[{node:ha}]}}}]},ma={name:x("HighVoltage.name"),desc:x("HighVoltage.desc"),icon:l("span",{children:[t(me,{..._})," ",t(me,{..._})]}),canShow:e=>e.get(b.electro).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,fields:[{text:T("effectDuration.hydro"),value:-40,unit:"%"}]}]},[ga,ya]=I(f.charKey,v(D,4,v(b.anemo,2,M(-.15))),{path:"staminaDec_"}),[va,xa]=I(f.charKey,v(D,4,v(b.anemo,2,M(.1))),{path:"moveSPD_"}),[ba,Sa]=I(f.charKey,v(D,4,v(b.anemo,2,M(-.05))),{path:"cdRed_"}),Ca={name:x("ImpetuousWinds.name"),desc:x("ImpetuousWinds.desc"),icon:l("span",{children:[t(ge,{..._})," ",t(ge,{..._})]}),canShow:e=>e.get(b.anemo).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,fields:[{node:ga},{node:va},{node:ba}]}]},qe=["resonance","EnduringRock"],Ke=P(qe),Le=["resonance","EnduringRockHit"],Ue=P(Le),[Da,_a]=I(f.charKey,v(D,4,v(b.geo,2,M(.15))),{path:"shield_"}),[wa,Ia]=I(f.charKey,v(D,4,v(b.geo,2,z(Ke,"on",M(.15)))),{path:"all_dmg_"}),[,Ma]=I(lt.charKey,Ia,{path:"all_dmg_"}),[ja,ka]=I(f.charKey,v(D,4,v(b.geo,2,z(Ue,"on",M(-.2)))),{path:"geo_enemyRes_"}),Ra={name:x("EnduringRock.name"),desc:x("EnduringRock.desc"),icon:l("span",{children:[t(G,{..._})," ",t(G,{..._})]}),canShow:e=>e.get(b.geo).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,text:x("EnduringRock.desc"),fields:[{node:Da}]},{teamBuff:!0,path:qe,value:Ke,header:{title:x("EnduringRock.name"),icon:t(G,{})},name:T("protectedByShield"),states:{on:{fields:[{node:_e(wa,{isTeamBuff:!1})}]}}},{teamBuff:!0,path:Le,value:Ue,header:{title:x("EnduringRock.name"),icon:t(G,{})},name:J("EnduringRock.hitCond"),states:{on:{fields:[{node:ja},{text:Z("duration"),value:15,unit:"s"}]}}}]},Ye=["resonance","SprawlingCanopy2ele"],Qe=P(Ye),Xe=["resonance","SprawlingCanopy3ele"],Ze=P(Xe),[Ba,Ta]=I(f.charKey,v(D,4,v(b.dendro,2,50)),{path:"eleMas"}),[$a,Na]=I(f.charKey,v(D,4,v(b.dendro,2,z(Qe,"on",30))),{path:"eleMas"}),[Ea,Oa]=I(f.charKey,v(D,4,v(b.dendro,2,z(Ze,"on",20))),{path:"eleMas"}),za={name:x("SprawlingGreenery.name"),desc:x("SprawlingGreenery.desc"),icon:l("span",{children:[t(F,{..._})," ",t(F,{..._})]}),canShow:e=>e.get(b.dendro).value>=2&&e.get(D).value>=4,sections:[{teamBuff:!0,text:x("SprawlingGreenery.desc"),fields:[{node:Ba}]},{teamBuff:!0,path:Ye,value:Qe,header:{title:x("SprawlingGreenery.name"),icon:t(F,{})},name:J("SprawlingGreenery.cond2ele"),states:{on:{fields:[{node:$a},{text:Z("duration"),value:6,unit:"s"}]}}},{teamBuff:!0,path:Xe,value:Ze,header:{title:x("SprawlingGreenery.name"),icon:t(F,{})},name:J("SprawlingGreenery.cond3ele"),states:{on:{fields:[{node:Ea},{text:Z("duration"),value:6,unit:"s"}]}}}]},Rn=[oa,ca,ua,fa,ma,Ca,Ra,za],Pa=dt({teamBuff:{premod:{...B(Ge,([e,a])=>a),atk_:ia,hp_:da,staminaDec_:ya,moveSPD_:xa,cdRed_:Sa,shield_:_a,geo_enemyRes_:ka,eleMas:_e(De(Ta,Na,Oa),{pivot:!0}),all_dmg_:Ma},total:{critRate_:pa}}});function Wa(e,a=0,n,s){const r=R(),[o,i]=ut(),c=C.useDeferredValue(o),{gender:d}=$(),h=C.useMemo(()=>c&&Ha(r,e,a,d,n,s),[c,d,e,r,a,n,s]);return C.useEffect(()=>e?r.chars.follow(e,i):void 0,[e,i,r]),h}class Aa{constructor(a){this.data={},a.chars.followAny(n=>{this.removeData(n)})}getData(a){return this.data[a]}cacheData(a,n){this.data[a]=n}removeData(a){delete this.data[a]}}const Y=new Map,xe=e=>{if(Y.has(e))return Y.get(e);const a=new Aa(e);return Y.set(e,a),a};function Ha(e,a,n=0,s,r,o){if(!a)return;if(!n&&!r&&!o){const p=xe(e).getData(a);if(p)return p}const{teamData:i,teamBundle:c}=Ga(e,a,n,r,o)??{};if(!i||!c)return;const d=ht(i,s,a),h=B(d,(p,u)=>{const{data:m,...S}=c[u];return{...p,...S}});return!n&&!r&&!o&&xe(e).cacheData(a,h),h}function Ga(e,a,n=0,s,r){if(!a)return;const o=e.chars.get(a);if(!o)return;const i=Fa(e,!0,n,o,r||(e.weapons.get(o.equippedWeapon)??pt()),s??Object.values(o.equippedArtifacts).map(h=>e.arts.get(h)).filter(h=>h));if(!i)return;const c={[a]:i};return{teamData:{[a]:i.data},teamBundle:c}}function Fa(e,a=!1,n,s,r,o){const i=W(s.key,e.gender);if(!i)return;const c=Pe(r.key);if(!c)return;const d=We.getAllDataOfType(i.weaponTypeKey),h=a?(()=>{const{display:S,...w}=c.data;return X([w,d])})():c.data,p=X([i.data,h,qt]),m=[...Array.isArray(o)?o.map(S=>ft(S,n)):[o],mt(s),Me(r),p,gt,Pa];return{character:s,weapon:r,characterSheet:i,weaponSheet:c,data:m}}function Va({art:e,children:a}){const n=t(y,{children:t(se,{variant:"rectangular",width:100,height:100})}),s=t(C.Suspense,{fallback:n,children:t(qa,{art:e})});return t(q,{placement:"top",title:s,disableInteractive:!0,children:a})}function qa({art:e}){const{t:a}=Ce("statKey_gen"),n=Kt(e.setKey),{slotKey:s,level:r,rarity:o,mainStatKey:i,substats:c}=e,d=n.getSlotName(s),h=yt.getVariant(i);return l(y,{p:1,children:[l(g,{variant:"h6",children:[t(Vt,{slotKey:s,iconProps:_})," ",d]}),l(g,{variant:"subtitle1",color:`${h}.main`,children:[t(ee,{statKey:i,iconProps:_})," ",a(i)," ",vt(i,o,r)]}),l(g,{variant:"subtitle2",sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t(ie,{stars:o}),l(j,{color:ze(r),children:["+",r]})," "]}),t(y,{py:1,children:c.map(({value:p,key:u,rolls:m})=>!!(p&&u)&&t(Zt,{statKey:u,value:p,color:`roll${xt(m.length,1,6)}`,prefix:"+"},u))}),t(g,{color:"success.main",children:n.name}),t(Gt,{color:"secondary.main",location:e.location})]})}function Ka({artifactObj:e,slotKey:a}){if(!e)return t(O,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:t(y,{sx:{width:"100%",pb:"100%",position:"relative"},children:t(y,{sx:{position:"absolute",width:"70%",height:"70%",left:"50%",top:"50%",transform:"translate(-50%, -50%)",opacity:.7},component:"img",src:ce.slot[a]})})});const{mainStatKey:n,rarity:s,level:r}=e,i=Ie.find(c=>e.mainStatKey.includes(c))??"secondary";return t(Va,{art:e,children:l(O,{sx:{display:"flex",flexDirection:"column",position:"relative"},children:[t(y,{component:"img",className:`grad-${s}star`,src:bt(e.setKey,e.slotKey),maxWidth:"100%",maxHeight:"100%"}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none"},children:t("strong",{children:t(j,{sx:{p:.5},color:ze(r),children:l("strong",{children:["+",r]})})})}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t(j,{color:i,sx:{p:.5},children:t(ee,{statKey:n,iconProps:{fontSize:"inherit"}})})})]})})}function La({sheet:e,addlText:a,children:n}){const s=l(C.Suspense,{fallback:t(se,{variant:"text",width:100}),children:[l(g,{children:[t(St,{src:ce.weaponTypes[e.weaponType],size:1.5})," ",e.name]}),a]});return t(q,{placement:"top",title:s,disableInteractive:!0,children:n})}function Ua({weaponId:e}){const a=Lt(e);return a?t(Je,{weapon:a}):null}function Je({weapon:e}){const a=(e==null?void 0:e.key)&&Pe(e.key),n=C.useMemo(()=>a&&e&&Ct([a.data,Me(e)]),[a,e]);if(!e||!a||!n)return null;const s=l(y,{children:[t(be,{node:n.get(ye.weapon.main)}),t(be,{node:n.get(ye.weapon.sub)})]});return l(O,{sx:{height:"100%",maxWidth:128,position:"relative",display:"flex",flexDirection:"column"},children:[t(y,{display:"flex",flexDirection:"column",alignContent:"flex-end",className:`grad-${a.rarity}star`,children:t(La,{sheet:a,addlText:s,children:t(y,{component:"img",src:Dt(e.key,e.ascension>=2),maxWidth:"100%",maxHeight:"100%",sx:{mt:"auto"}})})}),t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none"},children:t("strong",{children:t(j,{color:"primary",children:We.getLevelString(e)})})}),a.hasRefinement&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t("strong",{children:l(j,{color:"secondary",children:["R",e.refinement]})})})]})}function be({node:e}){const{icon:a}=_t(e.info);return l(g,{children:[a," ",wt(e)]})}function Ya({hideWeapon:e=!1}){var n;const{data:a}=C.useContext(L);return t(y,{children:l(k,{container:!0,columns:e?5:6,spacing:.5,children:[!e&&t(k,{item:!0,xs:1,height:"100%",children:t(Ua,{weaponId:((n=a.get(f.weapon.id).value)==null?void 0:n.toString())??""})}),t(Qa,{})]})})}function Qa(){const e=R(),{data:a}=C.useContext(L),n=It.map(s=>{var r;return[s,e.arts.get(((r=a.get(f.art[s].id).value)==null?void 0:r.toString())??"")]});return t(oe,{children:n.map(([s,r])=>t(k,{item:!0,xs:1,children:t(Ka,{artifactObj:r,slotKey:s})},s))})}function Xa({weapon:e}){return t(y,{children:l(k,{container:!0,columns:e?6:5,spacing:.5,sx:{},children:[e&&t(k,{item:!0,xs:1,height:"100%",children:t(Je,{weapon:e})}),t(k,{item:!0,xs:5,children:t(Mt,{sx:{backgroundColor:"info.main",height:"44px",display:"flex",justifyContent:"center",alignItems:"center"},children:t(g,{children:"TC Build"})})})]})})}function et(e,a,n){const s=jt(e,a),r=je(e,"icon",a);return n&&s?s:r||""}function Za({children:e,characterKey:a,onClick:n}){const{gender:s}=$(),{silly:r}=C.useContext(ke),o=re(a),i=C.useCallback(d=>t(E,{onClick:n,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:d}),[n]),c=je(a,"banner",s);return t(Oe,{condition:!!n,wrapper:i,children:l(y,{display:"flex",position:"relative",className:c?void 0:`grad-${o.rarity}star`,sx:{"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.5,backgroundImage:`url(${c})`,backgroundPosition:"center",backgroundSize:"cover"}},width:"100%",children:[t(y,{flexShrink:1,component:"img",src:et(a,s,r),sx:{maxWidth:"40%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1}),t(y,{flexGrow:1,sx:{py:1,pr:1},display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-between",children:e})]})})}function Ja({characterKey:e}){const{gender:a}=$(),{data:n}=C.useContext(L),s=n.get(f.charEle).value,r=n.get(f.lvl).value,o=n.get(f.constellation).value,i=n.get(f.asc).value,c=n.get(f.total.autoBoost).value,d=n.get(f.total.skillBoost).value,h=n.get(f.total.burstBoost).value,p=n.get(f.total.auto).value,u=n.get(f.total.skill).value,m=n.get(f.total.burst).value,S=re(e);return l(oe,{children:[t(N,{label:t(g,{variant:"subtitle1",children:t(Re,{characterKey:e,gender:a})}),size:"small",color:s,sx:{opacity:.85}}),l(y,{display:"flex",gap:1,sx:{textShadow:"0 0 5px gray"},alignItems:"center",children:[l(y,{children:[l(g,{component:"span",variant:"h6",whiteSpace:"nowrap",children:["Lv. ",r]}),l(g,{component:"span",variant:"h6",color:"text.secondary",children:["/",Be[i]]})]}),t(g,{component:"span",whiteSpace:"nowrap",sx:{opacity:.85},children:t(j,{color:`roll${o<3?3:o}`,children:t(kt,{color:"white",children:l("strong",{children:["C",o]})})})})]}),l(y,{display:"flex",gap:1,sx:{opacity:.85},children:[t(N,{size:"small",color:c?"info":"secondary",label:t("strong",{children:p})}),t(N,{size:"small",color:d?"info":"secondary",label:t("strong",{children:u})}),t(N,{size:"small",color:h?"info":"secondary",label:t("strong",{children:m})})]}),t(g,{variant:"h6",lineHeight:1,children:t(ie,{stars:S.rarity,colored:!0,inline:!0})})]})}function Bn({characterKey:e}){const{gender:a}=$(),n=re(e),s=W(e,a);return l(oe,{children:[t(N,{label:t(g,{variant:"subtitle1",children:t(Re,{characterKey:e,gender:a})}),size:"small",color:s.elementKey,sx:{opacity:.85}}),t(y,{mt:1,children:t(g,{variant:"h4",children:t(j,{children:"NEW"})})}),t(g,{mt:1.5,children:t(ie,{stars:n.rarity,colored:!0})})]})}var de={},en=ae;Object.defineProperty(de,"__esModule",{value:!0});var tt=de.default=void 0,tn=en(te()),an=ne,nn=(0,tn.default)((0,an.jsx)("path",{d:"M21.6 18.2 13 11.75v-.91c1.65-.49 2.8-2.17 2.43-4.05-.26-1.31-1.3-2.4-2.61-2.7C10.54 3.57 8.5 5.3 8.5 7.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .84-.69 1.52-1.53 1.5-.54-.01-.97.45-.97.99v1.76L2.4 18.2c-.77.58-.36 1.8.6 1.8h18c.96 0 1.37-1.22.6-1.8zM6 18l6-4.5 6 4.5H6z"}),"Checkroom");tt=de.default=nn;const Se=Rt(Bt({dyn:{...f.art,...f.artSet}})),sn={art:Te([...Tt,...$e],e=>Se.dyn[e]),artSet:B(f.artSet,(e,a)=>Se.dyn[a])};function Tn(e,a,n){const s={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},r=new Set;for(const o of e){const i=Ne(o.mainStatKey,o.rarity,Math.max(Math.min(a,$t[o.rarity]),o.level)),c={id:o.id,set:o.setKey,values:{[o.setKey]:1,[o.mainStatKey]:i,...Object.fromEntries(o.substats.map(d=>[d.key,d.key.endsWith("_")?d.accurateValue/100:d.accurateValue]))}};delete c.values[""],s.values[o.slotKey].push(c),Object.keys(c.values).forEach(d=>r.add(d))}if(s.base=Te([...r],o=>0),n)for(const o of Object.values(s.values))o.push({id:"",values:{}});return s}function $n(e,a,n){var p;const{artifact:{sets:s},optimization:{target:r,minTotal:o}}=n;if(!r)return{};const i=(p=e[a])==null?void 0:p.target.data[0];if(!i)return{};Object.assign(i,X([i,sn]));const c=Et(i.display??{},r);if(!c)return{};const d=Object.keys(o).map(u=>i.total[u]).filter(u=>u);let h=ve([c,...d],i,({path:[u]})=>u!=="dyn");return h=Ot(h,u=>{if(u.operation==="read"&&u.path[0]==="dyn"){const m=s[u.path[1]];if(m)return V(m);if(!$e.includes(u.path[1]))return V(0)}return u},u=>u),h=ve(h,{},u=>!1),{nodes:h}}function Nn(e){const a=new Set;return zt(e,{},n=>{const s=n.path[1];return a.add(s),s},1),a}function En(e){const{artifact:{slots:a,substats:{stats:n,type:s,rarity:r}}}=e,o=B(n,(d,h)=>Math.ceil(n[h]/Pt(h,r,s))),i=cn(a),c=rn(a);return{minSubLines:c,minOtherRolls:on(Object.entries(o),i,c)}}function on(e,a,n=4*5){const s=e.reduce((r,[o,i])=>{const c=5-(a[o]??0);return r+Math.min(i,c)},0);return n-s}function rn(e){return Object.values(e).reduce((a,{rarity:n,level:s})=>{const{high:r,low:o}=Wt[n];return a+(s>=4?r:o)},0)}function cn(e){const a={};return Object.values(e).forEach(({statKey:n})=>{a[n]=(a[n]??0)+1},0),a}function ln(e){const{artifact:{slots:a,substats:{stats:n},sets:s}}=e,r=B(n,(o,i)=>Nt(o,i));return Object.values(a).forEach(({statKey:o,rarity:i,level:c})=>r[o]=(r[o]??0)+Ne(o,i,c)),{art:B(r,(o,i)=>i.endsWith("_")?M(o):V(o)),artSet:B(s,o=>V(o))}}function On(e){const{weapon:{key:a,level:n,ascension:s,refinement:r}}=e;return{id:"",location:"",key:a,level:n,ascension:s,refinement:r,lock:!1}}var ue={},dn=ae;Object.defineProperty(ue,"__esModule",{value:!0});var at=ue.default=void 0,un=dn(te()),hn=ne,pn=(0,un.default)((0,hn.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");at=ue.default=pn;function fn({characterKey:e,onClick:a,onMouseDown:n,onMouseEnter:s,hoverChild:r,hideFav:o}){const i=Ae(e),{favorite:c}=Yt(e),{gender:d}=$(),{silly:h}=C.useContext(ke),p=W(e,d),u=C.useCallback(()=>a==null?void 0:a(e),[e,a]),m=C.useCallback(H=>t(E,{onClick:u,onMouseDown:n,onMouseEnter:s,children:H}),[u,n,s]),[S,w,A]=At();return t(q,{enterNextDelay:500,enterTouchDelay:500,placement:"top",open:!!r&&S,onClose:A,onOpen:w,title:r,children:t(O,{sx:{maxWidth:128,position:"relative",display:"flex",flexDirection:"column"},children:l(Oe,{condition:!!a||!!n||!!s,wrapper:m,children:[t(y,{display:"flex",className:`grad-${p.rarity}star`,children:t(y,{component:"img",src:et(e,d,h),maxWidth:"100%",maxHeight:"100%",draggable:!1})}),i&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",top:0},children:t("strong",{children:l(j,{color:"primary",children:[i.level,"/",Be[i.ascension]]})})}),!o&&t(y,{sx:{position:"absolute",top:0,right:0},children:c?t(Ft,{fontSize:"small"}):t(He,{fontSize:"small"})}),i&&t(g,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:t("strong",{children:l(j,{color:"secondary",children:["C",i.constellation]})})})]})})})}function mn({index:e}){return t(O,{sx:{display:"flex",alignItems:"center",justifyContent:"center",py:"12.5%"},children:t(y,{component:"img",src:ce.team[`team${e+1}`],sx:{width:"75%",height:"auto",opacity:.7}})})}function zn({teamId:e,onClick:a,hoverCard:n=!1,bgt:s}){const r=Qt(e),{name:o,description:i,loadoutData:c}=r,d=R(),h=c.map(p=>{if(!p)return;const u=d.teamChars.get(p.teamCharId);if(u)return W(u.key).elementKey});return t(Ee,{bgt:s,sx:{height:"100%"},children:l(y,{sx:p=>({height:"100%",display:"flex",flexDirection:"column",background:`linear-gradient(to right, ${h.map(m=>{if(!m)return"rgba(0,0,0,0)";const S=p.palette[m].main,w=Ut(S);return w?`rgba(${w.r},${w.g},${w.b},0.25)`:"rgba(0,0,0,0)"}).map((m,S)=>`${m} ${S*25+12.5}%`).join(", ")})`}),children:[t(E,{onClick:()=>a(),sx:{p:1},children:l(g,{sx:{display:"flex",gap:1},children:[t("span",{children:o})," ",i&&t(q,{title:t(g,{children:i}),children:t(Ht,{})})]})}),t(y,{sx:{p:1,marginTop:"auto"},children:t(k,{container:!0,columns:4,spacing:1,children:c.map((p,u)=>{var w;const m=p==null?void 0:p.teamCharId,S=m&&((w=d.teamChars.get(m))==null?void 0:w.key);return t(k,{item:!0,xs:1,height:"100%",children:S?t(E,{onClick:()=>a(S),children:t(fn,{characterKey:S,hoverChild:n&&t(gn,{characterKey:S,teamCharId:m,teamId:e}),hideFav:!0})}):t(E,{onClick:()=>a(),children:t(mn,{index:u})})},u)})})})]})})}function gn({characterKey:e,teamId:a,teamCharId:n}){var H;const s=R(),r=Ae(e),{gender:o}=$(),i=W(e,o),{name:c}=Xt(n),d=s.teams.getLoadoutDatum(a,n),h=s.teams.getActiveBuildName(d),p=(()=>s.teams.getLoadoutWeapon(d))(),u=(()=>{const{buildType:nt,buildTcId:he}=d;return nt==="tc"&&he?ln(s.buildTcs.get(he)):Object.values(s.teams.getLoadoutArtifacts(d)).filter(st=>st)})(),m=Wa(e,void 0,u,p),S=(H=m==null?void 0:m[e])==null?void 0:H.target,w=C.useMemo(()=>r&&i&&{character:r,characterSheet:i},[r,i]),A=C.useMemo(()=>S&&m&&{data:S,teamData:m},[S,m]);return!w||!A?null:t(na.Provider,{value:w,children:t(L.Provider,{value:A,children:t(y,{sx:{width:300,m:-1},children:t(C.Suspense,{fallback:t(se,{variant:"rectangular",width:"100%",height:300}),children:l(Ee,{children:[t(Za,{characterKey:e,children:t(Ja,{characterKey:e})}),l(y,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[l(g,{sx:{display:"flex",gap:1,alignItems:"center"},children:[t(at,{}),t("span",{children:c})]}),l(g,{sx:{display:"flex",gap:1,alignItems:"center"},children:[t(tt,{}),t("span",{children:h})]}),(d==null?void 0:d.buildType)==="tc"&&(d!=null&&d.buildTcId)?t(Xa,{weapon:p}):t(Ya,{})]})]})})})})})}export{Ka as A,na as C,Bn as H,zn as T,Ua as W,tt as a,fn as b,Za as c,at as d,Ja as e,Ya as f,ln as g,Tn as h,sn as i,En as j,Nn as k,On as l,Ut as m,kn as n,$n as o,Xt as p,Ae as q,Rn as r,Wa as s,Yt as t,Qt as u,He as v,Va as w,La as x,Pa as y,et as z};
