import{r as ee,i as te,j as ne,d as b,p as t,V as i,q as e,I as q,T as l,ax as k,B as w,D as A,ay as N,az as U,aA as F,aB as z,w as g,W as v,aC as _,s as D,af as ie,aD as re,x as B,ah as le,b as J,O as p,aE as Q,aF as se,N as X,aG as ae,aH as oe,aI as ce,aJ as de,Q as $,X as he}from"./index-DD5sM14Y.js";import{R as I,d as ue}from"./AccessTimeFilled-RUaEeDiE.js";var W={},me=te;Object.defineProperty(W,"__esModule",{value:!0});var K=W.default=void 0,pe=me(ee()),xe=ne,fe=(0,pe.default)((0,xe.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");K=W.default=fe;const O={advice:{name:"Wanderer's Advice",exp:1e3,cost:200,img:B.exp_books.advice},experience:{name:"Adventurer's Experience",exp:5e3,cost:1e3,img:B.exp_books.experience},wit:{name:"Hero's Wit",exp:2e4,cost:4e3,img:B.exp_books.wit}},T=[0,1e3,1325,1700,2150,2625,3150,3725,4350,5e3,5700,6450,7225,8050,8925,9825,10750,11725,12725,13775,14875,16800,18e3,19250,20550,21875,23250,24650,26100,27575,29100,30650,32250,33875,35550,37250,38975,40750,42575,44425,46300,50625,52700,54775,56900,59075,61275,63525,65800,68125,70475,76500,79050,81650,84275,86950,89650,92400,95175,98e3,100875,108950,112050,115175,118325,121525,124775,128075,131400,134775,138175,148700,152375,156075,159825,163600,167425,171300,175225,179175,183175,216225,243025,273100,306800,344600,386950,434425,487625,547200],ge=[20,40,50,60,70,80,90];function be(){return{mora:0,level:1,curExp:0,goUnder:!1,books:{advice:0,experience:0,wit:0}}}function ve(){const[s,n]=b.useState(()=>be()),{mora:m,level:h,curExp:o,goUnder:a,books:c,books:{advice:x,experience:f,wit:u}}=s,r=ge.find(d=>d>h);let y=-o;for(let d=h;d<Math.min(r,T.length);d++)y+=T[d];const R=Ce(u,f,x,y,a)||[],[M=0,j=0,H=0]=R,Z={advice:H,experience:j,wit:M},L=M*2e4+j*5e3+H*1e3,V=L/5,Y=y-L,G=m-V;let E=L+o,C=h;for(;C<Math.min(r,T.length)&&T[C]<=E;C++)E-=T[C];C===r&&(E=0);let S="";return G<0?S=t("span",{children:["You don't have enough ",e("b",{children:"Mora"})," for this operation."]}):R.length===0?S=t("span",{children:["You don't have enough ",e("b",{children:"EXP. books"})," to level to the next milestone."]}):h===90&&(S="You are at the maximum level."),t(g,{children:[t(i,{container:!0,sx:{px:2,py:1},spacing:2,children:[e(i,{item:!0,children:e(q,{src:O.wit.img,size:2})}),e(i,{item:!0,flexGrow:1,children:e(l,{variant:"h6",children:"Experience Calculator"})}),e(i,{item:!0,children:t(k,{children:[e(w,{color:"primary",disabled:!a,onClick:()=>n({...s,goUnder:!1}),children:"Full Level"}),e(w,{color:"primary",disabled:a,onClick:()=>n({...s,goUnder:!0}),children:"Don't fully level"})]})})]}),e(A,{}),e(D,{children:t(i,{container:!0,spacing:1,children:[e(i,{item:!0,children:t(l,{children:[t("span",{children:["This calculator tries to calculate the amount of exp books required to get to the next milestone level."," "]}),a?"It will try to get as close to the milestone level as possible, so you can grind the rest of the exp without any waste.":"It will try to calculate the amount of books needed to minimize as much exp loss as possible."]})}),e(i,{item:!0,xs:6,md:3,children:t(k,{sx:{display:"flex"},children:[e(N,{children:"Current Level"}),e(U,{sx:{flexBasis:30,flexGrow:1},children:e(F,{value:h,onChange:d=>n({...s,level:z(d??0,0,90)}),sx:{px:2}})})]})}),e(i,{item:!0,xs:6,md:3,children:t(k,{sx:{display:"flex"},children:[e(N,{children:"Current EXP."}),e(U,{sx:{flexBasis:30,flexGrow:1},children:e(F,{value:o,onChange:d=>n({...s,curExp:z(d??0,0,(T[h]||1)-1)}),endAdornment:`/${T[h]||0}`,sx:{px:2}})})]})}),e(i,{item:!0,xs:6,md:3,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"Next Milestone Level:"}),e(l,{children:e("b",{children:r})})]})})}),e(i,{item:!0,xs:6,md:3,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"EXP. to milestone:"}),e(l,{children:t("span",{children:[e("strong",{children:L})," / ",e("strong",{children:y})]})})]})})}),Object.entries(c).map(([d])=>e(i,{item:!0,xs:12,md:4,children:e(ye,{bookKey:d,value:c[d],setValue:P=>n({...s,books:{...c,[d]:P}}),required:Z[d]})},d)),e(i,{item:!0,xs:12,md:4,children:t(k,{sx:{display:"flex"},children:[e(N,{children:"Current Mora"}),e(U,{sx:{flexBasis:30,flexGrow:1},children:e(F,{value:m,onChange:d=>n({...s,mora:Math.max(d??0,0)}),sx:{px:2}})})]})}),e(i,{item:!0,xs:12,md:4,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"Mora Cost: "}),e(l,{children:e("b",{children:V})})]})})}),e(i,{item:!0,xs:12,md:4,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[t(l,{children:["EXP ",a?"Diff":"Waste",": "]}),e(l,{children:e("b",{children:e(_,{color:Y<0?"error":"success",children:Y})})})]})})}),e(i,{item:!0,xs:12,md:4,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"Final Mora: "}),e(l,{children:e("b",{children:e(_,{color:G<0?"error":"success",children:G})})})]})})}),e(i,{item:!0,xs:12,md:4,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"Final Level: "}),e(l,{children:e("b",{children:e(_,{color:"success",children:C})})})]})})}),e(i,{item:!0,xs:12,md:4,children:e(g,{bgt:"light",children:t(v,{sx:{p:1,display:"flex",justifyContent:"space-between"},children:[e(l,{children:"Final EXP: "}),e(l,{children:e("b",{children:e(_,{color:E<0?"error":"success",children:E})})})]})})})]})}),e(A,{}),e(D,{sx:{py:1},children:t(i,{container:!0,spacing:2,children:[e(i,{item:!0,flexGrow:1,children:!!S&&e(ie,{variant:"filled",severity:"error",children:S})}),e(i,{item:!0,xs:"auto",children:e(w,{disabled:!!S,onClick:()=>n({...s,level:C,curExp:E,books:re(Z,(d,P)=>c[P]-d),mora:G}),color:"success",startIcon:e(K,{}),sx:{height:"100%"},children:"Apply"})})]})})]})}function ye(s){const{bookKey:n,value:m=0,setValue:h,required:o=0}=s;return t(g,{bgt:"light",children:[e(D,{sx:{py:1},children:e(l,{children:O[n].name})}),e(A,{}),e(D,{children:t(i,{container:!0,children:[e(i,{item:!0,xs:3,children:e(le,{src:O[n].img})}),t(i,{item:!0,xs:9,children:[t(k,{sx:{display:"flex"},children:[e(N,{children:"Amount"}),e(U,{sx:{flexBasis:30,flexGrow:1},children:e(F,{value:m,onChange:a=>h(Math.max(a??0,0)),sx:{px:2}})})]}),t(v,{display:"flex",justifyContent:"space-between",mt:1,children:[e(l,{children:"Required:"}),e(l,{children:e("b",{children:e(_,{color:o?"success":void 0,children:o})})})]})]})]})})]})}function Ce(s,n,m,h,o){let a=o?Math.floor(h/1e3):Math.ceil(h/1e3);const c=Math.min(Math.floor(a/20),s);a-=c*20;const x=Math.min(Math.floor(a/5),n);a-=x*5;const f=Math.min(a,m);return a-=f,o||a===0?[c,x,f]:x===3&&c!==s?[c+1,0,0]:x!==n?[c,x+1,0]:c!==s?[c+1,0,0]:null}const Te=[0,-1,-10,-20,-30,-40,-60,1,60,p];function we(){const s=J(),[{resin:n,resinDate:m},h]=b.useState(()=>s.displayTool.get());b.useEffect(()=>s.displayTool.follow((r,y)=>h(y)),[s]);const o=b.useRef(void 0),a=r=>{r>=p?(o.current&&clearTimeout(o.current),o.current=void 0):o.current=setTimeout(()=>console.log("set resin",r+1),I),s.displayTool.set({resin:r,resinDate:new Date().getTime()})};b.useEffect(()=>{if(n<p){const r=Date.now(),y=p-n,R=Math.min(Math.floor((r-m)/I),y),M=n+R,j=m+R*I;s.displayTool.set({resin:M,resinDate:j}),M<p&&(o.current=setTimeout(()=>a(M+1),r-j))}return()=>o.current&&clearTimeout(o.current)},[]);const c=n>=p?m:m+I,x=n>=p?m:m+(p-n)*I,f=new Date(x),u=Q(Math.abs(c-Date.now()));return t(g,{children:[t(i,{container:!0,sx:{px:2,py:1},spacing:2,children:[e(i,{item:!0,children:e(q,{src:B.resin.fragile,size:2})}),e(i,{item:!0,children:e(l,{variant:"h6",children:"Resin Counter"})})]}),e(A,{}),e(D,{children:t(i,{container:!0,spacing:2,children:[e(i,{item:!0,children:t(l,{variant:"h2",children:[e(q,{src:B.resin.fragile}),e(se,{type:"number",sx:{width:"2em",fontSize:"4rem"},value:n,inputProps:{min:0,max:999,sx:{textAlign:"right"}},onChange:r=>a(parseInt(r.target.value))}),t("span",{children:["/",p]})]})}),t(i,{item:!0,flexGrow:1,children:[e(k,{fullWidth:!0,children:Te.map(r=>r===0?e(w,{onClick:()=>a(r),disabled:n===0,children:r}):r===p?t(w,{onClick:()=>a(p),disabled:n>=p,children:["MAX ",r]}):r>0?e(w,{onClick:()=>a(n+r),disabled:n>=p,children:r}):e(w,{onClick:()=>a(n+r),disabled:n<Math.abs(r),children:r}))}),e(l,{variant:"subtitle1",sx:{mt:2},children:n<p?t("span",{children:["Next resin in ",u,", full Resin at"," ",f.toLocaleTimeString()," ",f.toLocaleDateString()]}):t("span",{children:["Resin has been full for at least ",u,", since"," ",f.toLocaleTimeString()," ",f.toLocaleDateString()]})})]}),e(i,{item:!0,xs:12,children:e(l,{variant:"caption",children:"Because we do not provide a mechanism to synchronize resin time, actual resin recharge time might be as much as 8 minutes earlier than predicted."})})]})})]})}function De(){const s=J(),[{timeZoneKey:n},m]=b.useState(()=>s.displayTool.get());b.useEffect(()=>s.displayTool.follow((u,r)=>m(r)),[s]);const h=b.useCallback(u=>s.displayTool.set({timeZoneKey:u}),[s]),[o,a]=b.useState(new Date(Date.now()+X[n]));b.useEffect(()=>{const u=()=>(a(new Date(Date.now()+X[n])),setTimeout(()=>{r=u()},$-Date.now()%$));let r=u();return()=>clearTimeout(r)},[n]);let c=new Date(o);c.getUTCHours()<4||(c=new Date(c.getTime()+ae)),c.setUTCHours(4,0,0,0);const x=c.getTime()-o.getTime(),f=Q(x);return t(g,{children:[t(D,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(ue,{}),e(l,{variant:"h6",sx:{flexGrow:1},children:"Teyvat Time"}),e(ce,{title:n,children:Object.keys(X).map(u=>e(oe,{selected:n===u,disabled:n===u,onClick:()=>h(u),children:u},u))})]}),e(A,{}),e(D,{children:t(i,{container:!0,justifyContent:"center",spacing:3,children:[e(i,{item:!0,sx:{my:4},children:e(l,{variant:"h2",children:o.toLocaleTimeString([],{timeZone:"UTC"})})}),t(i,{item:!0,display:"flex",flexDirection:"column",justifyContent:"space-around",children:[t(l,{children:["Server Date: ",e("b",{children:o.toDateString()})]}),t(l,{children:["Time until reset: ",e("b",{children:f})]}),t(l,{children:["Resin until reset:"," ",e("b",{children:Math.floor(x/(8*de))})]})]})]})})]})}function Se(){return he.send({hitType:"pageview",page:"/tools"}),t(v,{display:"flex",flexDirection:"column",gap:1,children:[e(De,{}),e(we,{}),e(ve,{})]})}export{Se as default};
