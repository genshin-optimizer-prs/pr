"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[669],{14669:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ie});var r=a(45492),n=a(42745),s=a(31653),l=a(83568),c=a(46342),i=a(93553),o=a(67550),h=a(7671),u=a(41075),d=a(13780),Z=a(83249),p=a(79906),g=a(56961),m=a(2784),f=a(61877),y=a(11141),x=a(73557),C=a(24264),v=a(18835),w=a(96703),b=a(66146),k=a(42090),P=a(89279),W=a(28265),K=a(23657),S=a(44180),B=a(25616);var z=a(64303),I=a(2313),M=a(96736),T=a(13230),D=a(99487),V=a(64583),$=a(4311),j=a(76260),X=a(67245),N=a(62197),E=a(32404),A=a(23690),H=a(86512),L=a(52218),_=a(73611),F=a(47513),G=a(29798),O=a(52322);const R=(0,G.Z)((0,O.jsx)("path",{d:"M17.5 9.5C17.5 6.46 15.04 4 12 4S6.5 6.46 6.5 9.5c0 2.7 1.94 4.93 4.5 5.4V17H9v2h2v2h2v-2h2v-2h-2v-2.1c2.56-.47 4.5-2.7 4.5-5.4zm-9 0C8.5 7.57 10.07 6 12 6s3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5z"}),"Female"),U=(0,G.Z)((0,O.jsx)("path",{d:"M9.5 11c1.93 0 3.5 1.57 3.5 3.5S11.43 18 9.5 18 6 16.43 6 14.5 7.57 11 9.5 11zm0-2C6.46 9 4 11.46 4 14.5S6.46 20 9.5 20s5.5-2.46 5.5-5.5c0-1.16-.36-2.23-.97-3.12L18 7.42V10h2V4h-6v2h2.58l-3.97 3.97C11.73 9.36 10.66 9 9.5 9z"}),"Male");var q=a(52903);function J(){const{t:e}=(0,y.$G)("ui"),t=(0,l.Wz)(),{character:a}=(0,m.useContext)(T.K),{key:r}=a,{gender:n}=(0,l.Hz)(),s=(0,m.useCallback)((()=>t.dbMeta.set({gender:"F"===n?"M":"F"})),[n,t]);return r.startsWith("Traveler")?(0,q.BX)(Z.Z,{onClick:s,startIcon:"F"===n?(0,q.tZ)(R,{}):(0,q.tZ)(U,{}),children:[(0,q.tZ)("strong",{children:e(`gender.${n}`)})," "]}):null}var Y=a(40637);function Q({onClose:e}){const t=(0,l.Wz)(),{character:a,character:{key:r},characterSheet:n}=(0,m.useContext)(T.K);return(0,q.BX)(o.Z,{display:"flex",flexDirection:"column",gap:1,children:[(0,q.BX)(o.Z,{display:"flex",gap:1,children:[(0,q.tZ)(J,{}),!!e&&(0,q.tZ)(A.Z,{onClick:e,sx:{marginLeft:"auto"}})]}),(0,q.tZ)(o.Z,{children:(0,q.BX)(u.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,q.tZ)(u.ZP,{item:!0,xs:8,sm:5,md:4,lg:3,children:(0,q.BX)(M.s8,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[(0,q.tZ)(_.A$,{}),(0,q.tZ)(o.Z,{sx:{px:1},children:(0,q.tZ)(H.Z,{level:a.level,ascension:a.ascension,setBoth:e=>t.chars.set(r,e)})}),(0,q.tZ)(o.Z,{sx:{px:2},children:(0,q.tZ)(L.D,{})}),(0,q.tZ)(N.Z,{sx:{textAlign:"center",pb:-1},variant:"h6",children:n.constellationName}),(0,q.tZ)(_.tt,{})]})}),(0,q.BX)(u.ZP,{item:!0,xs:12,sm:7,md:8,lg:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,q.tZ)(o.Z,{children:(0,q.tZ)(u.ZP,{container:!0,columns:3,spacing:1,children:["auto","skill","burst"].map((e=>(0,q.tZ)(u.ZP,{item:!0,xs:1,children:(0,q.tZ)(Y.Z,{talentKey:e},e)})))})}),(0,q.tZ)(ee,{})]})]})})]})}function ee(){const{character:{key:e}}=(0,m.useContext)(T.K),{data:t}=(0,m.useContext)(D.R),a=(0,l.Wz)(),r=(0,X.Ru)(e).weaponType,c=t.get(E.ri.weapon.id).value,i=(0,m.useMemo)((()=>(0,n.K8)(s.Ex,(e=>t.get(E.ri.art[e].id).value))),[t]);return(0,q.tZ)(o.Z,{children:(0,q.tZ)(F.ZP,{weaponTypeKey:r,weaponId:c,artifactIds:i,setWeapon:t=>{a.weapons.set(t,{location:(0,s.V7)(e)})},setArtifact:t=>{a.arts.set(t,{location:(0,s.V7)(e)})}})})}function te({characterKey:e,onClose:t}){return(0,q.tZ)(M.AB,{open:!!e,onClose:t,children:(0,q.tZ)(m.Suspense,{fallback:(0,q.tZ)(p.Z,{variant:"rectangular",width:"100%",height:1e3}),children:e&&(0,q.tZ)(ae,{characterKey:e,onClose:t},e)})})}function ae({characterKey:e,onClose:t}){var a,r;const n=(0,l.AU)(e),{gender:s}=(0,l.Hz)(),c=(0,S.m)(e,s),i=(0,$.Z)(e),{target:o}=null!=(a=null==i?void 0:i[e])?a:{},u=(0,j.Z)(null!=(r=null==n?void 0:n.key)?r:""),d=(0,m.useMemo)((()=>{if(i&&o)return{data:o,teamData:i,oldData:void 0}}),[o,i]),Z=(0,m.useMemo)((()=>{if(n&&c)return{character:n,characterSheet:c,characterDispatch:u}}),[n,c,u]),[g,f]=(0,m.useState)(void 0),[y,x]=(0,m.useState)(),C=(0,m.useMemo)((()=>({chartData:g,setChartData:f,graphBuilds:y,setGraphBuilds:x})),[g,y]);return(0,m.useEffect)((()=>{f(void 0),x(void 0)}),[e]),(0,q.tZ)(M.s8,{children:(0,q.tZ)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:d&&Z&&C?(0,q.tZ)(T.K.Provider,{value:Z,children:(0,q.tZ)(D.R.Provider,{value:d,children:(0,q.tZ)(V.V.Provider,{value:C,children:(0,q.tZ)(Q,{onClose:t})})})}):(0,q.tZ)(p.Z,{variant:"rectangular",width:"100%",height:1e3})})})}let re,ne=e=>e;const se={xs:1,sm:2,md:3,lg:4,xl:4},le={xs:6,sm:8,md:12,lg:16,xl:16},ce=Object.keys(z.V3);function ie(){var e;const t=(0,l.Wz)(),a=(0,x.s0)(),{params:{characterKey:M}}=null!=(e=(0,x.bS)({path:"/characters/:characterKey",end:!1}))?e:{params:{}},T=(0,m.useMemo)((()=>{if(!M)return null;if(!s.IV.includes(M))return a("/characters"),null;return t.chars.get(M)||t.chars.getWithInitWeapon(T),M}),[M,a,t]),{t:D}=(0,y.$G)(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:V}=(0,m.useContext)(K.E),[$,j]=(0,m.useState)((()=>t.displayCharacter.get()));(0,m.useEffect)((()=>t.displayCharacter.follow(((e,t)=>j(t)))),[t,j]);const[X,N]=(0,m.useState)(""),E=(0,m.useDeferredValue)(X),A=(0,m.useRef)(null),H=(0,m.useCallback)(((e,a)=>{var r;null==(r=A.current)||r.scrollIntoView({behavior:"smooth"}),t.displayCharacter.set({pageIndex:a-1})}),[t,A]),L=(0,r.JT)(),_=le[L],[F,G]=(0,m.useState)(!1),[O,R]=(0,r.NW)();(0,m.useEffect)((()=>(f.ZP.send({hitType:"pageview",page:"/characters"}),t.chars.followAny(((e,t)=>("new"===t||"remove"===t)&&R())))),[R,t]),(0,m.useEffect)((()=>t.charMeta.followAny((e=>R()))),[R,t]);const{gender:U}=(0,l.Hz)(),J=(0,m.useCallback)((async e=>{let a=(0,S.m)(e,U).name;"object"==typeof a&&(a=D(`${V?"sillyWisher_charNames":"charNames_gen"}:${(0,s.Cs)(e,U)}`)),window.confirm(D("removeCharacter",{value:a}))&&t.chars.remove(e)}),[t.chars,U,V,D]),Y=function(){var e;const t=(0,l.Wz)(),a=(0,x.s0)(),{params:{tab:r=""}}=null!=(e=(0,x.bS)({path:"/characters/:charKey/:tab",end:!1}))?e:{params:{tab:""}};return(0,m.useCallback)((e=>{const n=t.chars.get(e);let s=r;n||(t.chars.getWithInitWeapon(e),s=""),a(`/characters/${e}/${s}`)}),[a,t,r])}(),Q=(0,m.useDeferredValue)($),ee=(0,m.useDeferredValue)(O),{charKeyList:ae,totalCharNum:ie}=(0,m.useMemo)((()=>{var e;const a=t.chars.keys.length,{element:r,weaponType:s,rarity:l,sortType:c,ascending:i}=Q,o=t.chars.keys.filter((0,n.CZ)({element:r,weaponType:s,rarity:l,name:E},(0,z.zU)(t,V))).sort((0,n.ef)(null!=(e=z.V3[c])?e:[],i,(0,z._L)(t,V),["new","favorite"]));return ee&&{charKeyList:o,totalCharNum:a}}),[t,Q,E,V,ee]),{weaponType:oe,element:he,rarity:ue,sortType:de,ascending:Ze,pageIndex:pe=0}=$,{charKeyListToShow:ge,numPages:me,currentPageIndex:fe}=(0,m.useMemo)((()=>{const e=Math.ceil(ae.length/_),t=(0,n.re)(pe,0,e-1);return{charKeyListToShow:ae.slice(t*_,(t+1)*_),numPages:e,currentPageIndex:t}}),[ae,pe,_]),ye=ae.length!==ie?`${ae.length}/${ie}`:`${ie}`,xe=(0,m.useMemo)((()=>(0,I.W)(s.yd,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=t.weapons.get(r.equippedWeapon);if(!n)return;const s=(0,B.ub)(n.key).weaponType;e[s].total++,ae.includes(a)&&e[s].current++}))))),[t,ae]),Ce=(0,m.useMemo)((()=>(0,I.W)(s.UB,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=(0,S.m)(r.key,t.gender).elementKey;e[n].total++,ae.includes(a)&&e[n].current++}))))),[t,ae]),ve=(0,m.useMemo)((()=>(0,I.W)(s.ZI,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=(0,S.m)(r.key,t.gender).rarity;e[n].total++,ae.includes(a)&&e[n].current++}))))),[t,ae]),we={count:me,page:fe+1,onChange:H},be={numShowing:ge.length,total:ye,t:D,namespace:"page_character"},ke={sortKeys:[...ce],value:de,onChange:e=>t.displayCharacter.set({sortType:e}),ascending:Ze,onChangeAsc:e=>t.displayCharacter.set({ascending:e})};return(0,q.BX)(o.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,q.tZ)(te,{characterKey:T,onClose:()=>a("/characters")}),(0,q.tZ)(m.Suspense,{fallback:!1,children:(0,q.tZ)(w.Z,{newFirst:!0,show:F,onHide:()=>G(!1),onSelect:Y})}),(0,q.tZ)(C.Z,{ref:A,children:(0,q.BX)(h.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,q.BX)(u.ZP,{container:!0,spacing:1,children:[(0,q.tZ)(u.ZP,{item:!0,children:(0,q.tZ)(W.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({weaponType:e}),value:oe,totals:xe,size:"small"})}),(0,q.tZ)(u.ZP,{item:!0,children:(0,q.tZ)(P.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({element:e}),value:he,totals:Ce,size:"small"})}),(0,q.tZ)(u.ZP,{item:!0,children:(0,q.tZ)(k.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({rarity:e}),value:ue,totals:ve,size:"small"})}),(0,q.tZ)(u.ZP,{item:!0,flexGrow:1}),(0,q.tZ)(u.ZP,{item:!0,children:(0,q.tZ)(d.Z,{autoFocus:!0,value:X,onChange:e=>N(e.target.value),label:D("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,q.tZ)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:(0,q.tZ)(b.Z,{paginationProps:we,showingTextProps:be,displaySort:!0,sortByButtonProps:ke})})]})}),(0,q.tZ)(Z.Z,{fullWidth:!0,onClick:()=>G(!0),color:"info",startIcon:(0,q.tZ)(i.Z,{}),children:D(re||(re=ne`addNew`))}),(0,q.tZ)(m.Suspense,{fallback:(0,q.tZ)(p.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:(0,q.tZ)(u.ZP,{container:!0,spacing:1,columns:se,children:ge.map((e=>(0,q.tZ)(u.ZP,{item:!0,xs:1,children:(0,q.tZ)(v.Z,{characterKey:e,onClick:()=>a(`${e}`),footer:(0,q.BX)(q.HY,{children:[(0,q.tZ)(g.Z,{}),(0,q.tZ)(o.Z,{sx:{py:1,px:2,display:"flex",gap:1,justifyContent:"space-between"},children:(0,q.tZ)(Z.Z,{fullWidth:!0,color:"error",onClick:()=>J(e),startIcon:(0,q.tZ)(c.Z,{}),children:D("delete")})})]})})},e)))})}),me>1&&(0,q.tZ)(C.Z,{children:(0,q.BX)(h.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[(0,q.tZ)(Z.Z,{onClick:()=>G(!0),color:"info",sx:{minWidth:0},children:(0,q.tZ)(i.Z,{})}),(0,q.tZ)(o.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",flexGrow:1,children:(0,q.tZ)(b.Z,{paginationProps:we,showingTextProps:be})})]})})]})}}}]);