import{u as z,e as p,n as h,p as t,dE as se,dF as oe,bQ as $,B as S,dG as H,dH as re,dI as ie,a1 as le,dJ as ce,dK as de,a3 as ue,a2 as pe,T as L,K as D,dL as M,b as W,a_ as R,cx as _,dM as j,bd as N,be as J,D as E,dN as v,C as B,t as A,an as fe,dO as me,W as he,J as g,s as xe,Y as Ce,R as ge,_ as ye}from"./index-50036004.js";import{T as be,x as ve,v as ke,w as we,u as I}from"./index-bdb78bb3.js";import{u as De}from"./useWeapon-d23b7fd0.js";import{e as Le,g as Se,i as Ie}from"./LocationAutocomplete-9bf86522.js";import{C as Te}from"./CloseButton-f9c13176.js";import{D as b,d as U,b as Me,a as We,L as Oe}from"./FieldDisplay-486fc15d.js";import{M as T,D as F}from"./DropdownButton-5ea1bf4d.js";import{S as q}from"./SqBadge-3c35aa83.js";import{B as V}from"./ButtonGroup-a57fbb1c.js";import{a as Be}from"./InfoTooltip-643ddc8b.js";import{S as Re}from"./StarDisplay-fa85c6f1.js";import{g as _e}from"./index-02589697.js";import{C as je}from"./CardHeader-ebc1652c.js";function Ee({level:e,ascension:a,setBoth:n,useLow:i=!1,disabled:c=!1}){const{t:u}=z("ui"),s=i?ie:$,o=p.useCallback((r=1)=>{r=le(r,1,i?ce:de);const f=s.findIndex(m=>r<=m);n({level:r,ascension:f})},[n,s,i]),d=p.useCallback(()=>{const r=s.findIndex(f=>e!==90&&e===f);n(a===r?{ascension:a+1}:{ascension:r})},[n,s,a,e]);return h(V,{sx:{bgcolor:r=>r.palette.contentNormal.main},children:[t(pe,{children:t(ue,{onChange:o,value:e,startAdornment:"Lv. ",disabled:c,inputProps:{min:1,max:90,sx:{textAlign:"center",width:"3em"}},sx:{height:"100%",pl:2}})}),t(S,{sx:{pl:1,whiteSpace:"nowrap"},disabled:!(i?se:oe)(e)||c,onClick:d,children:h("strong",{children:["/ ",$[a]]})}),t(F,{title:u("selectlevel"),sx:{flexGrow:1},disabled:c,children:[...i?H:re].map(([r,f])=>{const m=r===e&&f===a;return t(T,{selected:m,disabled:m,onClick:()=>n({level:r,ascension:f}),children:r===s[f]?`Lv. ${r}`:`Lv. ${r}/${s[f]}`},`${r}/${f}`)})})]})}function Ae({avatar:e,title:a,action:n}){return h(D,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,t(L,{variant:"subtitle1",sx:{flexGrow:1},children:a}),n&&t(L,{variant:"caption",children:n})]})}const P=p.createContext({teamChar:{},team:{}});function Fe({conditional:e,disabled:a=!1}){const{data:n}=p.useContext(b);return Object.keys(M(e.states,n)).length===1&&"path"in e?t(Ve,{conditional:e,disabled:a}):"path"in e?t(Pe,{conditional:e,disabled:a}):t(Ge,{conditional:e,disabled:a})}function Ve({conditional:e,disabled:a}){const{teamCharId:n}=p.useContext(P),{data:i}=p.useContext(b),c=W(),u=p.useCallback(m=>{c.teamChars.set(n,y=>{const C=R(y.conditional);m?_(C,e.path,m):j(C,e.path),y.conditional=C})},[c,e.path,n]),s=i.get(e.value).value,[o,d]=Object.entries(M(e.states,i))[0],r=Y(d.name),f=G(e.name);return h(S,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s?"success":"primary",onClick:()=>u(s?void 0:o),disabled:a,startIcon:s?t(N,{}):t(J,{}),children:[f," ",r]})}function Pe({conditional:e,disabled:a}){const{teamCharId:n}=p.useContext(P),{data:i}=p.useContext(b),c=W(),u=p.useCallback(m=>{c.teamChars.set(n,y=>{const C=R(y.conditional);m?_(C,e.path,m):j(C,e.path),y.conditional=C})},[c,e.path,n]),s=i.get(e.value).value,o=M(e.states,i),d=s?o[s]:void 0,r=d?Y(d.name):t(q,{color:"secondary",children:"Not Active"}),f=G(e.name);return h(F,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:s&&d?"success":"primary",title:h("span",{children:[f," ",r]}),disabled:a,children:[t(T,{onClick:()=>u(),selected:!d,disabled:!d,children:t("span",{children:"Not Active"})}),t(E,{}),Object.entries(o).map(([m,y])=>t(T,{onClick:()=>u(m),selected:s===m,disabled:s===m,children:y.name},m))]})}function Ge({conditional:e,disabled:a}){const{teamCharId:n}=p.useContext(P),{data:i}=p.useContext(b),c=W(),u=p.useCallback((s,o)=>{c.teamChars.set(n,d=>{const r=R(d.conditional);o?_(r,s,o):j(r,s),d.conditional=r})},[c,n]);return t(V,{fullWidth:!0,orientation:"vertical",disableElevation:!0,color:"secondary",children:Object.entries(M(e.states,i)).map(([s,o])=>{const d=i.get(o.value).value,r=d===s;return t(S,{color:r?"success":"primary",disabled:a,fullWidth:!0,onClick:()=>u(o.path,d?void 0:s),size:"small",startIcon:r?t(N,{}):t(J,{}),sx:{borderRadius:0},children:G(o.name)},s)})})}function Q(e){return typeof e!="string"}function Y(e){if(!e)return"";let a="primary",n=e;return e&&Q(e)&&e.props.color&&(a=e.props.color,n=t("span",{children:e.props.children})),t(q,{sx:{ml:.5},color:a,children:n})}function G(e){if(Q(e)){const a=e.props.key18,n=e.props.ns,i=e.props.values;return t(be,{ns:n,key18:a,values:i,useBadge:!0})}return e}function $e({conditional:e,hideHeader:a=!1,hideDesc:n=!1,disabled:i=!1}){var s;const{data:c}=p.useContext(b);let u;if("path"in e){const o=c.get(e.value).value,d=v(e.states,c);u=o&&((s=d[o])==null?void 0:s.fields)}else{const o=v(e.states,c);u=Object.values(o).flatMap(d=>c.get(d.value).value?d.fields:[])}return h(A,{children:[!v(a,e)&&t(K,{header:e.header,hideDesc:n}),t(B,{sx:{p:0,"&:last-child":{pb:0}},children:t(Fe,{conditional:e,disabled:i})}),u&&t(U,{fields:u})]})}function ze({sections:e,teamBuffOnly:a,hideDesc:n=!1,hideHeader:i=!1,disabled:c=!1}){const{data:u}=p.useContext(b);if(!e.length)return null;const s=e.map((o,d)=>o.canShow&&!u.get(o.canShow).value||a&&!o.teamBuff?null:t(He,{section:o,hideDesc:n,hideHeader:i,disabled:c},d)).filter(o=>o);return s.length?t(D,{display:"flex",flexDirection:"column",gap:1,children:s}):null}function He({section:e,hideDesc:a=!1,hideHeader:n=!1,disabled:i=!1}){return"fields"in e?t(Ne,{section:e,hideDesc:a,hideHeader:n}):"states"in e?t($e,{conditional:e,hideDesc:a,hideHeader:n,disabled:i}):t(Je,{section:e})}function Ne({section:e,hideDesc:a,hideHeader:n}){return h(A,{children:[!v(n,e)&&e.header&&t(K,{header:e.header,hideDesc:a,hideDivider:e.fields.length===0}),t(U,{fields:e.fields})]})}function Je({section:e}){const{data:a}=p.useContext(b);return t("div",{children:v(e.text,a)})}function K({header:e,hideDesc:a,hideDivider:n}){const{data:i}=p.useContext(b),{icon:c,title:u,action:s}=e,o=v(c,i),d=!a&&v(e.description,i);return h(fe,{children:[t(Ae,{avatar:o,title:a?u:h("span",{children:[u,t(Be,{title:t(L,{children:d})})]}),action:s}),!n&&t(E,{})]})}function Ue({refinement:e,setRefinement:a,disabled:n=!1}){const{t:i}=z("ui");return t(F,{title:i("refinement",{value:e}),disabled:n,children:me.map(c=>t(T,{onClick:()=>a(c),selected:e===c,disabled:e===c,children:i("refinement",{value:c})},c))})}const qe=ge.lazy(()=>ye(()=>import("./WeaponSelectionModal-93063bac.js"),["./WeaponSelectionModal-93063bac.js","./index-50036004.js","./index-7e33179a.css","./index-bdb78bb3.js","./ColoredText-d4a95e01.js","./SqBadge-3c35aa83.js","./index-02589697.js","./totalUtils-617639f4.js","./CloseButton-f9c13176.js","./StarDisplay-fa85c6f1.js","./MenuList-a7bcde2a.js","./WeaponCard-5f53df43.js","./LocationAutocomplete-9bf86522.js","./DropdownButton-5ea1bf4d.js","./ButtonGroup-a57fbb1c.js","./useWeapon-d23b7fd0.js","./CardActionArea-79473a8c.js"],import.meta.url));function Qe({weaponId:e,footer:a=!1,onClose:n,extraButtons:i}){const{data:c}=p.useContext(b),u=W(),s=De(e),{key:o="",level:d=0,refinement:r=1,ascension:f=0,lock:m,location:y="",id:C}=s??{},l=o?_e(o):void 0,k=p.useCallback(x=>{u.weapons.set(e,x)},[e,u]),X=p.useCallback(x=>C&&u.weapons.set(C,{location:x}),[u,C]),Z=p.useCallback(x=>x.weaponTypeKey===(l==null?void 0:l.weaponType),[l]),[ee,te,ne]=he(),ae=o?ve(o,f>=2):"";p.useEffect(()=>{if(!(!l||!k||l.key!==(s==null?void 0:s.key))&&l.rarity<=2&&(d>70||f>4)){const[x,w]=H[0];k({level:x,ascension:w})}},[l,s,k,d,f]);const O=p.useMemo(()=>l&&s&&ke([l.data,we(s)]),[l,s]);return t(Ce,{open:!!e,onClose:n,containerProps:{maxWidth:"md"},children:h(xe,{children:[t(qe,{ascension:f,show:ee,onHide:ne,onSelect:x=>k({key:x}),weaponTypeFilter:l&&l.weaponType}),t(B,{children:l&&O&&h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:12,sm:3,children:h(g,{container:!0,spacing:1.5,children:[t(g,{item:!0,xs:6,sm:12,children:t(D,{component:"img",src:ae,className:`grad-${l.rarity}star`,sx:{maxWidth:256,width:"100%",height:"auto",borderRadius:1}})}),t(g,{item:!0,xs:6,sm:12,children:t(L,{children:t("small",{children:l.description})})})]})}),h(g,{item:!0,xs:12,sm:9,sx:{display:"flex",flexDirection:"column",gap:1},children:[t(D,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:h(V,{children:[t(S,{color:"info",onClick:te,children:(l==null?void 0:l.name)??"Select a Weapon"}),(l==null?void 0:l.hasRefinement)&&t(Ue,{refinement:r,setRefinement:x=>k({refinement:x})}),i]})}),h(D,{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"space-between",children:[l&&t(Ee,{level:d,ascension:f,setBoth:k,useLow:!l.hasRefinement}),t(S,{color:"error",onClick:()=>C&&u.weapons.set(C,{lock:!m}),startIcon:m?t(Le,{}):t(Se,{}),children:m?"Locked":"Unlocked"})]}),t(Re,{stars:l.rarity}),t(L,{variant:"subtitle1",children:t("strong",{children:l.passiveName})}),t(L,{gutterBottom:!0,children:l.passiveName&&l.passiveDescription(O.get(I.weapon.refinement).value-1)}),h(D,{display:"flex",flexDirection:"column",gap:1,children:[h(A,{children:[t(je,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),t(E,{}),t(Me,{children:[I.weapon.main,I.weapon.sub,I.weapon.sub2].map(x=>{const w=O.get(x);return w.isEmpty||!w.value?null:t(We,{node:w,component:Oe},JSON.stringify(w.info))})})]}),c&&l.document&&t(ze,{sections:l.document})]})]})]})}),a&&C&&t(B,{sx:{py:1},children:h(g,{container:!0,spacing:1,children:[t(g,{item:!0,flexGrow:1,children:t(Ie,{location:y,setLocation:X,filter:Z,autoCompleteProps:{getOptionDisabled:x=>!x.key}})}),t(g,{item:!0,flexGrow:2}),!!n&&t(g,{item:!0,children:t(Te,{sx:{height:"100%"},large:!0,onClick:n})})]})})]})})}const ct=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));export{Ae as C,ze as D,Ee as L,Ue as R,P as T,Qe as W,ct as a};
