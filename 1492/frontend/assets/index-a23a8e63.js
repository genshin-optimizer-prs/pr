import{u as I,p as t,n,L as Lt,N as g,Q as mt,K as w,U as at,V as B,W,e as a,J as s,T as k,B as v,t as S,C as m,D as q,X as U,Y as yt,b as M,r as gt,i as bt,j as xt,_ as G,Z as Rt,s as At,$ as wt,a0 as jt,M as qt,R as vt,a1 as Ut}from"./index-f37d7dbf.js";import{T as nt,S as ot,h as Bt,u as Ot,f as Wt,s as zt,A as Gt,P as st}from"./LocationAutocomplete-ab0510d9.js";import{d as St,A as kt,a as Vt,b as Ht,p as Nt,c as Qt,e as lt}from"./ArtifactSort-c8f5ebd6.js";import{L as Xt}from"./Link-df7cc04e.js";import{S as ct,T as Jt}from"./index-8d38a632.js";import{A as ut}from"./ArtifactStatKeyDisplay-df3cfb95.js";import{d as Yt,B as Zt}from"./Help-c5a00ad6.js";import{C as z}from"./CloseButton-31a0cd27.js";import{d as te,a as ee}from"./LockOpen-d94562a0.js";import{S as j}from"./SqBadge-2716fa7c.js";import{C as re}from"./ColoredText-41417afa.js";import{S as ie}from"./StatEditorList-9f99ce18.js";import"./DropdownButton-5d89fcf0.js";import"./MenuList-f50c2bb8.js";import"./ButtonGroup-397681bb.js";import"./StarDisplay-84cabbc2.js";import"./SlotIcon-c93c8d39.js";import"./InfoTooltip-37e64601.js";import"./index-4530fde9.js";import"./Artifact-bc6b5ab7.js";import"./CardActionArea-58124b3a.js";const ae=r=>r[Math.floor(Math.random()*r.length)];function ne(){const{t:r}=I("artifact");return t(mt,{severity:"info",variant:"filled",children:n(g,{t:r,i18nKey:"noArtifacts",children:["Looks like you haven't added any artifacts yet. If you want, there are ",t(Xt,{color:"warning.main",component:Lt,to:"/scanner",fontFamily:"inherit",children:"automatic scanners"})," that can speed up the import process!"]})})}const dt=Bt([...B]),ft=B.slice(0,6),pt=B.slice(6);function oe({selectedKeys:r,onChange:e}){const o=r.filter(i=>ft.includes(i)),c=r.filter(i=>pt.includes(i));return n(w,{display:"flex",gap:1,flexWrap:"wrap",children:[t(ot,{value:o,sx:{flexGrow:1},children:ft.map(i=>t(nt,{sx:{flexGrow:1},size:"small",value:i,onClick:()=>e(dt(r,i)),children:n(w,{display:"flex",gap:1,alignItems:"center",children:[t(ct,{statKey:i,iconProps:at}),t(ut,{statKey:i})]})},i))}),t(ot,{value:c,sx:{flexGrow:1},children:pt.map(i=>t(nt,{sx:{flexGrow:1},size:"small",value:i,onClick:()=>e(dt(r,i)),children:n(w,{display:"flex",gap:1,alignItems:"center",children:[t(ct,{statKey:i,iconProps:at}),t(ut,{statKey:i})]})},i))})]})}function se({pageKey:r,text:e="",modalTitle:o="",children:c}){const[i,h,d]=W(localStorage.getItem(`infoShown_${r}`)!=="true"),[f]=a.useState(Array.isArray(e)?ae(e):e),y=a.useCallback(()=>{d(),localStorage.setItem(`infoShown_${r}`,"true")},[d,r]);return n(S,{children:[n(s,{container:!0,children:[t(s,{item:!0,flexGrow:1,children:t(k,{variant:"caption",pl:1,children:f})}),t(s,{item:!0,xs:"auto",children:t(v,{size:"small",color:"info",variant:"contained",onClick:h,startIcon:t(Yt,{}),children:t(Jt,{ns:"ui",key18:"info"})})})]}),t(yt,{containerProps:{maxWidth:"xl"},open:i,onClose:y,children:n(S,{children:[t(m,{sx:{py:1},children:n(s,{container:!0,children:[t(s,{item:!0,flexGrow:1,children:t(k,{variant:"h6",children:o})}),t(s,{item:!0,children:t(z,{onClick:y})})]})}),t(q,{}),t(m,{children:t(a.Suspense,{fallback:t(U,{variant:"rectangular",width:"100%",height:500}),children:c})}),t(q,{}),t(m,{sx:{py:1},children:t(z,{large:!0,onClick:y})})]})})]})}function Ct(){const r=M(),[e,o]=a.useState(r.displayArtifact.get());return a.useEffect(()=>r.displayArtifact.follow((c,i)=>o(i)),[r]),e}var V={},le=bt;Object.defineProperty(V,"__esModule",{value:!0});var Dt=V.default=void 0,ce=le(gt()),ue=xt,de=(0,ce.default)((0,ue.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");Dt=V.default=de;var H={},fe=bt;Object.defineProperty(H,"__esModule",{value:!0});var It=H.default=void 0,pe=fe(gt()),he=xt,me=(0,pe.default)((0,he.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");It=H.default=me;const ye=a.lazy(()=>G(()=>import("./ArtifactFilterDisplay-91a43c8d.js").then(r=>r.b),["./ArtifactFilterDisplay-91a43c8d.js","./index-f37d7dbf.js","./index-aa0c531e.css","./LockOpen-d94562a0.js","./LocationAutocomplete-ab0510d9.js","./DropdownButton-5d89fcf0.js","./MenuList-f50c2bb8.js","./ButtonGroup-397681bb.js","./index-8d38a632.js","./ColoredText-41417afa.js","./SqBadge-2716fa7c.js","./StarDisplay-84cabbc2.js","./totalUtils-0da713ce.js","./Help-c5a00ad6.js","./sortByRarityAndName-4bc39b14.js","./Artifact-bc6b5ab7.js","./index-4530fde9.js","./SlotIcon-c93c8d39.js"],import.meta.url));function ge({numShowing:r,total:e,artifactIds:o}){const{t:c}=I(["artifact","ui"]),i=M(),{filterOption:h}=Ct(),d=a.useCallback(f=>i.displayArtifact.set({filterOption:{...h,...f}}),[i,h]);return t(a.Suspense,{fallback:t(U,{variant:"rectangular",width:"100%",height:300}),children:t(S,{children:n(m,{children:[n(s,{container:!0,children:[t(s,{item:!0,children:t(k,{variant:"h6",children:t(g,{t:c,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(s,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&n(k,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(s,{item:!0,children:t(v,{size:"small",color:"error",onClick:()=>i.displayArtifact.set({action:"reset"}),startIcon:t(It,{}),children:t(g,{t:c,i18nKey:"ui:reset"})})})]}),t(a.Suspense,{fallback:t(U,{variant:"rectangular",width:"100%",height:200}),children:t(ye,{filterOption:h,filterOptionDispatch:d,filteredIds:o})})]})})})}function be({artifactIds:r}){const{t:e}=I(["artifact","ui"]),o=M(),{numDelete:c,numUnequip:i,numUnlock:h,numLock:d}=a.useMemo(()=>{const u=r.map(x=>o.arts.get(x)),p=u.reduce((x,T)=>x+(T.lock?0:1),0),_=u.length-p,P=p,C=u.reduce((x,T)=>x+(T.location?1:0),0);return{numDelete:P,numUnequip:C,numUnlock:p,numLock:_}},[r,o]);return n(s,{container:!0,spacing:1,alignItems:"center",children:[t(s,{item:!0,xs:12,sm:6,md:3,children:n(v,{fullWidth:!0,color:"error",disabled:!i,onClick:()=>window.confirm(`Are you sure you want to unequip ${i} artifacts currently equipped on characters?`)&&r.map(u=>o.arts.set(u,{location:""})),startIcon:t(Dt,{}),children:[t(g,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t(j,{sx:{ml:1},color:i?"success":"secondary",children:i})]})}),t(s,{item:!0,xs:12,sm:6,md:3,children:n(v,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to delete ${c} artifacts?`)&&r.map(u=>{var p;return!((p=o.arts.get(u))!=null&&p.lock)&&o.arts.remove(u)}),startIcon:t(Rt,{}),children:[t(g,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t(j,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(s,{item:!0,xs:12,sm:6,md:3,children:n(v,{fullWidth:!0,color:"error",disabled:!d,onClick:()=>window.confirm(`Are you sure you want to unlock ${d} artifacts?`)&&r.map(u=>o.arts.set(u,{lock:!1})),startIcon:t(te,{}),children:[t(g,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t(j,{sx:{ml:1},color:d?"success":"secondary",children:d})]})}),t(s,{item:!0,xs:12,sm:6,md:3,children:n(v,{fullWidth:!0,color:"error",disabled:!h,onClick:()=>window.confirm(`Are you sure you want to lock ${h} artifacts?`)&&r.map(u=>o.arts.set(u,{lock:!0})),startIcon:t(ee,{}),children:[t(g,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t(j,{sx:{ml:1},color:h?"success":"secondary",children:h})]})}),t(s,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(k,{variant:"caption",color:"text.secondary",children:n(g,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function xe({show:r,onHide:e}){const{t:o}=I("artifact");return t(yt,{open:r,onClose:e,children:n(At,{children:[n(m,{sx:{display:"flex",alignItems:"center"},children:[n(k,{variant:"h6",flexGrow:1,children:[t(St,{sx:{verticalAlign:"text-top",mr:1}}),o`showDup`]}),t(z,{onClick:e})]}),t(q,{}),t(m,{children:t(Ae,{})})]})})}function Ae(){const{t:r}=I("artifact"),e=M(),[o,c]=wt();a.useEffect(()=>e.arts.followAny(c),[c,e]);const i=a.useMemo(()=>{const d=o&&[];let f=e.arts.keys;for(;f.length!==0;){const y=f.shift();if(!y)continue;const E=e.arts.get(y);if(!E)continue;const{duplicated:b}=e.arts.findDups(E,f);if(!b.length)continue;const u=b.map(p=>p.id);d.push([y,...u].sort(p=>{var _;return((_=e.arts.get(p))==null?void 0:_.location)??""?-1:1})),f=f.filter(p=>!u.includes(p))}return d},[e,o]),h=a.useMemo(()=>({}),[]);return n(jt,{spacing:2,children:[i.map(d=>t(S,{sx:{overflowX:"scroll"},children:t(m,{sx:{display:"flex",gap:1},children:d.map(f=>t(w,{sx:{minWidth:300},children:t(kt,{artifactId:f,canEquip:!0,onDelete:()=>e.arts.remove(f),editorProps:h})},f))})},d.join())),!i.length&&t(mt,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const we=[...B];function ve({probabilityFilter:r={},setProbabilityFilter:e,disabled:o=!1}){const{t:c}=I("artifact");return n(S,{children:[t(m,{sx:{py:1},children:t(k,{variant:"h6",children:"Roll Probability Calculator"})}),t(q,{}),t(m,{children:n(s,{container:!0,spacing:1,children:[t(s,{item:!0,xs:12,md:6,children:t(At,{children:t(m,{children:n(k,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",n(re,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(s,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(ie,{statKeys:we,statFilters:r,setStatFilters:e,disabled:o,label:c("probabilityFilter.label")})})]})})]})}const Se=vt.lazy(()=>G(()=>import("./ArtifactEditor-a1161b34.js"),["./ArtifactEditor-a1161b34.js","./index-f37d7dbf.js","./index-aa0c531e.css","./ArtifactRarityDropdown-46b680e3.js","./index-4530fde9.js","./index-8d38a632.js","./ColoredText-41417afa.js","./SqBadge-2716fa7c.js","./LocationAutocomplete-ab0510d9.js","./DropdownButton-5d89fcf0.js","./MenuList-f50c2bb8.js","./ButtonGroup-397681bb.js","./StarDisplay-84cabbc2.js","./sortByRarityAndName-4bc39b14.js","./Help-c5a00ad6.js","./LockOpen-d94562a0.js","./SlotIcon-c93c8d39.js","./ArtifactStatKeyDisplay-df3cfb95.js","./Artifact-bc6b5ab7.js","./CloseButton-31a0cd27.js","./ArtifactSort-c8f5ebd6.js","./InfoTooltip-37e64601.js","./CardActionArea-58124b3a.js","./TextButton-215889c1.js","./CardHeader-790c781e.js","./ChevronRight-8fcfd8d9.js"],import.meta.url)),ke=vt.lazy(()=>G(()=>import("./index-5b31f079.js"),["./index-5b31f079.js","./index-f37d7dbf.js","./index-aa0c531e.css","./Settings-f03c10b0.js","./StarDisplay-84cabbc2.js","./MenuList-f50c2bb8.js","./index-8d38a632.js","./ColoredText-41417afa.js","./SqBadge-2716fa7c.js","./ImgFullwidth-7caa2937.js","./ArtifactSort-c8f5ebd6.js","./LocationAutocomplete-ab0510d9.js","./DropdownButton-5d89fcf0.js","./ButtonGroup-397681bb.js","./Help-c5a00ad6.js","./SlotIcon-c93c8d39.js","./InfoTooltip-37e64601.js","./index-4530fde9.js","./Artifact-bc6b5ab7.js","./CardActionArea-58124b3a.js","./Link-df7cc04e.js"],import.meta.url)),ht={xs:1,sm:2,md:3,lg:3,xl:4},Ce={xs:10,sm:12,md:24,lg:24,xl:24};function Ne(){const{t:r}=I(["artifact","ui"]),e=M(),o=Ct(),[c,i,h]=W(!1),[d,f,y]=W(!1),E=Ot(),b=Ce[E],{sortType:u,effFilter:p,ascending:_,probabilityFilter:P}=o,C=u==="probability",[x,T]=a.useState(0),O=a.useRef(null),[_t,N]=wt(),Q=a.useDeferredValue(_t),F=a.useMemo(()=>new Set(p),[p]),Pt=a.useCallback(l=>e.arts.remove(l),[e]);a.useEffect(()=>(qt.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>N())),[e,N]);const Tt=a.useCallback(l=>e.displayArtifact.set({probabilityFilter:l}),[e]),Et=a.useMemo(()=>!e.arts.values.length,[e]),X=a.useMemo(()=>Vt(F,P),[F,P]),J=a.useMemo(()=>Ht(F),[F]),Y=a.useDeferredValue(o),Z=a.useDeferredValue(P);a.useEffect(()=>{if(C)return e.arts.values.forEach(l=>e.arts.setProbability(l.id,Nt(l,Z))),()=>e.arts.values.forEach(l=>e.arts.setProbability(l.id,-1))},[e,C,Z]);const{artifactIds:A,totalArtNum:$}=a.useMemo(()=>{const{sortType:l=lt[0],ascending:D=!1,filterOption:K}=Y;let L=e.arts.values;return C&&(L=L.filter(R=>R.probability&&R.probability!==1)),{artifactIds:L.filter(Wt(K,J)).sort(zt(Qt[l]??[],D,X)).map(R=>R.id),totalArtNum:L.length,...Q}},[Y,Q,e,X,J,C]),{artifactIdsToShow:tt,numPages:et,currentPageIndex:Ft}=a.useMemo(()=>{const l=Math.ceil(A.length/b),D=Ut(x,0,l-1);return{artifactIdsToShow:A.slice(D*b,(D+1)*b),numPages:l,currentPageIndex:D}},[A,x,b]),Mt=A.length!==$?`${A.length}/${$}`:`${$}`,$t=a.useCallback((l,D)=>{var K;(K=O.current)==null||K.scrollIntoView({behavior:"smooth"}),T(D-1)},[T,O]),rt={count:et,page:Ft+1,onChange:$t},it={numShowing:tt.length,total:Mt,t:r,namespace:"artifact"},Kt={sortKeys:[...lt],value:u,onChange:l=>e.displayArtifact.set({sortType:l}),ascending:_,onChangeAsc:l=>e.displayArtifact.set({ascending:l})};return n(w,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(a.Suspense,{fallback:!1,children:t(Se,{artifactIdToEdit:c?"new":"",cancelEdit:h,allowUpload:!0,allowEmpty:!0})}),t(a.Suspense,{fallback:!1,children:t(xe,{show:d,onHide:y})}),t(se,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(ke,{})}),Et&&t(ne,{}),t(ge,{numShowing:A.length,total:$,artifactIds:A}),t(S,{ref:O,children:t(m,{children:t(Zt,{placement:"top",title:t(g,{t:r,i18nKey:"efficiencyFilter.title",children:"Substats to use in efficiency calculation"}),children:t(w,{children:t(oe,{selectedKeys:p,onChange:l=>e.displayArtifact.set({effFilter:l})})})})})}),t(S,{children:n(m,{children:[t(w,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(st,{paginationProps:rt,showingTextProps:it,displaySort:!0,sortByButtonProps:Kt})}),t(be,{artifactIds:A})]})}),C&&t(ve,{probabilityFilter:P,setProbabilityFilter:Tt}),n(s,{container:!0,columns:ht,spacing:1,children:[t(s,{item:!0,xs:!0,children:t(v,{fullWidth:!0,onClick:i,color:"info",startIcon:t(Gt,{}),children:r`addNew`})}),t(s,{item:!0,xs:1,children:t(v,{fullWidth:!0,onClick:f,color:"info",startIcon:t(St,{}),children:r`showDup`})})]}),t(a.Suspense,{fallback:t(U,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:t(s,{container:!0,spacing:1,columns:ht,children:tt.map(l=>t(s,{item:!0,xs:1,children:t(kt,{artifactId:l,effFilter:F,onDelete:Pt,editorProps:{},canEquip:!0})},l))})}),et>1&&t(S,{children:t(m,{children:t(w,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(st,{paginationProps:rt,showingTextProps:it})})})})]})}export{Ne as default};
