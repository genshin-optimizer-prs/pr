"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1],{8660:(e,t,n)=>{n.d(t,{Z:()=>h});var i=n(98283),a=n(94380),r=n(11141),l=n(23485),s=n(36674),o=n(52903);let c,d=e=>e;const u=["rarity","onChange","filter"];function h(e){let{rarity:t,onChange:n,filter:h}=e,Z=(0,i.Z)(e,u);const{t:p}=(0,r.$G)("artifact");return(0,o.tZ)(l.Z,Object.assign({},Z,{title:t?(0,o.tZ)(s.q,{stars:t,inline:!0}):p(c||(c=d`editor.rarity`)),color:t?"success":"primary",children:[5,4,3].map((e=>(0,o.tZ)(a.Z,{disabled:!h(e),onClick:()=>n(e),children:(0,o.tZ)(s.q,{stars:e,inline:!0})},e)))}))}},47712:(e,t,n)=>{n.d(t,{Z:()=>g});var i=n(98283),a=n(80422),r=n(67550),l=n(38951),s=n(2784),o=n(11141),c=n(4121),d=n(51576),u=n(75958),h=n(79410),Z=n(36674),p=n(86873),m=n(52903);const f=["artSetKey","setArtSetKey","label"];function g(e){let{artSetKey:t,setArtSetKey:n,label:g=""}=e,x=(0,i.Z)(e,f);const{t:b}=(0,o.$G)(["artifact","artifactNames_gen"]);g=g||b("artifact:autocompleteLabels.set");const y=(0,s.useMemo)((()=>Object.entries(c.WO).flatMap((([e,t])=>t.map((t=>({key:t,label:b(`artifactNames_gen:${t}`),grouper:+e}))))).sort(p.Z)),[b]),v=(0,s.useCallback)((e=>e?(0,m.tZ)(h.Z,{src:(0,d.jU)(e),size:2}):void 0),[]),C=(0,s.useCallback)((e=>n(null!=e?e:"")),[n]);return(0,m.tZ)(u._,Object.assign({options:y,valueKey:t,onChange:C,toImg:v,label:g,groupBy:e=>{var t,n;return null!=(t=null==(n=e.grouper)?void 0:n.toString())?t:""},renderGroup:e=>e.group&&(0,m.BX)(a.Z,{component:r.Z,children:[(0,m.BX)(l.Z,{sx:{top:"-1em"},children:[e.group," ",(0,m.tZ)(Z.q,{stars:+e.group,inline:!0})]},`${e.group}Header`),e.children]},e.group)},x))}},13900:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(98283),a=n(65992),r=n(83249),l=n(52903);const s=["children","disabled"],o=(0,a.ZP)(r.Z)((({theme:e})=>({"&.Mui-disabled":{backgroundColor:e.palette.primary.dark,color:e.palette.text.secondary}})));function c(e){let{children:t}=e,n=(0,i.Z)(e,s);return(0,l.tZ)(o,Object.assign({},n,{disabled:!0,children:t}))}},64347:(e,t,n)=>{n.r(t),n.d(t,{default:()=>So});var i=n(38243),a=n(31653),r=n(67128),l=n(67550),s=n(79906),o=n(7671),c=n(2784),d=n(11141),u=n(73557),h=n(23690),Z=n(99487),p=n(48650),m=n(64583),f=n(23657),g=n(48863),x=n(44180),b=n(98283),y=n(45492),v=n(42745),C=n(4121),w=n(58606),B=n(25616),k=n(51784),S=n(32404),X=n(2754),T=n(11845);const O=["data"],E=["display"];function j(e,t=0,n,i){var a;const l=(0,r.Wz)(),[s,o]=(0,y.NW)(),d=(0,c.useDeferredValue)(s),{gender:u}=(0,r.Hz)(),{characterIds:h}=null!=(a=(0,r.t7)(e))?a:{characterIds:[]},Z=(0,c.useMemo)((()=>d&&function(e,t,n=0,i,a,r){var l;if(!t)return;const s=e.teams.get(t);if(!s)return;const{characterIds:o}=s,c=e.teamChars.get(o[0]);if(!c)return;const{teamData:d,teamBundle:u}=null!=(l=function(e,t,n=0,i,a){if(!t)return;const r=e.teams.get(t);if(!r)return;const{characterIds:l,enemyOverride:s,hitMode:o,reaction:c}=r,d=l.map(((t,r)=>{var l;const d=e.teamChars.get(t),{key:u}=d,h=e.chars.get(u),{key:Z,level:p,constellation:m,ascension:f,talent:g}=h,{infusionAura:y,customMultiTargets:v,conditional:T,bonusStats:O}=d;return function(e,t=!1,n,i,a,r){const l=e.chars.get(i.key),s=(0,x.m)(i.key,e.gender);if(!s)return;const o=(0,B.ub)(a.key);if(!o)return;const c=k.Z.getAllDataOfType(s.weaponTypeKey),d=t?(()=>{const e=o.data,t=(0,b.Z)(e,E);return(0,X.b3)([t,c])})():o.data,u=(0,X.b3)([s.data,d,C.d5]),h=Array.isArray(r)?r.map((e=>(0,X.n3)(e,n))):[r],Z=[...h,(0,X.qE)(i,t?u:void 0),(0,X.v0)(a),u,S.y0,w.Y];return{character:l,weapon:a,characterSheet:s,weaponSheet:o,data:Z}}(e,0===r,0===r?n:0,{key:Z,level:p,constellation:m,ascension:f,talent:g,infusionAura:y,customMultiTargets:v,conditional:T,bonusStats:O,enemyOverride:s,hitMode:o,reaction:c},0===r&&a?a:e.teamChars.getLoadoutWeapon(t),null!=(l=0===r&&i)?l:Object.values(e.teamChars.getLoadoutArtifacts(t)).filter((e=>e)))})),u=Object.fromEntries(d.map((e=>[e.character.key,e]))),h=(0,v.vU)(u,(({data:e})=>e));return{teamData:h,teamBundle:u}}(e,t,n,a,r))?l:{};if(!d||!u)return;const h=(0,X.Qo)(d,i,c.key),Z=(0,T.xh)(h,((e,t)=>{const n=u[t],i=(0,b.Z)(n,O);return Object.assign({},e,i)}));return Z}(l,e,t,u,n,i)),[d,u,e,l,t,n,i]);return(0,c.useEffect)((()=>e?l.teams.follow(e,o):void 0),[e,o,l]),(0,c.useEffect)((()=>{const e=h.map((e=>l.teamChars.follow(e,((e,t,n)=>{"update"===t&&o()})))),t=h.map((e=>{const t=l.teamChars.get(e);return t?"equipped"===t.buildType?l.chars.follow(t.key,(()=>o())):"real"===t.buildType?l.builds.follow(t.buildId,(()=>o())):(t.buildType,()=>{}):()=>{}}));return()=>{e.forEach((e=>e())),t.forEach((e=>e()))}}),[l,h,o]),Z}var I=n(6982),P=n(96e3),M=n(85439),K=n(36380),D=n(61391),A=n(60319),_=n(68826),z=n(32782),R=n(38484),L=n(78287),W=n(83249),V=n(39857),G=n(87833),$=n(4991),N=n(35800),F=n(94380),q=n(92794),H=n(57210),U=n(39099),Y=n(86569),J=n(12366),Q=n(52903);const ee={mx:.25,px:.25};function te({reaction:e}){const{t}=(0,d.$G)("sheet_gen"),n="spread"===e?"dendro":"electro";return(0,Q.BX)(l.Z,{display:"flex",alignItems:"center",children:[(0,Q.tZ)(Y.Z,{color:e,children:t(`reaction.${e}`)}),(0,Q.tZ)(J.Z,{sx:ee,color:"dendro",children:(0,Q.tZ)(N.oZ,Object.assign({},$.mX))}),"+",(0,Q.tZ)(J.Z,{sx:ee,color:"electro",children:(0,Q.tZ)(N.Bn,Object.assign({},$.mX))}),"+",(0,Q.tZ)(J.Z,{sx:ee,color:n,children:(0,Q.tZ)(U.Z,{ele:n,iconProps:$.mX})})]})}var ne=n(34048),ie=n(23485),ae=n(58489);let re,le=e=>e;const se={"":(0,Q.tZ)("span",{children:"No Team Melee Infusion"}),pyro:(0,Q.BX)("span",{children:[(0,Q.tZ)(N.I4,Object.assign({},$.mX))," ",(0,Q.tZ)(J.Z,{children:"Bennett C6"})," Fire Ventures with Me"]}),cryo:(0,Q.BX)("span",{children:[(0,Q.tZ)(N.DK,Object.assign({},$.mX))," ",(0,Q.tZ)(J.Z,{children:"Chongyun Skill"})," Spirit Blade: Chonghua's Layered Frost"]}),hydro:(0,Q.BX)("span",{children:[(0,Q.tZ)(N.px,Object.assign({},$.mX))," ",(0,Q.tZ)(J.Z,{children:"Candace Burst"})," Sacred Rite: Wagtail's Tide"]}),electro:(0,Q.BX)("span",{children:[(0,Q.tZ)(N.Bn,Object.assign({},$.mX))," ",(0,Q.tZ)(J.Z,{children:"Somnia Burst"})," ","Parallax Paws"]})};function oe(e){const{characterSheet:t,teamCharId:n,teamChar:{infusionAura:i}}=(0,c.useContext)(g.V),a=(0,r.Wz)();return null!=t&&t.isMelee()?(0,Q.tZ)(ie.Z,Object.assign({title:se[i],color:i||"secondary",disableElevation:!0},e,{children:Object.entries(se).map((([e,t])=>(0,Q.tZ)(F.Z,{sx:e?{color:`${e}.main`}:void 0,selected:e===i,disabled:e===i,onClick:()=>a.teamChars.set(n,{infusionAura:e}),children:t},e)))})):null}function ce(e){var t,n,i,l;const{t:s}=(0,d.$G)("page_character"),{teamId:o,team:{reaction:u}}=(0,c.useContext)(g.V),h=(0,r.Wz)(),{data:p}=(0,c.useContext)(Z.R),m=p.get(S.ri.charEle).value,f=p.get(S._d).value,x=[...new Set([...null!=(t=H.oR[m])?t:[],...null!=(n=H.oR[f])?n:[],...null!=(i=H.p7[m])?i:[],...null!=(l=H.p7[f])?l:[]])];return(0,Q.BX)(ae.Z,Object.assign({exclusive:!0,baseColor:"secondary",value:u,onChange:(e,t)=>h.teams.set(o,{reaction:t})},e,{children:[(0,Q.tZ)(q.Z,{value:"",disabled:!u,children:s(re||(re=le`noReaction`))}),x.map((e=>(0,Q.tZ)(q.Z,{value:e,disabled:u===e,children:[...a.Mk].includes(e)?(0,Q.tZ)(ne.Z,{reaction:e}):(0,Q.tZ)(te,{reaction:e})},e)))]}))}function de(e){const{t}=(0,d.$G)("page_character"),{teamId:n,team:{hitMode:i}}=(0,c.useContext)(g.V),l=(0,r.Wz)();return(0,Q.tZ)(ae.Z,Object.assign({exclusive:!0,baseColor:"secondary",value:i,onChange:(e,t)=>l.teams.set(n,{hitMode:t})},e,{children:a.Zy.map((e=>(0,Q.tZ)(q.Z,{value:e,disabled:i===e,children:t(`hitmode.${e}`)},e)))}))}var ue=n(23002),he=n(93553),Ze=n(80162),pe=n(1811),me=n(22698),fe=n(44481),ge=n(63655),xe=n(13264),be=n(62197),ye=n(23570),ve=n(2995),Ce=n(66198),we=n(80551),Be=n(23883),ke=n(35322),Se=n(13780),Xe=n(41075),Te=n(65992),Oe=n(24264),Ee=n(89977),je=n(12702),Ie=n(69698),Pe=n(68330),Me=n(15030),Ke=n(33927),De=n(56961),Ae=n(79410),_e=n(75636),ze=n(60342),Re=n(42523),Le=n(19181),We=n(39282);function Ve({show:e,onClose:t,setTarget:n,showEmptyTargets:i=!1,flatOnly:a=!1,excludeSections:r=[],excludeHeal:l=!1}){const{data:s}=(0,c.useContext)(Z.R),d=(0,c.useMemo)((()=>(0,_e.U)(s).filter((([e])=>!r.includes(e))).map((([e,t])=>[e,Object.fromEntries(Object.entries(t).filter((([e,t])=>(!a||"%"!==t.info.unit)&&((!l||"heal"!==t.info.variant)&&!(!i&&t.isEmpty)))))])).filter((([e,t])=>Object.keys(t).length))),[s,r,a,i,l]);return(0,Q.tZ)(Ie.Z,{open:e,onClose:t,children:(0,Q.tZ)(Oe.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(ze.ZP,{columns:{xs:1,sm:2,md:3},spacing:1,children:d.map((([e,t])=>(0,Q.tZ)(Ge,{displayNs:t,sectionKey:e,setTarget:n},e)))})})})})}function Ge({displayNs:e,sectionKey:t,setTarget:n}){const{data:i}=(0,c.useContext)(Z.R),a=(0,r.Wz)(),l=(0,c.useMemo)((()=>(0,_e.f)(i,t,a)),[i,t,a]);return(0,Q.BX)(G.Z,{children:[l&&(0,Q.tZ)(Re.Z,{avatar:l.icon&&(0,Q.tZ)(Ae.Z,{size:2,src:l.icon}),title:l.title,action:l.action&&(0,Q.tZ)(J.Z,{children:l.action}),titleTypographyProps:{variant:"subtitle1"}}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(Le.Z,{children:Object.entries(e).map((([e,i])=>(0,Q.tZ)($e,{node:i,onClick:()=>n([t,e],i.info.multi)},e)))})]},t)}function $e({node:e,onClick:t}){return(0,Q.tZ)(F.Z,{onClick:t,style:{whiteSpace:"normal"},children:(0,Q.tZ)(We.HK,{node:e})})}function Ne({optimizationTarget:e,setTarget:t,disabled:n=!1,showEmptyTargets:i=!1,defaultText:a,targetSelectorModalProps:s={}}){var o;const{t:u}=(0,d.$G)("page_character_optimize"),[h,p,m]=(0,y.aV)(!1),f=(0,c.useCallback)((e=>{m(),t(e)}),[m,t]),{data:g}=(0,c.useContext)(Z.R),x=(0,r.Wz)(),b=(0,c.useMemo)((()=>e&&(0,_e.f)(g,e[0],x)),[g,e,x]);a||(a=u("targetSelector.selectOptTarget"));const{title:v,icon:C,action:w}=null!=b?b:{},B=e&&(0,T.Hm)(g.getDisplay(),e),k=!e||!b||!B||!i&&B.isEmpty,S=k?"secondary":B.info.variant,X="invalid"===S?void 0:S,{textSuffix:O}=null!=(o=null==B?void 0:B.info)?o:{},E=O&&(0,Q.BX)("span",{children:[" ",O]}),j=C?(0,Q.tZ)(Ae.Z,{src:C,size:2}):null==B?void 0:B.info.icon;return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"info",onClick:p,disabled:n,sx:{flexGrow:1},children:k?(0,Q.tZ)("strong",{children:a}):(0,Q.BX)(Ke.Z,{direction:"row",divider:(0,Q.tZ)(De.Z,{orientation:"vertical",flexItem:!0}),spacing:1,children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[j,(0,Q.tZ)("span",{children:v}),!!w&&(0,Q.tZ)(J.Z,{color:"success",sx:{whiteSpace:"normal"},children:w})]}),(0,Q.tZ)(l.Z,{sx:{display:"flex",alignItems:"center"},children:(0,Q.BX)(J.Z,{color:X,sx:{whiteSpace:"normal"},children:[(0,Q.tZ)("strong",{children:B.info.name}),E]})})]})}),(0,Q.tZ)(Ve,Object.assign({show:h,onClose:m,setTarget:f,showEmptyTargets:i},s))]})}let Fe,qe,He,Ue,Ye,Je=e=>e;const Qe=300;function et(){const e=(0,r.Wz)(),{t}=(0,d.$G)("page_character"),[n,i,a]=(0,y.aV)(),{teamChar:u,teamCharId:p}=(0,c.useContext)(g.V),[m,f]=(0,c.useState)((()=>u.customMultiTargets));(0,c.useEffect)((()=>f(u.customMultiTargets)),[f,u.customMultiTargets]);const[x,b]=(0,c.useState)(!1),C=(0,c.useCallback)((()=>{f([...m,(0,ue.HL)()]),b(m.length)}),[m,f,b]),w=(0,c.useCallback)((e=>t=>{const n=[...m];n[e]=t,f(n)}),[m,f]),B=(0,c.useCallback)((e=>()=>{if(m[e].targets.length&&!window.confirm(`Are you sure you want to delete "${m[e].name}"?`))return;const t=[...m];t.splice(e,1),f(t)}),[m,f]),k=(0,c.useCallback)((e=>()=>{const t=[...m];t.splice(e,0,m[e]),f(t)}),[m,f]),S=(0,c.useCallback)((e=>t=>{if(t=(0,v.re)(t-1,0,m.length-1),e===t)return;const n=[...m],i=n[e];n.splice(e,1),n.splice(t,0,i),f(n)}),[m,f]),X=(0,c.useCallback)((()=>{a(),e.teamChars.set(p,{customMultiTargets:m})}),[e,p,m,a]),T=(0,c.useCallback)((e=>()=>b(e!==x&&e)),[x]),{data:O,teamData:E}=(0,c.useContext)(Z.R),j=(0,c.useMemo)((()=>{const e=O.data[0],t=Object.assign({},e,{hit:Object.assign({},e.hit),infusion:Object.assign({},e.infusion)});return delete t.hit.reaction,delete t.infusion.team,{data:new Me.w(t,void 0),teamData:E}}),[O,E]),I=(0,c.useMemo)((()=>m.map(((e,t)=>(0,Q.tZ)(tt,{index:t,expanded:t===x,onExpand:T(t),target:e,setTarget:w(t),onDelete:B(t),onDup:k(t),onOrder:S(t),nTargets:m.length},`${t}${e.name}`)))),[m,B,k,x,T,w,S]);return(0,Q.BX)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",height:"100%",width:100}),children:[(0,Q.tZ)(W.Z,{color:"info",onClick:i,startIcon:(0,Q.tZ)(xe.Z,{}),children:t(Fe||(Fe=Je`multiTarget.title`))}),(0,Q.tZ)(Z.R.Provider,{value:j,children:(0,Q.tZ)(Ie.Z,{open:n,onClose:X,containerProps:{sx:{overflow:"visible"}},children:(0,Q.tZ)(Oe.Z,{children:(0,Q.BX)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,alignItems:"center",children:[(0,Q.tZ)(be.Z,{variant:"h6",children:t(qe||(qe=Je`multiTarget.title`))}),(0,Q.tZ)(je.Z,{title:(0,Q.BX)(be.Z,{children:[(0,Q.BX)(d.cC,{t,i18nKey:"multiTarget.info1",children:["Note: Community created custom Multi-Optimization Targets can be found within the",(0,Q.tZ)("a",{href:"https://discord.gg/CXUbQXyfUs",target:"_blank",rel:"noreferrer",children:"GO Discord"}),"or",(0,Q.tZ)("a",{href:"https://keqingmains.com/misc/multi-optimization/",target:"_blank",rel:"noreferrer",children:"KQM Multi-Opt Guide"}),", however the validity of such configurations cannot be guaranteed."]}),(0,Q.tZ)("br",{}),(0,Q.tZ)("br",{}),t("multiTarget.info2")]})}),(0,Q.tZ)(h.Z,{onClick:X,sx:{marginLeft:"auto"}})]}),(0,Q.BX)(l.Z,{children:[I,(0,Q.tZ)(W.Z,{fullWidth:!0,onClick:C,startIcon:(0,Q.tZ)(he.Z,{}),sx:{mt:1},children:t(He||(He=Je`multiTarget.addNewMTarget`))})]})]})})})})]})}function tt({index:e,target:t,setTarget:n,expanded:i,onExpand:a,onDelete:r,onDup:s,onOrder:o,nTargets:u}){var h;const{t:Z}=(0,d.$G)("page_character"),p=(0,c.useCallback)((e=>n(Object.assign({},t,{name:e}))),[n,t]),m=(0,c.useCallback)((e=>n(Object.assign({},t,{description:e}))),[n,t]),f=(0,c.useCallback)(((e,i)=>{const a=Object.assign({},t);a.targets=[...a.targets,(0,ue.kV)(e,i)],n(a)}),[t,n]),g=(0,c.useCallback)((e=>i=>{const a=[...t.targets];a[e]=i,n(Object.assign({},t,{targets:a}))}),[t,n]),x=(0,c.useCallback)((e=>()=>{if(Object.values(t.targets[e].bonusStats).length&&!window.confirm("Are you sure you want to delete this target?"))return;const i=[...t.targets];i.splice(e,1),n(Object.assign({},t,{targets:i}))}),[t,n]),b=(0,c.useCallback)((e=>i=>{if(void 0===i||0===i)return;const a=i-1,r=[...t.targets];(0,v.Rp)(r,e,a),n(Object.assign({},t,{targets:r}))}),[t,n]),y=(0,c.useCallback)((e=>()=>{const i=[...t.targets];i.splice(e,0,(0,v.I8)(i[e])),n(Object.assign({},t,{targets:i}))}),[t,n]),C=(0,c.useMemo)((()=>t.targets.map(((e,n)=>(0,Q.tZ)(lt,{customTarget:e,setCustomTarget:g(n),deleteCustomTarget:x(n),rank:n+1,maxRank:t.targets.length,setTargetIndex:b(n),onDup:y(n)},e.path.join()+n)))),[x,y,g,b,t.targets]);return(0,Q.BX)(ye.Z,{sx:{bgcolor:"contentLight.main"},expanded:i,children:[(0,Q.tZ)(ve.Z,{expandIcon:(0,Q.BX)(W.Z,{color:"info",sx:{pointerEvents:"auto"},onClick:a,children:[(0,Q.tZ)(xe.Z,{}),i?(0,Q.tZ)(fe.Z,{}):(0,Q.tZ)(ge.Z,{})]}),component:"div",sx:{pointerEvents:"none","& .MuiAccordionSummary-expandIconWrapper":{transform:"rotate(0)"},"& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(0)"}},children:(0,Q.BX)(l.Z,{gap:1,pr:1,display:"flex",flexWrap:"wrap",sx:{pointerEvents:"auto",width:"100%",alignItems:"center"},children:[(0,Q.tZ)(Ce.Z,{sx:{minWidth:"8em"},color:t.targets.length?"success":void 0,label:(0,Q.BX)(d.cC,{t:Z,i18nKey:"multiTarget.target",count:t.targets.length,children:[{count:t.targets.length}," Targets"]})}),(0,Q.tZ)(nt,{name:t.name,setName:p}),t.description&&(0,Q.tZ)(je.Z,{title:(0,Q.tZ)(be.Z,{children:t.description.length>Qe?t.description.slice(0,Qe)+"...":t.description})}),(0,Q.BX)(we.Z,{size:"small",children:[(0,Q.tZ)(Ee.CC,{children:(0,Q.tZ)(Ee.ZP,{onChange:e=>o(null!=e?e:0),value:e+1,inputProps:{min:1,max:u,sx:{textAlign:"center"}},sx:{width:"100%",height:"100%",pl:2}})}),(0,Q.tZ)(Be.Z,{title:Z("multiTarget.duplicate"),placement:"top",children:(0,Q.tZ)(W.Z,{onClick:s,color:"info",children:(0,Q.tZ)(Ze.Z,{})})}),(0,Q.tZ)(W.Z,{color:"error",onClick:r,children:(0,Q.tZ)(me.Z,{})})]})]})}),(0,Q.BX)(ke.Z,{children:[(0,Q.tZ)(l.Z,{mb:1,display:"flex",sx:{pointerEvents:"auto",width:"100%"},children:(0,Q.tZ)(it,{desc:null!=(h=t.description)?h:"",setDesc:m})}),(0,Q.tZ)(l.Z,{mb:1,children:(0,Q.tZ)(dt,{customMultiTarget:t,setCustomMultiTarget:n})}),(0,Q.BX)(l.Z,{display:"flex",gap:1,flexDirection:"column",children:[C,(0,Q.tZ)(ot,{setTarget:f})]})]})]})}function nt({name:e,setName:t}){const[n,i]=(0,c.useState)(e);(0,c.useEffect)((()=>i(e)),[e,i]);const[a,r,l]=(0,y.aV)(!1),s=(0,y.KS)();return(0,Q.tZ)(Se.Z,{error:a,size:"small",value:n,onChange:e=>{let t=e.target.value;t.length>=ue.ac?(s(l,2e3),r(),t=t.slice(0,ue.ac)):s(l,1),i(t)},onBlur:e=>t(n),sx:{flexGrow:1}})}function it({desc:e,setDesc:t}){const{t:n}=(0,d.$G)("page_character"),[i,a]=(0,c.useState)(e);(0,c.useEffect)((()=>a(e)),[e,a]);const[r,l,s]=(0,y.aV)(!1),o=(0,y.KS)();return(0,Q.tZ)(Se.Z,{error:r,multiline:!0,size:"small",placeholder:n("multiTarget.description"),value:i,onChange:e=>{let t=e.target.value;t.length>=ue.t2?(o(s,2e3),l(),t=t.slice(0,ue.t2)):o(s,1),a(t)},onBlur:e=>t(i),sx:{flexGrow:1}})}const at=[...S.lR],rt=(e,t)=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:e},t);function lt({customTarget:e,setCustomTarget:t,deleteCustomTarget:n,rank:i,maxRank:r,setTargetIndex:s,onDup:o}){const{t:u}=(0,d.$G)("page_character"),{characterSheet:h}=(0,c.useContext)(g.V),{data:p}=(0,c.useContext)(Z.R),{path:m,weight:f,hitMode:x,reaction:b,infusionAura:y,bonusStats:C}=e,w=(0,c.useCallback)((n=>t(Object.assign({},e,{weight:n}))),[e,t]),B=(0,v.Hm)(p.getDisplay(),m),k=(0,c.useCallback)((n=>t(Object.assign({},e,{bonusStats:n}))),[e,t]),S=(0,c.useMemo)((()=>(0,Q.tZ)(Pe.Z,{statKeys:at,statFilters:C,setStatFilters:k,wrapperFunc:rt,label:u("addStats.label")})),[C,k,u]),X=(null==h?void 0:h.isMelee())&&("normal"===m[0]||"charged"===m[0]||"plunging"===m[0]),T="reaction"===m[0];return(0,Q.BX)(Oe.Z,{sx:{display:"flex"},children:[(0,Q.BX)(l.Z,{sx:{p:1,flexGrow:1},children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[(0,Q.tZ)(Ee.ZP,{float:!0,startAdornment:"x",value:f,onChange:w,sx:{borderRadius:1,pl:1},inputProps:{sx:{pl:.5,width:"2em"},min:0}}),(0,Q.tZ)(Ne,{optimizationTarget:m,setTarget:n=>t(Object.assign({},e,{path:n,reaction:void 0,infusionAura:void 0})),showEmptyTargets:!0,targetSelectorModalProps:{flatOnly:!0,excludeSections:["basic","custom"]}}),(0,Q.tZ)(l.Z,{sx:{flexGrow:1}}),B&&(0,Q.tZ)(st,{reaction:b,setReactionMode:n=>t(Object.assign({},e,{reaction:n})),node:B,infusionAura:y}),(0,Q.tZ)(ie.Z,{title:u(`hitmode.${x}`),children:a.kE.map((n=>(0,Q.tZ)(F.Z,{value:n,disabled:x===n,onClick:()=>t(Object.assign({},e,{hitMode:n})),children:u(`hitmode.${n}`)},n)))})]}),(0,Q.BX)(Xe.ZP,{container:!0,columns:{xs:1,lg:2},sx:{pt:1},spacing:1,children:[(X||T)&&(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(ie.Z,{title:se[null!=y?y:""],color:y||"secondary",disableElevation:!0,fullWidth:!0,children:Object.entries(se).map((([n,i])=>(0,Q.tZ)(F.Z,{sx:n?{color:`${n}.main`}:void 0,selected:n===y,disabled:n===y,onClick:()=>t(Object.assign({},e,{infusionAura:n||void 0,reaction:void 0})),children:i},n)))})}),S]})]}),(0,Q.BX)(we.Z,{orientation:"vertical",sx:{borderTopLeftRadius:0,"*":{flexGrow:1}},children:[(0,Q.tZ)(Ee.CC,{children:(0,Q.tZ)(Ee.ZP,{value:i,onChange:s,sx:{pl:2},inputProps:{sx:{width:"1em"},min:1,max:r}})}),(0,Q.tZ)(W.Z,{size:"small",color:"info",onClick:o,children:(0,Q.tZ)(Ze.Z,{})}),(0,Q.tZ)(W.Z,{size:"small",color:"error",onClick:n,children:(0,Q.tZ)(me.Z,{})})]})]})}function st({node:e,reaction:t,setReactionMode:n,infusionAura:i}){var r,l,s,o,c;const u=null!=(r=e.info.variant)?r:"physical",{t:h}=(0,d.$G)("page_character");if(!["pyro","hydro","cryo","electro","dendro"].some((e=>e===u||e===i)))return null;const Z=[...new Set([...null!=(l=H.oR[u])?l:[],...null!=(s=H.oR[null!=i?i:""])?s:[],...null!=(o=H.p7[u])?o:[],...null!=(c=H.p7[null!=i?i:""])?c:[]])],p=t?[...a.Mk].includes(t)?(0,Q.tZ)(ne.Z,{reaction:t}):(0,Q.tZ)(te,{reaction:t}):h(Ue||(Ue=Je`noReaction`));return(0,Q.BX)(ie.Z,{title:p,sx:{ml:"auto"},children:[(0,Q.tZ)(F.Z,{value:"",disabled:!t,onClick:()=>n(),children:"No Reactions"}),Z.map((e=>(0,Q.tZ)(F.Z,{disabled:t===e,onClick:()=>n(e),children:[...a.Mk].includes(e)?(0,Q.tZ)(ne.Z,{reaction:e}):(0,Q.tZ)(te,{reaction:e})},e)))]})}function ot({setTarget:e}){const{t}=(0,d.$G)("page_character"),[n,i,a]=(0,y.aV)(!1),r=(0,c.useCallback)(((t,n)=>{a(),e(t,n)}),[a,e]);return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{fullWidth:!0,onClick:i,startIcon:(0,Q.tZ)(he.Z,{}),sx:{mb:1},children:t(Ye||(Ye=Je`multiTarget.addNewTarget`))}),(0,Q.tZ)(Ve,{showEmptyTargets:!0,flatOnly:!0,excludeHeal:!0,show:n,onClose:a,setTarget:r,excludeSections:["basic","custom"]})]})}const ct=(0,Te.ZP)("textarea")({width:"100%",fontFamily:"monospace",resize:"vertical",minHeight:"2em"});function dt({customMultiTarget:e,setCustomMultiTarget:t}){const[n,i]=(0,c.useState)(JSON.stringify(e)),[a,r]=(0,c.useState)("");(0,c.useEffect)((()=>{r(""),i(JSON.stringify(e))}),[e,i]);const s=(0,c.useCallback)((()=>navigator.clipboard.writeText(n).then((()=>alert("Copied configuration to clipboard."))).catch(console.error)),[n]),o=(0,c.useCallback)((e=>{r(""),i(e);try{const n=(0,ue.RX)(JSON.parse(e));n?t(n):r("Invalid Multi-Optimization Config")}catch(n){n instanceof Error&&r(n.message)}}),[i,t]);return(0,Q.BX)(l.Z,{children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,children:[(0,Q.tZ)(ct,{value:n,sx:{outlineColor:a?"red":void 0},onClick:e=>{const t=e.target;t.selectionStart=0,t.selectionEnd=t.value.length},onChange:e=>o(e.target.value)}),(0,Q.tZ)(W.Z,{color:"info",disabled:!!a,onClick:s,children:(0,Q.tZ)(pe.Z,{})})]}),!!a&&(0,Q.tZ)(Y.Z,{color:"error",children:(0,Q.tZ)(be.Z,{children:a})})]})}var ut=n(84485),ht=n(4453);function Zt(){const{modalOpen:e}=(0,c.useContext)(p.M),{setFormulaData:t}=(0,c.useContext)(p.M),n=(0,c.useCallback)((()=>null==t?void 0:t(void 0,void 0)),[t]);return(0,Q.tZ)(Ie.Z,{open:!!e,onClose:n,children:(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(Re.Z,{title:"Formulas & Calculations",action:(0,Q.tZ)(h.Z,{onClick:n})}),(0,Q.tZ)(o.Z,{sx:{pt:0},children:(0,Q.tZ)(pt,{})})]})})}function pt(){const{data:e}=(0,c.useContext)(Z.R),{data:t}=(0,c.useContext)(p.M),n=(0,_e.U)(null!=t?t:e);return(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:1e3}),children:(0,Q.tZ)(l.Z,{sx:{mr:-1,mb:-1},children:n.map((([e,t])=>(0,Q.tZ)(mt,{displayNs:t,sectionKey:e},e)))})})}function mt({sectionKey:e,displayNs:t}){const{data:n}=(0,c.useContext)(Z.R),i=(0,r.Wz)(),{data:a}=(0,c.useContext)(p.M),l=(0,c.useMemo)((()=>(0,_e.f)(null!=a?a:n,e,i)),[i,a,n,e]);if(!l)return null;if(Object.entries(t).every((([e,t])=>t.isEmpty)))return null;const{title:s,icon:d,action:u}=l;return(0,Q.BX)(G.Z,{sx:{mb:1},children:[(0,Q.tZ)(ht.Z,{avatar:d&&(0,Q.tZ)(Ae.Z,{size:2,src:d}),title:s,action:u&&(0,Q.tZ)(J.Z,{children:u})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{children:Object.entries(t).map((([e,t])=>!t.isEmpty&&(0,Q.tZ)(ft,{node:t},e)))})]})}function ft({node:e}){const{node:t}=(0,c.useContext)(p.M),[n,i]=(0,c.useState)(!1),r=(0,c.useCallback)(((e,t)=>i(t)),[]),s=(0,c.useRef)();return(0,c.useEffect)((()=>{e===t&&setTimeout((()=>{var e;return null==s||null==(e=s.current)||null==e.scrollIntoView?void 0:e.scrollIntoView({behavior:"smooth"})}),300)}),[s,e,t]),(0,Q.BX)(ye.Z,{sx:{bgcolor:"contentNormal.main"},expanded:e===t||n,onChange:r,ref:s,children:[(0,Q.BX)(ve.Z,{expandIcon:(0,Q.tZ)(ut.Z,{}),children:[(0,Q.BX)(be.Z,{children:[(0,Q.tZ)(Y.Z,{color:e.info.variant,children:e.info.name})," ",(0,Q.tZ)("strong",{children:(0,Me.p)(e)})]}),a.Mk.includes(e.info.variant)&&(0,Q.tZ)(l.Z,{sx:{display:"inline-block",ml:"auto",mr:2},children:(0,Q.tZ)(ne.Z,{reaction:e.info.variant,trigger:e.info.subVariant})})]}),(0,Q.tZ)(ke.Z,{children:e.formulas.map(((e,t)=>(0,Q.tZ)(be.Z,{component:"div",children:e},t)))})]})}var gt=n(15162),xt=n(107),bt=n(15873),yt=n(32510),vt=n(5658),Ct=n(27216),wt=n(41033),Bt=n(85801);const kt=["expand"],St=(0,Te.ZP)((e=>{const t=(0,b.Z)(e,kt);return(0,Q.tZ)(Bt.Z,Object.assign({},t))}))((({theme:e,expand:t})=>({transform:t?"rotate(180deg)":"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})})));var Xt=n(13900);const Tt=["name","children","value","placeholder","defaultValue","onValueChange","percent","disabled","onReset"],Ot=(0,Te.ZP)(we.Z)({display:"flex"});function Et(e){let{name:t,children:n,value:i,placeholder:a,defaultValue:r=0,onValueChange:l,percent:s=!1,disabled:o=!1,onReset:c}=e,d=(0,b.Z)(e,Tt);return(0,Q.BX)(Ot,Object.assign({},d,{children:[n,(0,Q.tZ)(Xt.Z,{sx:{px:1},children:t}),(0,Q.tZ)(Ee.CC,{sx:{flexBasis:"10em",flexGrow:1},children:(0,Q.tZ)(Ee.ZP,{sx:{px:1},inputProps:{sx:{textAlign:"right"}},float:s,placeholder:a,value:i,onChange:l,disabled:o,endAdornment:s?"%":void 0})}),(0,Q.tZ)(W.Z,{sx:{flexShrink:2},size:"small",color:"error",onClick:()=>c?c():l(r),disabled:o||i===r,children:(0,Q.tZ)(yt.Z,{})})]}))}let jt,It=e=>e;function Pt(){const{t:e}=(0,d.$G)("ui"),{teamId:t}=(0,c.useContext)(g.V),n=(0,r.Wz)(),{data:i}=(0,c.useContext)(Z.R),[s,u]=(0,c.useState)(!1),h=(0,c.useCallback)((()=>u(!s)),[u,s]),p=i.get(S.ri.enemy.level),m=i.get(S.ri.enemy.defRed),f=i.get(S.ri.enemy.defIgn),x=(0,c.useCallback)((()=>n.teams.set(t,{enemyOverride:{}})),[n,t]);return(0,Q.BX)(G.Z,{children:[(0,Q.BX)(o.Z,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[(0,Q.tZ)(Ce.Z,{size:"small",color:"success",label:(0,Q.BX)("span",{children:[p.info.name," ",(0,Q.tZ)("strong",{children:p.value})]})}),a.fR.map((e=>(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(Mt,{element:e})},e))),(0,Q.BX)(be.Z,{children:["DEF Red. ",(0,Me.p)(m)]}),(0,Q.BX)(be.Z,{children:["DEF Ignore ",(0,Me.p)(f)]}),(0,Q.BX)(l.Z,{flexGrow:1,display:"flex",justifyContent:"flex-end",gap:1,children:[(0,Q.tZ)(W.Z,{size:"small",color:"error",onClick:x,startIcon:(0,Q.tZ)(yt.Z,{}),children:e(jt||(jt=It`reset`))}),(0,Q.tZ)(St,{expand:s,onClick:h,"aria-expanded":s,"aria-label":"show more",size:"small",sx:{marginLeft:0},children:(0,Q.tZ)(ut.Z,{})})]})]}),(0,Q.tZ)(wt.Z,{in:s,timeout:"auto",unmountOnExit:!0,children:(0,Q.tZ)(o.Z,{sx:{pt:0},children:(0,Q.tZ)(Kt,{})})})]})}function Mt({element:e}){const{data:t}=(0,c.useContext)(Z.R),n=t.get(S.ri.enemy[`${e}_res_`]),i=!isFinite(n.value),a=(0,Q.tZ)(U.Z,{ele:e,iconProps:$.mX}),r=i?(0,Q.BX)("span",{children:[a," \u221e"]}):(0,Q.BX)("span",{children:[a," ",(0,Q.tZ)("strong",{children:(0,Me.p)(n)})]});return(0,Q.tZ)(Y.Z,{color:e,children:r})}function Kt({bsProps:e={xs:12,md:6}}){var t,n,i;const{teamId:l,team:{enemyOverride:s}}=(0,c.useContext)(g.V),o=(0,r.Wz)(),{data:d}=(0,c.useContext)(Z.R),u=null!=(t=s.enemyLevel)?t:d.get(S.ri.lvl).value,h=null!=(n=s.enemyDefIgn_)?n:0,p=null!=(i=s.enemyDefRed_)?i:0;return(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},e,{children:(0,Q.tZ)(W.Z,{fullWidth:!0,sx:{height:"100%"},size:"small",component:"a",color:"warning",href:"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances",target:"_blank",rel:"noreferrer",children:"To get the specific resistance values of enemies, please visit the wiki."})})),(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},e,{children:(0,Q.tZ)(Et,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,Q.tZ)("b",{children:gt.d4.get("enemyLevel")}),value:u,placeholder:gt.d4.getStr("enemyLevel"),defaultValue:d.get(S.ri.lvl).value,onValueChange:e=>o.teams.set(l,(t=>{t.enemyOverride.enemyLevel=e})),onReset:()=>o.teams.set(l,(e=>{delete e.enemyOverride.enemyLevel}))})})),a.fR.map((t=>{const n=`${t}_enemyRes_`,i=s[n],a=i===Number.MAX_VALUE;return(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},e,{children:(0,Q.tZ)(Et,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,Q.tZ)(Y.Z,{color:t,children:(0,Q.tZ)("b",{children:gt.d4.get(n)})}),value:void 0!==i?a?1/0:i:10,placeholder:a?"\u221e ":gt.d4.getStr(n),defaultValue:10,onValueChange:e=>o.teams.set(l,(t=>{t.enemyOverride[n]=e})),disabled:a,percent:!0,children:(0,Q.tZ)(W.Z,{color:t,onClick:()=>o.teams.set(l,(e=>{e.enemyOverride[n]=a?10:Number.MAX_VALUE})),startIcon:a?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),children:"Immunity"})})}),t)})),(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},e,{children:(0,Q.tZ)(Et,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,Q.tZ)("b",{children:gt.d4.get("enemyDefIgn_")}),value:h,placeholder:gt.d4.getStr("enemyDefIgn_"),defaultValue:0,onValueChange:e=>o.teams.set(l,(t=>{t.enemyOverride.enemyDefIgn_=e})),percent:!0})})),(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},e,{children:(0,Q.tZ)(Et,{sx:{bgcolor:e=>e.palette.contentLight.main,width:"100%"},name:(0,Q.tZ)("b",{children:gt.d4.get("enemyDefRed_")}),value:p,placeholder:gt.d4.getStr("enemyDefRed_"),defaultValue:0,onValueChange:e=>o.teams.set(l,(t=>{t.enemyOverride.enemyDefRed_=e})),percent:!0})})),(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,children:(0,Q.tZ)("small",{children:"Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)"})})]})}let Dt,At=e=>e;const _t={xs:1,md:2,lg:3};function zt({open:e,onClose:t}){const{t:n}=(0,d.$G)("page_character");return(0,Q.tZ)(Ie.Z,{open:e,onClose:t,children:(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(Re.Z,{title:n(Dt||(Dt=At`addStats.title`)),action:(0,Q.tZ)(h.Z,{onClick:t})}),(0,Q.tZ)(o.Z,{sx:{pt:0},children:(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.tZ)(Wt,{}),(0,Q.tZ)(Pt,{}),(0,Q.tZ)(Ht,{})]})})]})})}const Rt=[...S.lR],Lt=(e,t)=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:e},t);function Wt(){const{t:e}=(0,d.$G)("page_character"),t=(0,r.Wz)(),{teamCharId:n,teamChar:{bonusStats:i}}=(0,c.useContext)(g.V);return(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{sx:{display:"flex"},children:(0,Q.BX)(Xe.ZP,{container:!0,columns:_t,sx:{pt:1},spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,children:(0,Q.tZ)(xt.Z,{severity:"info",variant:"filled",children:(0,Q.BX)(d.cC,{i18nKey:"addStats.info",t:e,children:["You can use these fields to add buffs/debuffs not directly supported in GO, such as food buffs, abyss cards, or Superconduct. Please refer to the",(0,Q.tZ)("a",{href:"https://genshin-impact.fandom.com/wiki/Genshin_Impact_Wiki",children:"Genshin Impact Wiki"}),"for specific values."]})})}),(0,Q.tZ)(Pe.Z,{statKeys:Rt,statFilters:i,setStatFilters:e=>t.teamChars.set(n,{bonusStats:e}),wrapperFunc:Lt,label:e("addStats.label")})]})})})}const Vt=["eleMas","critRate_","critDMG_","enerRech_","heal_"],Gt=["hp","atk","def",...Vt].map((e=>S.ri.total[e])),$t=["atk_","atk","hp_","hp","def_","def",...Vt],Nt=[...gt.hX,...gt.Sx,"stamina","incHeal_","shield_","cdRed_"],Ft=S.lR.filter((e=>!$t.includes(e)&&!Nt.includes(e)));function qt({nodes:e,extra:t}){const{data:n,oldData:i}=(0,c.useContext)(Z.R);return(0,Q.BX)(We.lD,{children:[e.map((e=>{var t;return(0,Q.tZ)(We.JW,{component:bt.ZP,node:n.get(e),oldValue:null==i||null==(t=i.get(e))?void 0:t.value},JSON.stringify(e.info))})),t]})}function Ht(){const{characterSheet:e}=(0,c.useContext)(g.V),{data:t}=(0,c.useContext)(Z.R),n=t.get(S.ri.special),i=e.elementKey,a=e.isMelee(),r=(0,c.useMemo)((()=>Nt.filter((e=>!e.includes(i)&&(a&&e.includes("physical"),!0))).map((e=>S.ri.total[e])).filter((e=>!!t.get(e).value))),[t,i,a]),l=(0,c.useMemo)((()=>Ft.map((e=>S.ri.total[e])).filter((e=>t.get(e).value))),[t]);return(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,columns:_t,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Ut,{title:"Main Stats",children:(0,Q.tZ)(qt,{nodes:Gt,extra:n&&(0,Q.BX)(bt.ZP,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,Q.BX)("span",{children:[(0,Q.tZ)("b",{children:"Special:"})," ",(0,Q.BX)(Y.Z,{color:n.info.variant,children:[n.info.icon," ",n.info.name]})]}),(0,Q.tZ)("span",{children:(0,Me.p)(n)})]})})})}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Ut,{title:"Other Stats",children:(0,Q.tZ)(qt,{nodes:r})})}),!!l.length&&(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Ut,{title:"Misc Stats",children:(0,Q.tZ)(qt,{nodes:l})})})]})})})}function Ut({title:e,children:t}){return(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(o.Z,{sx:{py:1},children:(0,Q.tZ)(l.Z,{display:"flex",justifyContent:"space-between",children:(0,Q.tZ)(be.Z,{variant:"subtitle1",children:e})})}),t]})}var Yt=n(36269),Jt=n(46342),Qt=n(62469),en=n(85162),tn=n(51290),nn=n(45269),an=n(11615),rn=n(23119);function ln(){const{t:e}=(0,d.$G)("page_character_optimize");return(0,Q.tZ)(xt.Z,{severity:"warning",variant:"filled",children:(0,Q.BX)(d.cC,{t:e,i18nKey:"noArtis",children:["Oops! It looks like you haven't added any artifacts to GO yet! You should go to the",(0,Q.tZ)(rn.Z,{component:V.rU,to:"/artifacts",children:"Artifacts"}),"page and add some!"]})})}var sn=n(29218),on=n(93290),cn=n(4311),dn=n(2180);var un=n(64985),hn=n(6094);function Zn(e,t,n=!1){const i=new Set,r=new Set;function l(e,t){return t?i.add(e):e.operands.forEach((e=>i.has(e)&&r.add(e))),e}const s=new Set;if(e=(0,un.uW)(e,(e=>e),(e=>{const{operation:t}=e;switch(t){case"read":return s.add(e.path[1]),l(e,!0);case"add":{const t=e.operands.filter((e=>i.has(e))),n=e.operands.filter((e=>!i.has(e)));if(0===n.length)return l(e,!0);if(t.length<=1)return l(e,!1);const a=l((0,hn.Sm)(...t),!0);return l((0,hn.Sm)(a,...n),!1)}case"mul":{const t=e.operands.filter((e=>"const"!==e.operation));return l(e,0===t.length||1===t.length&&i.has(t[0]))}case"const":return l(e,!0);case"res":case"threshold":case"sum_frac":case"max":case"min":return l(e,!1);default:(0,v.UT)(t)}})),e.filter((e=>i.has(e))).forEach((e=>r.add(e))),[...r].every((({operation:e})=>"read"===e||"const"===e))&&Object.keys(t.base).length===s.size)return{nodes:e,arts:t};let o=-1;function c(){for(;s.has(""+ ++o););return`${o}`}const d=[...r].filter((e=>"const"!==e.operation)),u=new Map(d.map((e=>[e,n||"read"!==e.operation||"dyn"!==e.path[0]?(0,hn.Cj)(c()):e])));function h(e){const t=(0,on.CG)([...u.keys()],{dyn:(0,v.vU)(e,(e=>(0,hn.a9)(e)))},(e=>!0));return Object.fromEntries([...u.values()].map(((e,n)=>[e.path[1],t[n].value])))}const Z={nodes:e=(0,un.uW)(e,(e=>{var t;return null!=(t=u.get(e))?t:e}),(e=>e)),arts:{base:h(t.base),values:(0,v.K8)(a.Ex,(e=>t.values[e].map((({id:e,set:t,values:n})=>({id:e,set:t,values:h(n)})))))}},p=Object.entries(h({}));for(const a of Object.values(Z.arts.values))for(const{values:e}of a)for(const[t,n]of p)e[t]-=n;return Z}function pn(e,t,n){var i;let r=!1;const l=!(null!=(i=n.rainbow)&&i.length),s=Object.keys(e.base),o=new Set(Object.entries(n).filter((([e,t])=>t.length)).map((([e])=>e))),c=new Set(Object.entries(n).filter((([e,t])=>t.includes(2)&&!t.includes(4))).map((([e])=>e))),d=(0,v.K8)(a.Ex,(n=>{const i=e.values[n],a=i.filter((e=>{let n=0;return i.every((i=>{const a=s.every((t=>{var n,a;return(null!=(n=i.values[t])?n:0)>=(null!=(a=e.values[t])?a:0)})),r=s.some((t=>{var n,a;return(null!=(n=i.values[t])?n:0)>(null!=(a=e.values[t])?a:0)})),d=a&&(r||i.id>e.id),u=l&&!o.has(i.set)&&!c.has(e.set)||e.set===i.set;return d&&u&&n++,n<t}))}));return a.length!==i.length&&(r=!0),a}));return r?{base:e.base,values:d}:e}function mn(e,t,n){const i=Object.fromEntries(Object.entries(t.base).map((([e,t])=>[e,{min:t,max:t}]))),r={arts:t};for(;;){const t=(0,v.K8)(a.Ex,(e=>xn(r.arts.values[e]))),l=(0,v.K8)(a.Ex,(e=>gn(Object.entries(t).map((t=>t[0]===e?i:t[1])).filter((e=>e)))));let s=!1;const o=(0,v.K8)(a.Ex,(t=>{const i=r.arts.values[t].filter((i=>{const a=gn([xn([i]),l[t]]),r=bn(e,a);return e.every(((e,t)=>{var i;return r.get(e).max>=(null!=(i=n[t])?i:-1/0)}))}));return i.length!==r.arts.values[t].length&&(s=!0),i}));if(!s)break;r.arts={base:r.arts.base,values:o}}return r.arts}function fn(e,t){const n=bn(e,gn([Object.fromEntries(Object.entries(t.base).map((([e,t])=>[e,{min:t,max:t}]))),...Object.values(t.values).map((e=>xn(e)))]));return(0,un.uW)(e,(e=>{{const{min:t,max:i}=n.get(e);if(t===i)return(0,hn.a9)(t)}const{operation:t}=e,i=e.operands.map((e=>n.get(e)));switch(t){case"threshold":{const[t,n,a,r]=i;if(t.min>=n.max)return e.operands[2];if(t.max<n.min)return e.operands[3];if(a.max===a.min&&r.max===r.min&&a.min===r.min&&isFinite(a.min))return(0,hn.a9)(a.max);break}case"min":{const t=e.operands.filter(((e,t)=>{const n=i[t];return i.every((e=>n.min<=e.max))}));if(t.length<i.length)return(0,hn.VV)(...t);break}case"max":{const t=e.operands.filter(((e,t)=>{const n=i[t];return i.every((e=>n.max>=e.min))}));if(t.length<i.length)return(0,hn.Fp)(...t);break}}return e}),(e=>e))}function gn(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,n])=>{t[e]?(t[e].min+=n.min,t[e].max+=n.max):t[e]=Object.assign({},n)}))})),t}function xn(e){const t={};return e.length&&(Object.keys(e[0].values).filter((t=>e.every((e=>e.values[t])))).forEach((n=>t[n]={min:e[0].values[n],max:e[0].values[n]})),e.forEach((({values:e})=>{for(const[n,i]of Object.entries(e))t[n]?(t[n].max<i&&(t[n].max=i),t[n].min>i&&(t[n].min=i)):t[n]={min:0,max:i}}))),t}function bn(e,t){const n=new Map;return(0,un.aD)(e,(e=>{}),(e=>{var i;const{operation:a}=e,r=e.operands.map((e=>n.get(e)));let l;switch(a){case"read":if("dyn"!==e.path[0])throw new Error(`Found non-dyn path ${e.path} while computing range`);l=null!=(i=t[e.path[1]])?i:{min:0,max:0};break;case"const":l=yn([e.value]);break;case"add":case"min":case"max":l={min:on.aj[a](r.map((e=>e.min))),max:on.aj[a](r.map((e=>e.max)))};break;case"res":l={min:on.aj[a]([r[0].max]),max:on.aj[a]([r[0].min])};break;case"mul":l=r.reduce(((e,t)=>yn([e.min*t.min,e.min*t.max,e.max*t.min,e.max*t.max])));break;case"threshold":l=r[0].min>=r[1].max?r[2]:r[0].max<r[1].min?r[3]:yn([],[r[2],r[3]]);break;case"sum_frac":{const[e,t]=r,n={min:e.min+t.min,max:e.max+t.max};l=n.min<=0&&n.max>=0?e.min<=0&&e.max>=0?{min:NaN,max:NaN}:{min:-1/0,max:1/0}:yn([e.min/n.min,e.min/n.max,e.max/n.min,e.max/n.max]);break}default:(0,v.UT)(a)}n.set(e,l)})),n}function yn(e,t=[]){const n=Math.max(...e,...t.map((e=>e.max)));return{min:Math.min(...e,...t.map((e=>e.min))),max:n}}function vn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return vn=function(e){this.s=e,this.n=e.next},vn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new vn(e)}class WorkerCoordinator{constructor(e,t,n){this.prio=void 0,this.commands=void 0,this.workers=void 0,this.workDone=new Map,this._workers=void 0,this.cancel=void 0,this.cancelled=void 0,this.callback=void 0,this.notifyNonEmpty=void 0,this.commands=t.map((e=>new v.uZ)),this.prio=new Map(t.map(((e,t)=>[e,t]))),this.callback=n,e.forEach((e=>{e.onmessage=t=>this.onMessage(t.data,e),e.onerror=e=>this.onError(e)})),this._workers=e,this.workers=e.map((e=>Promise.resolve(e))),this.cancel=()=>{},this.cancelled=new Promise(((e,t)=>this.cancel=t)),this.cancelled.catch((t=>e.forEach((e=>e.terminate()))))}async execute(e){var t=this;const n=async function(){var n,i=!1,a=!1;try{for(var r,l=function(e){var t,n,i,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new vn(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(e);i=!(r=await l.next()).done;i=!1){const e=r.value;t.add(e)}}catch(s){a=!0,n=s}finally{try{i&&null!=l.return&&await l.return()}finally{if(a)throw n}}}();for(;;){var i;const e=null==(i=this.commands.find((e=>e.length)))?void 0:i.pop();if(void 0===e){const e=await Promise.race([new Promise((e=>this.notifyNonEmpty=()=>e(!0))),Promise.all([...this.workers,n]).then((e=>!1)),this.cancelled]);if(this.notifyNonEmpty=void 0,e)continue;break}const{i:t,w:a}=await Promise.race([...this.workers.map(((e,t)=>e.then((e=>({i:t,w:e}))))),this.cancelled]);this.workers[t]=new Promise((e=>this.workDone.set(a,(()=>e(a))))),a.postMessage(e)}}onError(e){this.cancel(new Error(`Worker Error: ${e.message}`))}onMessage(e,t){void 0!==e.command?this.add(e):"done"===e.resultType?this.workDone.get(t)():this.callback(e,t)}add(e){var t;const n=this.prio.get(e.command);this.commands[n].push(e),null==(t=this.notifyNonEmpty)||t.call(this)}broadcast(e){this._workers.forEach((t=>t.postMessage(e)))}notifiedBroadcast(e){this.workers=this.workers.map((e=>e.then((e=>new Promise((t=>{this.workDone.set(e,(()=>t(e)))})))))),this._workers.forEach((t=>t.postMessage(e)))}}class GOSolver extends WorkerCoordinator{constructor(e,t,i){super(Array(i).fill(NaN).map((e=>new Worker(new URL(n.p+n.u(976),n.b)))),["iterate","split","count"],((e,t)=>{switch(e.resultType){case"interim":this.interim(e,t);break;case"finalize":this.finalizedResults.push(e);break;case"count":this.status.total=e.count;break;case"err":this.onError(e)}})),this.maxIterateSize=32e6,this.status=void 0,this.exclusion=void 0,this.topN=void 0,this.buildValues=void 0,this.finalizedResults=[];const{exclusion:a,topN:r}=e;this.status=t,this.exclusion=a,this.topN=r,this.status.total=NaN,this.buildValues=Array(r).fill({w:void 0,val:-1/0}),this.notifiedBroadcast(this.preprocess(e))}async solve(){const{exclusion:e,maxIterateSize:t}=this;return this.finalizedResults=[],await this.execute([{command:"count",exclusion:e,maxIterateSize:t}]),this.notifiedBroadcast({command:"finalize"}),await this.execute([]),this.finalizedResults}preprocess({plotBase:e,optimizationTarget:t,arts:n,topN:i,exclusion:a,constraints:r}){let l=[...(r=r.filter((e=>e.min>-1/0))).map((e=>e.value)),t];const s=[...r.map((e=>e.min)),-1/0];e&&(l.push(e),s.push(-1/0)),l=function(e,t){const n={};for(const[i,a]of Object.entries(t))a.includes(4)&&(n[i]=a.includes(2)?1:3);return(0,un.uW)(e,(e=>e),(e=>{if("threshold"!==e.operation)return e;const[i,a,r,l]=e.operands;if("read"===i.operation&&"const"===a.operation){const e=i.path[i.path.length-1],s=a.value;if(e in n){if(n[e]<s)return l;if(2===s&&t[e].includes(2))return(0,hn.Lj)(i,4,r,l)}}return e}))}(l,a),l=(0,on.tL)(l,{},(e=>!1)),({nodes:l,arts:n}=function(e,t,n,i,a,r){let l=r;const s={pruneNodeRange:!0},o={pruneNodeRange:!0},c={reaffine:!0},d={pruneOrder:!0,pruneArtRange:!0,pruneNodeRange:!0};let u=0;for(;Object.values(l).some((e=>e))&&u++<20;){if(l.pruneOrder){delete l.pruneOrder;const e=pn(n,i,a);n!==e&&(n=e,l=Object.assign({},l,s))}if(l.pruneArtRange){delete l.pruneArtRange;const i=mn(e,n,t);n!==i&&(n=i,l=Object.assign({},l,o))}if(l.pruneNodeRange){delete l.pruneNodeRange;const t=fn(e,n);e!==t&&(e=t,l=Object.assign({},l,c))}if(l.reaffine){delete l.reaffine;const{nodes:t,arts:i}=Zn(e,n);e===t&&n===i||(e=t,n=i,l=Object.assign({},l,d))}}return{nodes:e,arts:n}}(l,s,n,i,a,{reaffine:!0,pruneArtRange:!0,pruneNodeRange:!0,pruneOrder:!0})),l=(0,on.tL)(l,{},(e=>!1)),e&&(e=l.pop());return{command:"setup",arts:n,optTarget:l.pop(),plotBase:e,topN:i,constraints:l.map(((e,t)=>({value:e,min:s[t]})))}}interim(e,t){if(this.status.tested+=e.tested,this.status.failed+=e.failed,this.status.skipped+=e.skipped,e.buildValues){var n,i;const{topN:a}=this,r=null!=(n=this.buildValues[a-1].val)?n:-1/0;this.buildValues.filter((({w:e})=>e!==t)),this.buildValues.push(...e.buildValues.map((e=>({w:t,val:e})))),this.buildValues.sort(((e,t)=>t.val-e.val)).splice(a);const l=null!=(i=this.buildValues[a-1].val)?i:-1/0;r!==l&&this.broadcast({command:"threshold",threshold:l})}}}var Cn=n(2313),wn=n(96511),Bn=n(79199),kn=n(72539),Sn=n(16633),Xn=n(46433),Tn=n(1574),On=n(75213),En=n(87227),jn=n(26437);function In({characterKey:e,onClick:t,onMouseDown:n,onMouseEnter:i,simpleTooltip:a=!1,disableTooltip:o=!1}){const d=(0,r.AU)(e),{favorite:u}=(0,r.xF)(e),{gender:h}=(0,r.Hz)(),{silly:Z}=(0,c.useContext)(f.E),p=(0,x.m)(e,h),m=(0,c.useCallback)((()=>null==t?void 0:t(e)),[e,t]),g=(0,c.useCallback)((e=>(0,Q.tZ)(On.Z,{onClick:m,onMouseDown:n,onMouseEnter:i,children:e})),[m,n,i]),[b,y]=(0,c.useState)(!1),v=(0,c.useCallback)((()=>!o&&y(!0)),[o]),C=(0,c.useCallback)((()=>y(!1)),[]);(0,c.useEffect)((()=>{o&&y(!1)}),[o]);const w=(0,c.useCallback)((e=>(0,Q.tZ)(nn.Z,{placement:"top",open:b&&!o,onClose:C,onOpen:v,title:(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{width:300,height:400}),children:(0,Q.BX)(be.Z,{children:[p.elementKey&&(0,Q.tZ)(U.Z,{ele:p.elementKey,iconProps:{fontSize:"inherit",sx:{verticalAlign:"-10%",color:`${p.elementKey}.main`}}})," ",p.name]})}),children:e})),[p.elementKey,p.name,o,C,v,b]),B=(0,c.useCallback)((t=>(0,Q.tZ)(nn.Z,{enterNextDelay:500,enterTouchDelay:500,placement:"top",open:b&&!o,onClose:C,onOpen:v,title:(0,Q.tZ)(l.Z,{sx:{width:300,m:-1},children:(0,Q.tZ)(an.Z,{hideStats:!0,characterKey:e})}),children:t})),[e,o,C,v,b]);return(0,Q.tZ)(jn.Z,{condition:a,wrapper:w,falseWrapper:B,children:(0,Q.tZ)(Oe.Z,{sx:{maxWidth:128,position:"relative",display:"flex",flexDirection:"column"},children:(0,Q.BX)(jn.Z,{condition:!!t||!!n||!!i,wrapper:g,children:[(0,Q.tZ)(l.Z,{display:"flex",className:`grad-${p.rarity}star`,children:(0,Q.tZ)(l.Z,{component:"img",src:(0,En.i)(e,h,Z),maxWidth:"100%",maxHeight:"100%",draggable:!1})}),d&&(0,Q.tZ)(be.Z,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",top:0},children:(0,Q.tZ)("strong",{children:(0,Q.BX)(J.Z,{color:"primary",children:[d.level,"/",Sn.SJ[d.ascension]]})})}),(0,Q.tZ)(l.Z,{sx:{position:"absolute",top:0,right:0},children:u?(0,Q.tZ)(Xn.Z,{fontSize:"small"}):(0,Q.tZ)(Tn.Z,{fontSize:"small"})}),d&&(0,Q.tZ)(be.Z,{sx:{position:"absolute",fontSize:"0.75rem",lineHeight:1,opacity:.85,pointerEvents:"none",bottom:0,right:0},children:(0,Q.tZ)("strong",{children:(0,Q.BX)(J.Z,{color:"secondary",children:["C",d.constellation]})})})]})})})}var Pn=n(42090),Mn=n(89279),Kn=n(28265),Dn=n(64303);function An(e){const t=(0,r.Wz)(),[n,i]=(0,c.useState)((()=>t.buildSettings.get(e)));(0,c.useEffect)((()=>i(t.buildSettings.get(e))),[t,e]),(0,c.useEffect)((()=>t.buildSettings.follow(e,((e,t,n)=>"update"===t&&i(n)))),[e,i,t]);return{buildSetting:n,buildSettingDispatch:(0,c.useCallback)((n=>e&&t.buildSettings.set(e,n)),[e,t])}}let _n,zn,Rn,Ln,Wn=e=>e;var Vn=function(e){return e[e.ToggleToAllow=0]="ToggleToAllow",e[e.ToggleToExclude=1]="ToggleToExclude",e}(Vn||{});function Gn({disabled:e=!1,allowListTotal:t}){const{t:n}=(0,d.$G)("page_character_optimize"),{t:i}=(0,d.$G)("page_character"),{character:{key:s}}=(0,c.useContext)(g.V),{silly:u}=(0,c.useContext)(f.E),{buildSetting:{excludedLocations:Z,allowLocationsState:p},buildSettingDispatch:m}=An(s),b=(0,r.Wz)(),[C,w,B]=(0,y.aV)(!1),[k,S]=(0,y.NW)(),X=(0,c.useDeferredValue)(k),[T,O]=(0,c.useState)(""),E=(0,c.useDeferredValue)(T),[j,I]=(0,c.useState)([...a.UB]),P=(0,c.useDeferredValue)(j),[M,K]=(0,c.useState)([...a.yd]),D=(0,c.useDeferredValue)(M),[A,_]=(0,c.useState)([...a.ZI]),z=(0,c.useDeferredValue)(A),R=(0,c.useMemo)((()=>X&&Object.fromEntries(Array.from(new Set(Object.entries(b.chars.data).filter((([e])=>(0,a.V7)(e)!==(0,a.V7)(s))).filter((([e])=>(0,v.CZ)({element:P,weaponType:D,rarity:z,name:E},(0,Dn.zU)(b,u))(e))))))),[X,b,s,P,D,z,E,u]),L=Array.from(new Set(Object.entries(R).sort((([e,t],[n,i])=>{const[a,r]=[-1,1],l=b.charMeta.get(e).favorite,s=b.charMeta.get(n).favorite;if(l&&!s)return a;if(s&&!l)return r;const o=Object.values(t.equippedArtifacts).filter((e=>e)).length,c=Object.values(i.equippedArtifacts).filter((e=>e)).length;return o>c?a:c>o?r:e.localeCompare(n)})).map((([e])=>(0,a.V7)(e))))),{elementTotals:V,weaponTypeTotals:N,characterRarityTotals:F,locListTotals:H}=(0,c.useMemo)((()=>{const e={elementTotals:[...a.UB],weaponTypeTotals:[...a.yd],characterRarityTotals:[...a.ZI],locListTotals:["allowed","excluded"]};let t=!1;return(0,Cn.A)(e,(e=>Object.entries(b.chars.data).filter((([e])=>(0,a.V7)(e)!==(0,a.V7)(s))).forEach((([n])=>{const i=(0,x.m)(n,b.gender),r=i.elementKey,l=i.weaponTypeKey,s=i.rarity;if(e.elementTotals[r].total++,R[n]&&e.elementTotals[r].current++,"Traveler"===(0,a.V7)(n)){if(!R[n]&&L.includes("Traveler")){if(e.elementTotals[r].current++,t)return;e.weaponTypeTotals[l].current++,e.characterRarityTotals[s].current++}t=!0}e.weaponTypeTotals[l].total++,R[n]&&e.weaponTypeTotals[l].current++,e.characterRarityTotals[s].total++,R[n]&&e.characterRarityTotals[s].current++;const o=(0,a.V7)(n);L.includes(o)&&(e.locListTotals.allowed.total++,e.locListTotals.excluded.total++,Z.includes(o)?e.locListTotals.excluded.current++:e.locListTotals.allowed.current++)}))))}),[R,s,b.chars.data,b.gender,Z,L]);(0,c.useEffect)((()=>b.charMeta.followAny((e=>S()))),[S,b]),(0,c.useEffect)((()=>b.chars.followAny((e=>S()))),[S,b]);const[U,Y]=(0,c.useState)(!1),ee=(0,c.useCallback)((()=>m({excludedLocations:Z.filter((e=>!L.includes(e))),allowLocationsState:"customList"})),[m,Z,L]),te=(0,c.useCallback)((()=>m({excludedLocations:Array.from(new Set(Z.concat(L))),allowLocationsState:"customList"})),[m,Z,L]),ne=(0,c.useCallback)(((e,t)=>m({allowLocationsState:t})),[m]),ie=(0,c.useCallback)((e=>{const t=[...e],n=t.filter((e=>!Z.includes(e))).concat(Z.filter((e=>!t.includes(e))));m({excludedLocations:n,allowLocationsState:"customList"})}),[Z,m]),re=(0,c.useCallback)((()=>Y(!0)),[]),le=L.length,se=le-Z.length,oe="all"===p?le:"customList"===p?se===le?se:`${se}/${le}`:0,ce="all"===p?"success":"customList"===p?"info":"secondary";return(0,Q.BX)(l.Z,{display:"flex",gap:1,children:[(0,Q.tZ)(Ie.Z,{open:C,onClose:B,containerProps:{maxWidth:"xl"},draggable:!1,onMouseUp:re,children:(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(l.Z,{display:"flex",gap:1,alignItems:"center",children:[(0,Q.tZ)(be.Z,{variant:"h6",children:n(_n||(_n=Wn`excludeChar.title`))}),(0,Q.tZ)(je.Z,{title:(0,Q.tZ)(be.Z,{children:n(zn||(zn=Wn`excludeChar.tooltip`))})}),(0,Q.tZ)(l.Z,{flexGrow:1}),(0,Q.tZ)(h.Z,{onClick:B,size:"small"})]})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{sx:{pb:0},children:(0,Q.BX)(Ke.Z,{gap:1,children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[(0,Q.tZ)(ae.Z,{exclusive:!0,baseColor:"secondary",size:"small",value:p,onChange:ne,children:ue.Cz.map((t=>(0,Q.tZ)(q.Z,{value:t,disabled:p===t||e,children:n(`excludeChar.states.${t}`)},t)))}),(0,Q.tZ)(Se.Z,{autoFocus:!0,value:T,onChange:e=>O(e.target.value),label:i("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})]}),(0,Q.BX)(l.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[(0,Q.tZ)(Kn.Z,{sx:{height:"100%"},onChange:K,value:D,totals:N,size:"small"}),(0,Q.tZ)(Mn.Z,{sx:{height:"100%"},onChange:I,value:P,totals:V,size:"small"}),(0,Q.tZ)(Pn.Z,{sx:{height:"100%"},onChange:_,value:z,totals:F,size:"small"})]})]})}),(0,Q.BX)(o.Z,{sx:{opacity:"customList"===p?1:.6},children:[(0,Q.BX)(Xe.ZP,{container:!0,pb:1,gap:1,flexWrap:"nowrap",children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:6,children:(0,Q.BX)(W.Z,{color:"success",fullWidth:!0,onClick:ee,children:[n(Rn||(Rn=Wn`excludeChar.modal.allow_all`)),(0,Q.tZ)(J.Z,{sx:{ml:1},children:(0,Q.tZ)("strong",{children:H.allowed})})]})}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:6,children:(0,Q.BX)(W.Z,{fullWidth:!0,color:"error",onClick:te,children:[n(Ln||(Ln=Wn`excludeChar.modal.disallow_All`)),(0,Q.tZ)(J.Z,{sx:{ml:1},children:(0,Q.tZ)("strong",{children:H.excluded})})]})})]}),(0,Q.tZ)($n,{locList:L,excludedLocations:Z,mouseUpDetected:U,setMouseUpDetected:Y,toggleList:ie})]})]})}),(0,Q.BX)(G.Z,{sx:{display:"flex",width:"100%"},children:[(0,Q.tZ)(o.Z,{sx:{flexGrow:1},children:(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.tZ)(be.Z,{children:(0,Q.tZ)("strong",{children:n("excludeChar.title")})}),(0,Q.BX)(be.Z,{children:[n("excludeChar.usingState")," ",(0,Q.tZ)(J.Z,{color:ce,children:n(`excludeChar.states.${p}`)})]}),(0,Q.BX)(be.Z,{children:[n("excludeChar.chars")," ",(0,Q.BX)(J.Z,{color:"success",children:[oe," ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX)),n("artSetConfig.allowed")]})]}),(0,Q.BX)(be.Z,{children:[n("excludeChar.artis")," ",(0,Q.BX)(J.Z,{color:"success",children:[t," ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX)),n("artSetConfig.allowed")]})]})]})}),(0,Q.tZ)(W.Z,{sx:{borderRadius:0,flexShrink:1,minWidth:40},onClick:w,disabled:e,color:"info",children:(0,Q.tZ)(xe.Z,{})})]})]})}function $n({locList:e,excludedLocations:t,mouseUpDetected:n,setMouseUpDetected:i,toggleList:a}){const[r,l]=(0,c.useState)(new Set),[s,o]=(0,c.useState)();return(0,c.useEffect)((()=>{n&&(i(!1),r.size>0&&(a(r),l(new Set),o(void 0)))}),[r,l,i,n,a]),(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,columns:{xs:6,sm:7,md:10,lg:12,xl:16},children:e.map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Nn,{locKey:e,charList:r,charListMode:s,setCharList:l,setCharListMode:o,selected:!t.includes(e)})},e)))})}function Nn({locKey:e,selected:t,charList:n,charListMode:i,setCharList:s,setCharListMode:o}){const d=(0,r.Wz)(),u=d.chars.get(d.chars.LocationToCharacterKey(e)),h=(0,c.useCallback)((a=>1===a.buttons&&(i===Vn.ToggleToAllow&&!t||i===Vn.ToggleToExclude&&t)&&s(new Set([...n]).add(e))),[i,t,s,n,e]),Z=(0,c.useCallback)((()=>{const i=t?Vn.ToggleToExclude:Vn.ToggleToAllow;o(i),s(new Set([...n]).add(e))}),[t,o,s,n,e]),p=(0,c.useMemo)((()=>0!==n.size),[n.size]),m=t&&!(i===Vn.ToggleToExclude&&n.has(e))||i===Vn.ToggleToAllow&&n.has(e),f={opacity:m?void 0:.6,borderColor:m?"rgb(100,200,100)":"rgb(200,100,100)",borderWidth:"3px",borderStyle:"solid",borderRadius:"8px"},g=(0,c.useMemo)((()=>(0,Q.tZ)(l.Z,{fontSize:"0.85em",display:"flex",justifyContent:"space-between",p:.3,children:a.Ex.map((e=>(0,Q.tZ)(Bn.Z,{slotKey:e,iconProps:{fontSize:"inherit",sx:{opacity:null!=u&&u.equippedArtifacts[e]?void 0:.5}}},e)))})),[null==u?void 0:u.equippedArtifacts]);return(0,Q.BX)(G.Z,{sx:f,children:[(0,Q.tZ)(In,{characterKey:d.chars.LocationToCharacterKey(e),onMouseDown:Z,onMouseEnter:h,disableTooltip:p}),g]})}var Fn=n(38114),qn=n(78437),Hn=n(91923),Un=n(1665),Yn=n(51576);let Jn,Qn,ei=e=>e;function ti({setKey:e,buttonGroupSx:t}){var n;const{t:i}=(0,d.$G)("sheet"),{character:{key:a}}=(0,c.useContext)(g.V),{buildSetting:{artSetExclusion:r},buildSettingDispatch:l}=An(a),s=null!=(n=null==r?void 0:r[e])?n:[],o=s.includes(2),u=s.includes(4);return(0,Q.BX)(we.Z,{sx:t,fullWidth:!0,children:[(0,Q.tZ)(W.Z,{startIcon:o?(0,Q.tZ)(Ct.Z,{}):(0,Q.tZ)(vt.Z,{}),onClick:()=>l({artSetExclusion:(0,ue.sL)(r,e,2)}),color:o?"secondary":"success",endIcon:o?(0,Q.tZ)(Fn.Z,{}):(0,Q.tZ)(wn.Z,{}),children:i(Jn||(Jn=ei`2set`))}),(0,Q.tZ)(W.Z,{startIcon:u?(0,Q.tZ)(Ct.Z,{}):(0,Q.tZ)(vt.Z,{}),onClick:()=>l({artSetExclusion:(0,ue.sL)(r,e,4)}),color:u?"secondary":"success",endIcon:u?(0,Q.tZ)(Fn.Z,{}):(0,Q.tZ)(wn.Z,{}),children:i(Qn||(Qn=ei`4set`))})]})}let ni,ii,ai,ri,li,si,oi,ci,di,ui,hi,Zi,pi,mi,fi=e=>e;function gi({disabled:e}){var t,n;const{t:i}=(0,d.$G)(["page_character_optimize","sheet"]),s=(0,c.useContext)(Z.R),u=(0,r.Wz)(),{character:{key:p},teamChar:{conditional:m},teamCharId:f}=(0,c.useContext)(g.V),{buildSetting:{artSetExclusion:x},buildSettingDispatch:b}=An(p),[w,B]=(0,c.useState)(!1),k=(0,c.useCallback)((()=>B(!0)),[B]),S=(0,c.useCallback)((()=>B(!1)),[B]),[X,T]=(0,y.NW)();(0,c.useEffect)((()=>u.arts.followAny(T)),[u,T]);const O=(0,c.useMemo)((()=>Object.entries(C.WO).reverse().flatMap((([,e])=>e)).filter((e=>!e.includes("Prayers")))),[]),{artKeys:E,artSlotCount:j}=(0,c.useMemo)((()=>{const e=(0,v.K8)(O,(e=>(0,v.K8)(a.Ex,(e=>0))));u.arts.values.forEach((t=>e[t.setKey]&&e[t.setKey][t.slotKey]++));const t=[...O].sort(((t,n)=>+(yi(e[t])<2)-+(yi(e[n])<2)));return X&&{artKeys:t,artSlotCount:e}}),[X,u,O]),I=!(null!=(t=x.rainbow)&&t.includes(2)),P=!(null!=(n=x.rainbow)&&n.includes(4)),{allowTotals:M}=(0,c.useMemo)((()=>(0,Cn.A)({allowTotals:["2","4"]},(e=>O.forEach((t=>{var n,i;e.allowTotals[2].total++,null!=(n=x[t])&&n.includes(2)||e.allowTotals[2].current++,e.allowTotals[4].total++,null!=(i=x[t])&&i.includes(4)||e.allowTotals[4].current++}))))),[O,x]),K=(0,c.useMemo)((()=>Object.keys(m).filter((e=>{var t;return a.Gt.includes(e)&&!!Object.keys(null!=(t=m[e])?t:{}).length})).length),[m]),D=(0,c.useMemo)((()=>Object.assign({},s,{data:new Me.w(Object.assign({},s.data.data[0],{artSet:(0,v.K8)(a.Gt,(e=>(0,hn.a9)(4)))}),void 0)})),[s]),A=(0,c.useCallback)((()=>{const e=Object.fromEntries(Object.entries(m).filter((([e])=>!a.Gt.includes(e))));u.teamChars.set(f,(t=>{t.conditional=e}))}),[u,f,m]),_=(0,c.useCallback)(((e,t=!0)=>{const n=(0,v.I8)(x);O.forEach((i=>{var a;t?n[i]=[...null!=(a=n[i])?a:[],e]:n[i]&&(n[i]=n[i].filter((t=>t!==e)))})),b({artSetExclusion:n})}),[O,x,b]);return(0,Q.BX)(Q.HY,{children:[(0,Q.BX)(G.Z,{sx:{display:"flex",width:"100%"},children:[(0,Q.BX)(o.Z,{sx:{flexGrow:1},children:[(0,Q.tZ)(be.Z,{children:(0,Q.tZ)("strong",{children:i(ni||(ni=fi`artSetConfig.title`))})}),(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.BX)(be.Z,{children:[i(ii||(ii=fi`artSetConfig.setEffCond`))," ",(0,Q.BX)(J.Z,{color:K?"success":"warning",children:[K," ",i("artSetConfig.enabled")]})]}),(0,Q.BX)(be.Z,{children:[i(ai||(ai=fi`sheet:2set`))," ",(0,Q.BX)(J.Z,{color:"success",children:[M[2]," ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX))," ",i("artSetConfig.allowed")]})]}),(0,Q.BX)(be.Z,{children:[i(ri||(ri=fi`sheet:4set`))," ",(0,Q.BX)(J.Z,{color:"success",children:[M[4]," ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX))," ",i("artSetConfig.allowed")]})]}),(0,Q.BX)(be.Z,{children:[i(li||(li=fi`artSetConfig.2rainbow`))," ",(0,Q.BX)(J.Z,{color:I?"success":"secondary",children:[I?(0,Q.tZ)(wn.Z,Object.assign({},$.mX)):(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," ",I?i("artSetConfig.allowed"):"Excluded"]})]}),(0,Q.BX)(be.Z,{children:[i(si||(si=fi`artSetConfig.4rainbow`))," ",(0,Q.BX)(J.Z,{color:P?"success":"secondary",children:[P?(0,Q.tZ)(wn.Z,Object.assign({},$.mX)):(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," ",P?i("artSetConfig.allowed"):"Excluded"]})]})]})]}),(0,Q.tZ)(W.Z,{onClick:k,disabled:e,color:"info",sx:{borderRadius:0,flexShrink:1,minWidth:40},children:(0,Q.tZ)(xe.Z,{})})]}),(0,Q.tZ)(Ie.Z,{open:w,onClose:S,children:(0,Q.BX)(Oe.Z,{children:[(0,Q.BX)(o.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,Q.tZ)(be.Z,{variant:"h6",children:i(oi||(oi=fi`artSetConfig.title`))}),(0,Q.tZ)(h.Z,{onClick:S})]}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(G.Z,{sx:{mb:1},children:(0,Q.BX)(o.Z,{children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,children:[(0,Q.tZ)(be.Z,{children:(0,Q.tZ)("strong",{children:i(ci||(ci=fi`artSetConfig.modal.setCond.title`))})}),(0,Q.tZ)(be.Z,{sx:{flexGrow:1},children:(0,Q.BX)(J.Z,{color:K?"success":"warning",children:[K," ",i("artSetConfig.selected")]})}),(0,Q.tZ)(W.Z,{size:"small",onClick:A,color:"error",startIcon:(0,Q.tZ)(yt.Z,{}),children:i(di||(di=fi`artSetConfig.modal.setCond.reset`))})]}),(0,Q.tZ)(be.Z,{children:i(ui||(ui=fi`artSetConfig.modal.setCond.text`))})]})}),(0,Q.tZ)(G.Z,{sx:{mb:1},children:(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(be.Z,{sx:{flexGrow:1},children:(0,Q.tZ)("strong",{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.title",children:["Artifact Sets ",(0,Q.BX)(Y.Z,{color:"success",children:["Allowed",(0,Q.tZ)(wn.Z,Object.assign({},$.mX))]})," / ",(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Excluded",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))]})]})})}),(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.intro",children:["You can allow/exclude which sets you want the builder to consider. In the following examples, ",(0,Q.tZ)("strong",{children:"A"})," is on-set, and ",(0,Q.tZ)("strong",{children:"R"})," is rainbow(off-set)"]})}),(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.2set",children:[(0,Q.tZ)("strong",{children:(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Excluding",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," 2-Set"]})}),"would exclude 2-Set builds:",(0,Q.BX)("strong",{children:[(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"AA"}),"RRR"]}),"and",(0,Q.BX)("strong",{children:[(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"AAA"}),"RR"]}),"."]})}),(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.4set",children:[(0,Q.tZ)("strong",{children:(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Excluding",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," 4-Set"]})}),"would exclude 4-Set builds:",(0,Q.BX)("strong",{children:[(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"AAAA"}),"R"]}),"and",(0,Q.tZ)("strong",{children:(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"AAAAA"})}),"."]})}),(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.2rain",children:[(0,Q.tZ)("strong",{children:(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Excluding",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," 3-Rainbow"]})}),"would exclude 2-Set + 3-Rainbow builds:",(0,Q.BX)("strong",{children:["AA",(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"RRR"})]}),"and",(0,Q.BX)("strong",{children:["AAA",(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"RR"})]}),"."]})}),(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.modal.ArtSetFilter.4rain",children:[(0,Q.tZ)("strong",{children:(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Excluding",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))," 5-Rainbow"]})}),"would exclude full 5-Rainbow builds:",(0,Q.tZ)("strong",{children:(0,Q.tZ)(Y.Z,{color:"secondary",variant:"light",children:"RRRRR"})}),"."]})})]})}),(0,Q.BX)(Xe.ZP,{container:!0,columns:{xs:2,lg:3},sx:{mb:1},spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(xi,{allowTotal:M[2],setNum:2,setAllExclusion:_})}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(xi,{allowTotal:M[4],setNum:4,setAllExclusion:_})}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(G.Z,{children:(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(be.Z,{gutterBottom:!0,children:(0,Q.tZ)("strong",{children:(0,Q.BX)(d.cC,{t:i,i18nKey:"artSetConfig.alExRainbow",children:[(0,Q.BX)(Y.Z,{color:"success",children:["Allow ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX))]})," / ",(0,Q.BX)(Y.Z,{color:"secondary",variant:"light",children:["Exclude ",(0,Q.tZ)(Fn.Z,Object.assign({},$.mX))]})," Rainbow Builds"]})})}),(0,Q.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)(W.Z,{fullWidth:!0,onClick:()=>b({artSetExclusion:(0,ue.sL)(x,"rainbow",2)}),color:I?"success":"secondary",startIcon:I?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),endIcon:I?(0,Q.tZ)(wn.Z,{}):(0,Q.tZ)(Fn.Z,{}),children:i(hi||(hi=fi`artSetConfig.2rainbow`))}),(0,Q.tZ)(W.Z,{fullWidth:!0,onClick:()=>b({artSetExclusion:(0,ue.sL)(x,"rainbow",4)}),color:P?"success":"secondary",startIcon:P?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),endIcon:P?(0,Q.tZ)(wn.Z,{}):(0,Q.tZ)(Fn.Z,{}),children:i(Zi||(Zi=fi`artSetConfig.4rainbow`))})]})]})})})]}),(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,columns:{xs:2,lg:3},children:E.map((e=>(0,Q.tZ)(bi,{setKey:e,fakeDataContextObj:D,slotCount:j[e]},e)))})]}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{sx:{py:1},children:(0,Q.tZ)(h.Z,{large:!0,onClick:S})})]})})]})}function xi({allowTotal:e,setNum:t,setAllExclusion:n}){const{t:i}=(0,d.$G)(["page_character_optimize","sheet"]);return(0,Q.tZ)(G.Z,{children:(0,Q.BX)(o.Z,{children:[(0,Q.BX)(be.Z,{gutterBottom:!0,children:[(0,Q.tZ)("strong",{children:i(`sheet:${t}set`)})," ",(0,Q.BX)(J.Z,{color:"success",children:[e," ",(0,Q.tZ)(wn.Z,Object.assign({},$.mX))," ",i("artSetConfig.allowed")]})]}),(0,Q.BX)(l.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)(W.Z,{fullWidth:!0,disabled:"0"!==e.charAt(0)&&-1===e.indexOf("/"),onClick:()=>n(t,!1),color:"success",startIcon:(0,Q.tZ)(wn.Z,{}),children:i(`artSetConfig.allowAll${t}set`)}),(0,Q.tZ)(W.Z,{fullWidth:!0,disabled:"0"===e.charAt(0),onClick:()=>n(t,!0),color:"secondary",startIcon:(0,Q.tZ)(Fn.Z,{}),children:i(`artSetConfig.excludeAll${t}set`)})]})]})})}function bi({setKey:e,fakeDataContextObj:t,slotCount:n}){var i,a;const{t:r}=(0,d.$G)("sheet"),{character:{key:s}}=(0,c.useContext)(g.V),{buildSetting:u}=An(s),{artSetExclusion:h}=u,p=null!=(i=null==h?void 0:h[e])?i:[],m=!p.includes(4),f=yi(n),x=(0,C.Sk)(e),b=(0,c.useMemo)((()=>m?Object.keys(x.setEffects).filter((e=>{var t;return null==(t=x.setEffects[e])?void 0:t.document.some((e=>"states"in e))})):[]),[x.setEffects,m]);return(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.BX)(G.Z,{sx:{height:"100%",opacity:f<2?"50%":void 0},children:[(0,Q.BX)(l.Z,{className:`grad-${x.rarity[0]}star`,width:"100%",sx:{display:"flex"},children:[(0,Q.tZ)(l.Z,{component:"img",src:(0,Yn.jU)(e),sx:{height:100,width:"auto",mx:-1}}),(0,Q.BX)(l.Z,{sx:{flexGrow:1,px:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,Q.tZ)(be.Z,{variant:"h6",children:null!=(a=x.name)?a:""}),(0,Q.tZ)(l.Z,{children:(0,Q.BX)(be.Z,{variant:"subtitle1",children:[x.rarity.map(((e,t)=>(0,Q.BX)(l.Z,{component:"span",sx:{display:"inline-flex",alignItems:"center"},children:[e," ",(0,Q.tZ)(qn.Z,{fontSize:"inherit"})," ",t<x.rarity.length-1?"/ ":null]},e)))," ",(0,Q.tZ)(je.L,{title:(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(J.Z,{color:"success",children:r(pi||(pi=fi`2set`))})}),(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(Un.v,{ns:`artifact_${e}_gen`,key18:"setEffects.2"})}),(0,Q.BX)(l.Z,{paddingTop:2,sx:{opacity:p.includes(4)?.6:1},children:[(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(J.Z,{color:"success",children:r(mi||(mi=fi`4set`))})}),(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(Un.v,{ns:`artifact_${e}_gen`,key18:"setEffects.4"})})]})]})})]})}),(0,Q.tZ)(l.Z,{sx:{display:"flex",gap:1},children:Object.entries(n).map((([e,t])=>(0,Q.tZ)(be.Z,{sx:{flexGrow:1},variant:"subtitle2",children:(0,Q.BX)(J.Z,{sx:{width:"100%"},color:t?"primary":"secondary",children:[(0,Q.tZ)(Bn.Z,{slotKey:e,iconProps:$.mX})," ",t]})},e)))})]})]}),ue.Uu.includes(e)&&(0,Q.tZ)(ti,{setKey:e,buttonGroupSx:{".MuiButton-root":{borderRadius:0}}}),!!b.length&&(0,Q.tZ)(Z.R.Provider,{value:t,children:(0,Q.tZ)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:b.map((t=>(0,Q.tZ)(Hn.Z,{setKey:e,setNumKey:parseInt(t),hideHeader:!0,conditionalsOnly:!0},t)))})})]})},e)}function yi(e){return Object.values(e).reduce(((e,t)=>e+(t?1:0)),0)}const vi=[0,4,8,12,16,20];function Ci({mainStatAssumptionLevel:e=0,setmainStatAssumptionLevel:t,disabled:n}){const{t:i}=(0,d.$G)("page_character_optimize");return(0,Q.tZ)(ie.Z,{fullWidth:!0,color:e?"success":"primary",disabled:n,title:e?i("mainStat.assumptionLvl.lvl",{lvl:e}):i("mainStat.assumptionLvl.no"),children:vi.map((e=>(0,Q.tZ)(F.Z,{onClick:()=>t(e),children:e?i("mainStat.assumptionLvl.lvl",{lvl:e}):i("mainStat.assumptionLvl.no")},e)))})}let wi,Bi=e=>e;function ki(){const{t:e}=(0,d.$G)("page_character_optimize"),{teamChar:{bonusStats:t}}=(0,c.useContext)(g.V),{data:n}=(0,c.useContext)(Z.R),i=Object.keys(t);if(!i.length)return null;const a=i.map((e=>n.get(S.ri.customBonus[e])));return(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(be.Z,{sx:{fontWeight:"bold"},children:e(wi||(wi=Bi`bonusStats.title`))})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{children:a.map((e=>(0,Q.tZ)(We.JW,{node:e},JSON.stringify(e.info))))})]})}var Si=n(38162);const Xi=(0,Te.ZP)("strong")({fontFamily:"monospace"}),Ti=(0,Te.ZP)(Si.Z)((()=>({height:10,borderRadius:5})));function Oi({status:{type:e,tested:t,failed:n,skipped:i,total:a,startTime:r,finishTime:l},characterName:s}){const o=isFinite(a),c="inactive"!==e,d=a-i,u=(0,Q.tZ)(Xi,{children:t.toLocaleString()}),h=(0,Q.tZ)(Xi,{children:d.toLocaleString()}),Z=!!i&&(0,Q.BX)("span",{children:["(",(0,Q.tZ)("b",{children:(0,Q.tZ)(Xi,{children:i.toLocaleString()})})," skipped)"]}),p=(0,Q.tZ)(Xi,{children:(0,v.e6)(Math.round((null!=l?l:performance.now())-(null!=r?r:NaN)))});let m,f="",g="";if(c)m=100*t/d,f=(0,Q.BX)(be.Z,{children:["Generating and testing ",u,o?(0,Q.BX)(Q.HY,{children:["/",h]}):void 0," build configurations against the criteria for ",(0,Q.tZ)("b",{children:s}),". ",Z]}),g=(0,Q.BX)(be.Z,{children:["Time elapsed: ",p]});else{if(!(t+i))return null;m=100,f=(0,Q.BX)(be.Z,{children:["Generated and tested ",u," Build configurations against the criteria for ",(0,Q.tZ)("b",{children:s}),". ",Z]}),g=(0,Q.BX)(be.Z,{children:["Total duration: ",p]})}return(0,Q.BX)(xt.Z,{severity:"success",variant:"filled",sx:{"& .MuiAlert-message":{flexGrow:1}},children:[f,g,void 0!==m&&(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,alignItems:"center",children:[o&&(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(be.Z,{children:`${m.toFixed(1)}%`})}),(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1,children:(0,Q.tZ)(Ti,{variant:o?"determinate":"indeterminate",value:m,color:"primary"})})]})]})}var Ei=n(74064),ji=n(73673),Ii=n(99074),Pi=n(22499),Mi=n(22254),Ki=n(46725),Di=n(25065),Ai=n(30706),_i=n(5051);function zi({artifacts:e,currentlyEquipped:t=!1}){const n=(0,c.useMemo)((()=>e.filter((e=>e)).reduce(((e,t)=>(e[t.setKey]?e[t.setKey].push(t.slotKey):e[t.setKey]=[t.slotKey],e)),{})),[e]);return(0,Q.tZ)(Q.HY,{children:Object.entries(n).sort((([e,t],[n,i])=>i.length-t.length)).map((([e,n])=>(0,Q.tZ)(Ri,{setKey:e,currentlyEquipped:t,slotarr:n},e)))})}function Ri({setKey:e,currentlyEquipped:t=!1,slotarr:n}){var i;const a=(0,C.Sk)(e),r=n.length,s=Object.keys(a.setEffects).map((e=>parseInt(e))).filter((e=>e<=r));return(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(_i.Z,{artifactSheet:a,numInSet:r,children:(0,Q.tZ)(J.Z,{sx:{height:"100%"},color:t?"success":"primary",children:(0,Q.BX)(be.Z,{children:[n.map((e=>(0,Q.tZ)(Bn.Z,{slotKey:e,iconProps:$.mX},e)))," ",null!=(i=a.name)?i:"",s.map(((e,t)=>(0,Q.tZ)(J.Z,{sx:{ml:.5},color:"success",children:e},""+e+t)))]})})})})}let Li,Wi,Vi=e=>e;function Gi({label:e,compareBuild:t,extraButtonsRight:n,extraButtonsLeft:i,disabled:d}){const{character:{key:u,equippedArtifacts:h}}=(0,c.useContext)(g.V),{buildSetting:{mainStatAssumptionLevel:p,allowLocationsState:m}}=An(u),f=(0,r.Wz)(),x=(0,c.useContext)(Z.R),{data:b,oldData:y}=x,[v,C]=(0,c.useState)(void 0),w=(0,c.useCallback)((()=>C(void 0)),[C]),B=(0,c.useCallback)((()=>{if(!window.confirm("Do you want to equip this build to this character?"))return;const e=f.chars.get(u);if(!e)return;a.Ex.forEach((t=>{var n;const i=null==(n=b.get(S.ri.art[t].id).value)?void 0:n.toString();if(i)f.arts.set(i,{location:(0,a.V7)(u)});else{const n=e.equippedArtifacts[t];n&&f.arts.get(n)&&f.arts.set(n,{location:""})}}));const t=b.get(S.ri.weapon.id).value;t&&f.weapons.set(t,{location:(0,a.V7)(u)})}),[u,b,f]),k=(0,c.useMemo)((()=>{const e=Object.assign({},x);return t||(e.oldData=void 0),e}),[x,t]),X=(0,c.useMemo)((()=>Object.fromEntries(a.Ex.map((e=>{var t;return[e,null==(t=b.get(S.ri.art[e].id).value)?void 0:t.toString()]})))),[b]),T=(0,c.useMemo)((()=>X&&Object.values(X).map((e=>f.arts.get(e))).filter((e=>e))),[X,f.arts]),O=(0,c.useMemo)((()=>a.Ex.map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Mi.Z,{showLocation:!0,slotKey:e,artifactId:X[e],mainStatAssumptionLevel:p,onClick:()=>{const t=h[e],n=X[e];C({oldId:t!==n?t:void 0,newId:n})}})},e)))),[C,h,p,X]);if(!y)return null;const E=a.Ex.every((e=>{var t;return X[e]===(null==(t=y.get(S.ri.art[e].id).value)?void 0:t.toString())}))&&b.get(S.ri.weapon.id).value===y.get(S.ri.weapon.id).value;return(0,Q.tZ)(G.Z,{children:(0,Q.BX)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:600}),children:[v&&(0,Q.tZ)($i,{newOld:v,mainStatAssumptionLevel:p,onClose:w,allowLocationsState:m}),(0,Q.BX)(o.Z,{children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,sx:{pb:1},flexWrap:"wrap",children:[void 0!==e&&(0,Q.tZ)(J.Z,{color:"info",children:(0,Q.tZ)(be.Z,{children:(0,Q.BX)("strong",{children:[e,E?" (Equipped)":""]})})}),(0,Q.tZ)(zi,{artifacts:T,currentlyEquipped:E}),(0,Q.tZ)(l.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"flex-end"}}),i,(0,Q.tZ)(W.Z,{size:"small",color:"success",onClick:B,disabled:d||E,startIcon:(0,Q.tZ)(Ei.Z,{}),children:"Equip Build"}),n]}),(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,sx:{pb:1},columns:{xs:2,sm:3,md:4,lg:6},children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Di.Z,{showLocation:!0,weaponId:b.get(S.ri.weapon.id).value})}),O]}),(0,Q.tZ)(Z.R.Provider,{value:k,children:(0,Q.tZ)(Ki.Z,{})})]})]})})}function $i({newOld:{newId:e,oldId:t},mainStatAssumptionLevel:n,onClose:i,allowLocationsState:s}){var d,u;const h=(0,r.Wz)(),{character:{key:Z}}=(0,c.useContext)(g.V),p=(0,c.useCallback)((()=>{window.confirm("Do you want to equip this artifact to this character?")&&(h.arts.set(e,{location:(0,a.V7)(Z)}),i())}),[e,h,Z,i]),m=null!=(d=null==(u=h.arts.get(e))?void 0:u.location)?d:"",f=(0,r.$l)(e);return(0,Q.tZ)(Ie.Z,{open:!!e,onClose:i,containerProps:{maxWidth:t?"md":"xs"},children:(0,Q.tZ)(Oe.Z,{children:(0,Q.BX)(o.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:2},children:[t&&(0,Q.tZ)(l.Z,{minWidth:320,children:(0,Q.tZ)(Ai.Z,{artifactId:t,mainStatAssumptionLevel:n,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0},extraButtons:(0,Q.tZ)(Ni,{id:t})})}),t&&(0,Q.tZ)(l.Z,{display:"flex",flexGrow:1}),t&&(0,Q.tZ)(l.Z,{display:"flex",alignItems:"center",justifyContent:"center",children:(0,Q.tZ)(W.Z,{onClick:p,sx:{display:"flex"},children:(0,Q.tZ)(ji.Z,{sx:{fontSize:40}})})}),t&&(0,Q.tZ)(l.Z,{display:"flex",flexGrow:1}),(0,Q.BX)(l.Z,{minWidth:320,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(Ai.Z,{artifactId:e,mainStatAssumptionLevel:n,canEquip:!0,editorProps:{disableSet:!0,disableSlot:!0},extraButtons:(0,Q.tZ)(Ni,{id:e})}),m&&m!==(0,a.V7)(Z)&&"all"!==s&&(0,Q.tZ)(Fi,{locationKey:m}),f&&ue.Uu.includes(f.setKey)&&(0,Q.tZ)(ti,{setKey:f.setKey})]})]})})})}function Ni({id:e}){const{t}=(0,d.$G)("page_character_optimize"),{character:{key:n}}=(0,c.useContext)(g.V),{buildSetting:{artExclusion:i},buildSettingDispatch:a}=An(n),r=i.includes(e),s=(0,c.useCallback)((()=>a({artExclusion:(0,v.nh)(i,e)})),[e,i,a]);return(0,Q.tZ)(nn.Z,{title:(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(be.Z,{children:t(Li||(Li=Vi`excludeArt.excludeArtifactTip`))}),(0,Q.tZ)(be.Z,{children:(0,Q.tZ)(Y.Z,{color:r?"error":"success",children:t(r?"excludeArt.excluded":"excludeArt.included")})})]}),placement:"top",arrow:!0,children:(0,Q.tZ)(W.Z,{onClick:s,color:r?"error":"success",size:"small",children:r?(0,Q.tZ)(Fn.Z,{}):(0,Q.tZ)(wn.Z,{})})})}function Fi({locationKey:e}){const{t}=(0,d.$G)("page_character_optimize"),{character:{key:n}}=(0,c.useContext)(g.V),i=(0,r.Wz)(),a=(0,x.m)(i.chars.LocationToCharacterKey(e)),{buildSetting:{excludedLocations:l},buildSettingDispatch:s}=An(n),o=l.includes(e),u=(0,c.useCallback)((()=>s({excludedLocations:(0,v.nh)(l,e)})),[e,l,s]);return(0,Q.tZ)(W.Z,{onClick:u,color:o?"secondary":"success",size:"small",startIcon:o?(0,Q.tZ)(Pi.Z,{}):(0,Q.tZ)(Ii.Z,{}),children:(0,Q.BX)("span",{children:[t(Wi||(Wi=Vi`excludeChar.allowEquip`))," ",(0,Q.tZ)("strong",{children:a.name})]})})}var qi=n(68164),Hi=n(15099),Ui=n(61660),Yi=n(22443),Ji=n(55484),Qi=n(25556),ea=n(81224),ta=n(3131),na=n(47857),ia=n(55734),aa=n(63004),ra=n(36197);function la(e){const t=(0,r.Wz)(),[n,i]=(0,c.useState)((()=>t.buildResult.get(e)));(0,c.useEffect)((()=>i(t.buildResult.get(e))),[t,e]),(0,c.useEffect)((()=>t.buildResult.follow(e,((e,t,n)=>"update"===t&&i(n)))),[e,i,t]);return{buildResult:n,buildResultDispatch:(0,c.useCallback)((n=>e&&t.buildResult.set(e,n)),[e,t])}}function sa({cx:e,cy:t,payload:n,selectedPoint:i,radiusSelected:a=6,radiusUnselected:r=3,colorSelected:l="red",colorUnselected:s,shape:o="circle"}){if(!e||!t||!n)return null;const c=i&&i.x===n.x&&i.y===n.y;return(0,Q.tZ)("g",{className:"custom-dot","data-chart-x":e,"data-chart-y":t,"data-x-value":n.x,"data-y-value":n.y,"data-radius":c?r:a,children:c?(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(oa,{id:"customShapeSelected",shape:o,cx:e,cy:t,r:a/2,fill:l}),(0,Q.tZ)(oa,{id:"customShapeBorder",shape:o,cx:e,cy:t,r:a,fill:"none",stroke:l})]}):(0,Q.tZ)(oa,{id:"customShapeUnselected",shape:o,cx:e,cy:t,r,fill:s})})}function oa({shape:e,id:t,cx:n,cy:i,r:a,fill:r,stroke:l}){switch(e){case"circle":return(0,Q.tZ)("circle",{id:t,cx:n,cy:i,r:a,fill:r,stroke:l});case"square":return(0,Q.tZ)("rect",{id:t,x:n-a,y:i-a,width:2*a,height:2*a,fill:r,stroke:l});case"diamond":return(0,Q.tZ)("polygon",{id:t,points:`${n},${i+2.5*a} ${n+1.5*a},${i} ${n},${i-2.5*a} ${n-1.5*a},${i}`,fill:r,stroke:l})}}var ca=n(99118),da=n(45390);const ua=["xLabel","xUnit","yLabel","yUnit","selectedPoint","setSelectedPoint","addBuildToList"];function ha(e){let{xLabel:t,xUnit:n,yLabel:i,yUnit:l,selectedPoint:u,setSelectedPoint:p,addBuildToList:m}=e,f=(0,b.Z)(e,ua);const g=(0,r.Wz)(),{data:x}=(0,c.useContext)(Z.R),{t:y}=(0,d.$G)("page_character_optimize"),C=(0,c.useMemo)((()=>u&&u.artifactIds&&Object.fromEntries(u.artifactIds.map((e=>{const t=g.arts.get(e);return[null==t?void 0:t.slotKey,t]})).filter((e=>e)))),[g.arts,u]),w=(0,c.useCallback)((e=>{e.target.id.includes("customShape")||e.target.id.includes("chartContainer")||p(void 0)}),[p]),B=C&&a.Ex.every((e=>{var t,n;return(null==(t=C[e])?void 0:t.id)===(null==(n=x.get(S.qH.art[e].id).value)?void 0:n.toString())})),k=(0,c.useMemo)((()=>void 0!==(null==u?void 0:u.generBuildNumber)&&`#${null==u?void 0:u.generBuildNumber}`),[u]),X=(0,c.useMemo)((()=>void 0!==(null==u?void 0:u.graphBuildNumber)&&(0,Q.BX)(d.cC,{t:y,i18nKey:"graphBuildLabel",count:null==u?void 0:u.graphBuildNumber,children:["Graph #",{count:(null==u?void 0:u.graphBuildNumber)+1}]})),[u,y]);return f.active&&u?(0,Q.tZ)(ca.d,{onClickAway:w,children:(0,Q.tZ)(Oe.Z,{sx:{minWidth:"400px",maxWidth:"400px"},onClick:e=>e.stopPropagation(),children:(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Ke.Z,{gap:1,children:[(0,Q.BX)(Ke.Z,{direction:"row",alignItems:"start",gap:1,children:[(0,Q.BX)(Ke.Z,{spacing:.5,flexGrow:99,children:[B&&(0,Q.tZ)(J.Z,{color:"info",children:(0,Q.tZ)("strong",{children:y("currentlyEquippedBuild")})}),k&&(0,Q.tZ)(J.Z,{color:"info",children:k}),X&&(0,Q.tZ)(J.Z,{color:"info",children:X}),(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{width:300,height:50}),children:(0,Q.tZ)(zi,{artifacts:Object.values(C),currentlyEquipped:B})})]}),(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1}),(0,Q.tZ)(h.Z,{onClick:()=>p(void 0)})]}),(0,Q.tZ)(Xe.ZP,{container:!0,direction:"row",spacing:.75,columns:5,children:a.Ex.map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{width:75,height:75}),children:(0,Q.tZ)(da.Z,{artifactObj:C[e],slotKey:e})})},e)))}),(0,Q.BX)(be.Z,{children:[(0,Q.tZ)("strong",{children:t}),":"," ",(0,v.EC)("%"===n?u.x/100:u.x,n)]}),(0,Q.BX)(be.Z,{children:[(0,Q.tZ)("strong",{children:i}),":"," ",(0,v.EC)("%"===l?u.y/100:u.y,l)]}),(0,Q.tZ)(nn.Z,{title:u.highlighted?y("tcGraph.buildAlreadyInList"):"",placement:"top",children:(0,Q.tZ)("span",{children:(0,Q.tZ)(W.Z,{sx:{width:"100%"},disabled:void 0!==(null==u?void 0:u.graphBuildNumber),color:"info",onClick:()=>m(u.artifactIds),children:y("addBuildToList")})})})]})})})}):null}class EnhancedPoint{constructor(e,t,n){this.x=void 0,this.trueY=void 0,this.artifactIds=void 0,this.min=void 0,this.current=void 0,this.highlighted=void 0,this.generBuildNumber=void 0,this.graphBuildNumber=void 0,this.x=e,this.trueY=t,this.artifactIds=n}get y(){return this.trueY||this.current||this.highlighted}set y(e){this.trueY=e}}let Za,pa,ma,fa,ga,xa,ba,ya=e=>e;function va({plotBase:e,setPlotBase:t,disabled:n=!1,showTooltip:i=!1}){const{t:r}=(0,d.$G)(["page_character_optimize","ui"]),{data:l}=(0,c.useContext)(Z.R),{chartData:s}=(0,c.useContext)(m.V),[u,h]=(0,c.useState)(!1),[p,f]=(0,c.useState)(!0),{graphBuilds:x}=(0,c.useContext)(m.V),{character:{key:b}}=(0,c.useContext)(g.V),{buildResult:{builds:C}}=la(b),[w,B]=(0,c.useState)(-1/0),[k,X]=(0,c.useState)(1/0),T=(0,c.useCallback)(((e,t)=>{if("number"==typeof t)throw new TypeError;const[n,i]=t;B(n),X(i)}),[B,X]);(0,c.useEffect)((()=>{B(-1/0),X(1/0)}),[s]);const{displayData:O,downloadData:E,sliderMin:j,sliderMax:I}=(0,c.useMemo)((()=>{var e,t;if(!s)return{displayData:null,downloadData:null};let n=1/0,i=-1/0;const r=a.Ex.map((e=>{var t;return null!=(t=null==l?void 0:l.get(S.qH.art[e].id).value)?t:""})),o=s.data.map((({value:e,plot:t,artifactIds:a})=>{if(void 0===t)return null;t<n&&(n=t),t>i&&(i=t);const l=new EnhancedPoint(t,e,a),s=(0,v.K8)(a,(e=>!0));r.every((e=>s[e]))&&(l.current=e,l.y=void 0);const o=null==x?void 0:x.findIndex((e=>e.every((e=>s[e]))));void 0!==o&&-1!==o&&(void 0!==l.trueY&&(l.highlighted=e,l.y=void 0),l.graphBuildNumber=o+1);const c=C.findIndex((e=>e.every((e=>s[e]))));return-1!==c&&(void 0!==l.trueY&&(l.highlighted=e,l.y=void 0),l.generBuildNumber=c+1),l})).filter((e=>null!==e)).sort(((e,t)=>e.x-t.x)),c=[];for(const a of o){let e;for(;e=c.pop();)if(e.y>a.y){c.push(e);break}c.push(a)}(null==(e=c[0])?void 0:e.x)!==(null==(t=o[0])?void 0:t.x)&&(o[0].min=c[0].y),c.forEach((e=>{e.min=e.y}));const d={minimum:c.map((e=>[e.x,e.y])),allData:o.map((e=>[e.x,e.y]))};return{displayData:o.filter((e=>e&&e.x>=w&&e.x<=k)),downloadData:d,sliderMin:n,sliderMax:i}}),[s,C,l,x,w,k]),P=e&&(0,v.Hm)(null==l?void 0:l.getDisplay(),e),M=r(e&&(!P||P.isEmpty)?"page_character_optimize:targetSelector.invalidTarget":"page_character_optimize:targetSelector.selectGraphTarget");return(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(be.Z,{children:r(Za||(Za=ya`tcGraph.vs`))})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(nn.Z,{placement:"top",title:i?r("page_character_optimize:selectTargetFirst"):"",children:(0,Q.tZ)("span",{children:(0,Q.tZ)(Ne,{optimizationTarget:e,setTarget:e=>t(e),defaultText:M,disabled:n})})})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(nn.Z,{title:e?r("ui:reset"):"",placement:"top",children:(0,Q.tZ)("span",{children:(0,Q.tZ)(W.Z,{color:"error",onClick:()=>t(void 0),disabled:!e||n,children:(0,Q.tZ)(yt.Z,{})})})})}),(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1,children:(0,Q.tZ)(je.Z,{placement:"top",title:r("page_character_optimize:tcGraph.desc")})}),!!E&&(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{size:"small",startIcon:p?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),color:p?"success":"secondary",onClick:()=>f(!p),children:r(pa||(pa=ya`tcGraph.showStatThr`))})}),!!E&&(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{size:"small",color:"info",startIcon:(0,Q.tZ)(qi.Z,{}),onClick:()=>h(!u),children:r(ma||(ma=ya`tcGraph.downloadData`))})})]})}),O&&!!O.length&&(0,Q.tZ)(De.Z,{}),s&&O&&!!O.length&&(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(wt.Z,{in:!!E&&u,children:(0,Q.tZ)(Oe.Z,{sx:{mb:2},children:(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(be.Z,{children:"Min Data"}),(0,Q.tZ)(y.TU,{value:JSON.stringify(null==E?void 0:E.minimum)}),(0,Q.tZ)(be.Z,{children:"All Data"}),(0,Q.tZ)(y.TU,{value:JSON.stringify(null==E?void 0:E.allData)})]})})}),(0,Q.tZ)(Sa,{displayData:O,plotNode:s.plotNode,valueNode:s.valueNode,showMin:p}),O.length>1&&(0,Q.tZ)(Hi.ZP,{marks:!0,value:[w,k],onChange:T,onChangeCommitted:T,min:j,max:I,step:(I-j)/20,valueLabelDisplay:"auto",valueLabelFormat:e=>{var t,n;return(0,v.EC)("%"===(null==(t=s.plotNode.info)?void 0:t.unit)?e/100:e,null==(n=s.plotNode.info)?void 0:n.unit)},sx:{ml:"6%",width:"93%"}})]})]})}const Ca="#8884d8",wa="cyan",Ba="#46a046",ka="#ff7300";function Sa({displayData:e,plotNode:t,valueNode:n,showMin:i}){var a,r,l,s;const{graphBuilds:o,setGraphBuilds:u}=(0,c.useContext)(m.V),{t:h}=(0,d.$G)("page_character_optimize"),[Z,p]=(0,c.useState)(),f=(0,c.useCallback)((e=>{u([...null!=o?o:[],e]),p(void 0)}),[u,o]),g=(0,c.useCallback)((t=>{t&&t.chartX&&t.chartY&&p(function(e,t,n,i){const a=Array.from(document.querySelectorAll(".custom-dot")).reduce(((n,i)=>{const{chartX:a,chartY:r}=n.dataset,l=Math.sqrt((e-a)**2+(t-r)**2),{chartX:s,chartY:o}=i.dataset;return l<=Math.sqrt((e-s)**2+(t-o)**2)?n:i})).dataset;return Math.sqrt((e-a.chartX)**2+(t-a.chartY)**2)<n?i.find((e=>e.x===+a.xValue&&e.y===+a.yValue)):void 0}(t.chartX,t.chartY,20,e))}),[p,e]),x=Xa(t,h),b=Xa(n,h);return(0,Q.tZ)(Ui.h,{width:"100%",height:600,children:(0,Q.BX)(Yi.c,{id:"chartContainer",data:e,onClick:g,style:{cursor:"pointer"},children:[(0,Q.tZ)(Ji.q,{strokeDasharray:"3 3"}),(0,Q.tZ)(Qi.K,{dataKey:"x",scale:"linear",unit:null==(a=t.info)?void 0:a.unit,domain:["auto","auto"],tick:{fill:"white"},type:"number",tickFormatter:e=>e>1e4?e.toFixed():e.toFixed(1),label:(0,Q.tZ)(ea._,{fill:"white",dy:10,children:x}),height:50}),(0,Q.tZ)(ta.B,{name:"DMG",domain:["auto","auto"],unit:null==(r=n.info)?void 0:r.unit,allowDecimals:!1,tick:{fill:"white"},type:"number",label:(0,Q.tZ)(ea._,{fill:"white",angle:-90,dx:-40,children:b}),width:100}),(0,Q.tZ)(na.u,{content:(0,Q.tZ)(ha,{xLabel:x,xUnit:null==(l=t.info)?void 0:l.unit,yLabel:b,yUnit:null==(s=n.info)?void 0:s.unit,selectedPoint:Z,setSelectedPoint:p,addBuildToList:f}),trigger:"click",wrapperStyle:{pointerEvents:"auto",cursor:"auto"},cursor:!1}),(0,Q.tZ)(ia.D,{payload:[...i?[{id:"min",value:h(fa||(fa=ya`tcGraph.statReqThr`)),type:"line",color:ka}]:[],{id:"trueY",value:h(ga||(ga=ya`tcGraph.generatedBuilds`)),type:"circle",color:Ca},{id:"highlighted",value:h(xa||(xa=ya`tcGraph.highlightedBuilds`)),type:"square",color:wa},{id:"current",value:h(ba||(ba=ya`tcGraph.currentBuild`)),type:"diamond",color:Ba}]}),i&&(0,Q.tZ)(aa.x,{dataKey:"min",stroke:ka,type:"stepBefore",connectNulls:!0,strokeWidth:2,isAnimationActive:!1,dot:!1,activeDot:!1}),(0,Q.tZ)(ra.b,{dataKey:"trueY",isAnimationActive:!1,shape:(0,Q.tZ)(sa,{selectedPoint:Z,colorUnselected:Ca})}),(0,Q.tZ)(ra.b,{dataKey:"highlighted",isAnimationActive:!1,shape:(0,Q.tZ)(sa,{shape:"square",selectedPoint:Z,colorUnselected:wa})}),(0,Q.tZ)(ra.b,{dataKey:"current",isAnimationActive:!1,shape:(0,Q.tZ)(sa,{shape:"diamond",selectedPoint:Z,colorUnselected:Ba})})]})})}function Xa(e,t){var n,i,a,r,l;return"string"==typeof(null==(n=e.info)?void 0:n.name)?e.info.name:`${t(`${null==(i=e.info)||null==(i=i.name)?void 0:i.props.ns}:${null==(a=e.info)||null==(a=a.name)?void 0:a.props.key18}`)}${null!=(r=e.info)&&r.textSuffix?` ${null==(l=e.info)?void 0:l.textSuffix}`:""}`}var Ta=n(22537),Oa=n(15015);let Ea,ja,Ia,Pa,Ma,Ka=e=>e;function Da({disabled:e=!1,excludedTotal:t}){const{t:n}=(0,d.$G)("page_character_optimize"),{character:{key:i}}=(0,c.useContext)(g.V),{buildSetting:{artExclusion:a,useExcludedArts:r},buildSettingDispatch:s}=An(i),[u,Z,p]=(0,y.aV)(!1),m=a.length,[f,x,b]=(0,y.aV)(!1),v=(0,c.useCallback)((e=>{s({artExclusion:[...a,e],useExcludedArts:!1})}),[s,a]),C=(0,c.useCallback)((e=>{s({artExclusion:a.filter((t=>t!==e)),useExcludedArts:!1})}),[s,a]),w=(0,c.useCallback)((()=>s({useExcludedArts:!r})),[s,r]);return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(Ie.Z,{open:u,onClose:p,containerProps:{maxWidth:"xl"},children:(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(l.Z,{display:"flex",gap:1,alignItems:"center",children:[(0,Q.tZ)(be.Z,{variant:"h6",children:n(Ea||(Ea=Ka`excludeArt.title_exclude`))}),(0,Q.tZ)(je.Z,{title:(0,Q.tZ)(be.Z,{children:n(ja||(ja=Ka`excludeArt.title_tooltip`))})}),(0,Q.tZ)(l.Z,{flexGrow:1}),(0,Q.tZ)(h.Z,{onClick:p,size:"small"})]})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(za,{show:f,onClose:b,onSelect:v,artExclusion:a}),(0,Q.tZ)(W.Z,{fullWidth:!0,onClick:x,color:"info",sx:{mb:1},startIcon:(0,Q.tZ)(he.Z,{}),children:n(Ia||(Ia=Ka`excludeArt.addExc`))}),!!m&&(0,Q.tZ)(G.Z,{sx:{mb:1},children:(0,Q.tZ)(be.Z,{textAlign:"center",children:n(Pa||(Pa=Ka`excludeArt.deSelectExc`))})}),(0,Q.tZ)(Xe.ZP,{container:!0,columns:{xs:3,md:5,lg:6,xl:8},spacing:1,children:a.map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Mi.Z,{artifactId:e,slotKey:"flower",BGComponent:G.Z,onClick:()=>C(e),showLocation:!0})},e)))})]})]})}),(0,Q.BX)(we.Z,{sx:{display:"flex",width:"100%"},children:[(0,Q.tZ)(W.Z,{onClick:w,disabled:e||!m,startIcon:r?(0,Q.tZ)(Pi.Z,{}):(0,Q.tZ)(Ii.Z,{}),color:r?"secondary":"success",sx:{flexGrow:1},children:(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(l.Z,{children:n("excludeArt.button_txt")}),(0,Q.tZ)(J.Z,{sx:{whiteSpace:"normal"},color:m?r?"warning":"primary":"secondary",children:r?(0,Q.BX)(d.cC,{t:n,i18nKey:"excludeArt.usingNum",children:["Using ",{totalStr:t}," excluded artifacts"]}):(0,Q.BX)(d.cC,{t:n,i18nKey:"excludeArt.excNum",count:m,children:[{count:m}," artifacts are excluded"]})})]})}),(0,Q.tZ)(W.Z,{color:"info",onClick:Z,disabled:e,sx:{flexShrink:1},children:(0,Q.tZ)(xe.Z,{})})]})]})}const Aa={xs:6,sm:6,md:9,lg:12,xl:12},_a=(e,t)=>Object.assign({},e,t);function za({onSelect:e,show:t,onClose:n,artExclusion:i}){const{t:a}=(0,d.$G)("page_character_optimize"),u=(0,r.Wz)(),Z=(0,c.useCallback)((t=>{e(t),n()}),[e,n]),[p,m]=(0,c.useReducer)(_a,(0,Oa.Af)()),[f,g]=(0,y.NW)();(0,c.useEffect)((()=>u.arts.followAny(g)),[u,g]);const x=(0,y.JT)(),b=(0,c.useMemo)((()=>(0,Oa.EM)()),[]),C=(0,c.useMemo)((()=>{const e=(0,v.CZ)(p,b);return f&&u.arts.values.filter(e).map((e=>e.id)).filter((e=>!i.includes(e))).slice(0,Aa[x])}),[f,u,b,p,x,i]);return(0,Q.tZ)(Ie.Z,{open:t,onClose:n,containerProps:{maxWidth:"xl"},children:(0,Q.BX)(Oe.Z,{children:[(0,Q.BX)(o.Z,{sx:{py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Q.tZ)(be.Z,{variant:"h6",children:a(Ma||(Ma=Ka`excludeArt.selExc`))}),(0,Q.tZ)(h.Z,{onClick:n})]}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,Q.tZ)(Ta.default,{filterOption:p,filterOptionDispatch:m,filteredIds:C})}),(0,Q.tZ)(l.Z,{mt:1,children:(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:300}),children:(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:C.map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Ai.Z,{artifactId:e,onClick:Z})},e)))})})})]})]})})}var Ra=n(20577),La=n(61851);const Wa=["sands","goblet","circlet"];function Va({disabled:e=!1,filteredArtIdMap:t}){const{t:n}=(0,d.$G)("artifact"),{character:{key:i}}=(0,c.useContext)(g.V),{buildSetting:{mainStatKeys:s},buildSettingDispatch:u}=An(i),h=(0,r.Wz)(),{mainStatSlotTots:Z,slotTots:p}=(0,c.useMemo)((()=>{const e={flowerMainStatTots:a.x1.flower.stats,plumeMainStatTots:a.x1.plume.stats,sandsMainStatTots:a.x1.sands.stats,gobletMainStatTots:a.x1.goblet.stats,circletMainStatTots:a.x1.circlet.stats,slotTots:Wa},n=(0,Cn.A)(e,(e=>Object.entries(h.arts.data).forEach((([n,i])=>{const{slotKey:a,mainStatKey:r}=i;Wa.includes(a)&&(e.slotTots[a].total++,t[n]&&e.slotTots[a].current++),e[`${a}MainStatTots`][r].total++,t[n]&&e[`${a}MainStatTots`][r].current++}))));return{mainStatSlotTots:{flower:n.flowerMainStatTots,plume:n.plumeMainStatTots,sands:n.sandsMainStatTots,goblet:n.gobletMainStatTots,circlet:n.circletMainStatTots},slotTots:n.slotTots}}),[h,t]);return(0,Q.BX)(l.Z,{display:"flex",flexDirection:"column",children:[(0,Q.tZ)(De.Z,{}),(0,Q.BX)(l.Z,{display:"flex",children:[(0,Q.tZ)(o.Z,{sx:{flexGrow:1},children:(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,Q.tZ)(nn.Z,{placement:"top",title:(0,Q.tZ)(be.Z,{children:n("slotName.flower")}),children:(0,Q.tZ)(N.pv,{fontSize:"inherit"})}),(0,Q.tZ)(l.Z,{flexGrow:1,children:(0,Q.BX)(J.Z,{color:"info",children:[(0,Q.tZ)(N.If,Object.assign({},$.mX))," ",Z.flower.hp]})})]})}),(0,Q.tZ)(De.Z,{orientation:"vertical",flexItem:!0}),(0,Q.tZ)(o.Z,{sx:{flexGrow:1},children:(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,Q.tZ)(nn.Z,{placement:"top",title:(0,Q.tZ)(be.Z,{children:n("slotName.plume")}),children:(0,Q.tZ)(N.QA,{fontSize:"inherit"})}),(0,Q.tZ)(l.Z,{flexGrow:1,children:(0,Q.BX)(J.Z,{color:"info",children:[(0,Q.tZ)(N._B,Object.assign({},$.mX))," ",Z.plume.atk]})})]})})]}),Wa.map((t=>{const i=s[t],r=a.x1[t].stats,c=(0,La.X)([...r]);return(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{sx:{pt:1,pb:1},children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,alignItems:"center",pb:1},children:[(0,Q.tZ)(nn.Z,{placement:"top",title:(0,Q.tZ)(be.Z,{children:n(`slotName.${t}`)}),children:(0,Q.tZ)(l.Z,{lineHeight:0,children:(0,Q.tZ)(Bn.Z,{slotKey:t,iconProps:{fontSize:"inherit"}})})}),(0,Q.tZ)(l.Z,{flexGrow:1,children:(0,Q.tZ)(J.Z,{color:"info",children:p[t]})})]}),(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,children:r.map(((n,r)=>{const l=a.fR.find((e=>n.includes(e))),o=i.includes(n)?null!=l?l:"success":"secondary";return(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1,xs:r<3&&"goblet"!==t||"goblet"===t?4:void 0,children:(0,Q.tZ)(nn.Z,{placement:"top",title:(0,Q.tZ)(be.Z,{children:(0,Q.tZ)("strong",{children:(0,Q.tZ)(Ra._,{statKey:n})})}),disableInteractive:!0,children:(0,Q.tZ)(W.Z,{fullWidth:!0,size:"small",color:o,sx:{height:"100%",pointerEvents:e?"none":void 0,cursor:e?"none":void 0},startIcon:(0,Q.tZ)(U.C,{statKey:n}),onClick:()=>u({mainStatKeys:Object.assign({},s,{[t]:c(i,n)})}),children:Z[t][n]})})},n)}))})]})]},t)}))]})}function Ga({statFilters:e,setStatFilters:t,disabled:n=!1}){const i=(0,c.useCallback)(((n,i,a)=>{var r;const l=Object.assign({},e),s=JSON.stringify(i),o=i?[...e[s]]:void 0,c=JSON.stringify(n),d=[...null!=(r=e[c])?r:[]];void 0!==a&&o?d.push(o[a]):d.push({value:0,disabled:!1}),l[c]=d,void 0!==a&&o&&(o.splice(a,1),o.length?l[s]=o:delete l[s]),t(Object.assign({},l))}),[t,e]),a=(0,c.useCallback)(((n,i)=>{const a=Object.assign({},e),r=JSON.stringify(n),l=[...e[r]];l.splice(i,1),l.length?a[r]=l:delete a[r],t(Object.assign({},a))}),[t,e]),r=(0,c.useCallback)(((n,i,a)=>{const r=Object.assign({},e),l=JSON.stringify(n),s=[...e[l]];s[i]=Object.assign({},s[i],{value:a}),r[l]=s,t(Object.assign({},r))}),[t,e]),l=(0,c.useCallback)(((n,i,a)=>{const r=Object.assign({},e),l=JSON.stringify(n),s=[...e[l]];s[i]=Object.assign({},s[i],{disabled:a}),r[l]=s,t(Object.assign({},r))}),[t,e]);return(0,Q.BX)(Q.HY,{children:[Object.entries(e).flatMap((([e,t])=>null==t?void 0:t.map(((t,s)=>(0,Q.tZ)($a,{path:JSON.parse(e),setting:t,index:s,setTarget:i,delTarget:a,setValue:r,setDisabled:l,disabled:n},e+s))))),(0,Q.tZ)($a,{setTarget:i,delTarget:a,setValue:r,setDisabled:l,disabled:n})]})}function $a({path:e,setting:t,index:n,setTarget:i,delTarget:a,setValue:r,setDisabled:l,disabled:s}){var o;const{t:u}=(0,d.$G)("page_character_optimize"),{data:h}=(0,c.useContext)(Z.R),p=(0,c.useCallback)((t=>e&&void 0!==n&&r(e,n,null!=t?t:0)),[r,e,n]),m={p:1,flexBasis:30,flexGrow:0,flexShrink:0},f=(0,T.Hm)(h.getDisplay(),null!=e?e:[]),g="%"===(null==f||null==(o=f.info)?void 0:o.unit);return(0,Q.BX)(we.Z,{sx:{"& .MuiButtonGroup-grouped":{minWidth:24},width:"100%"},children:[!!t&&!!e&&void 0!==n&&(0,Q.tZ)(W.Z,{sx:m,color:t.disabled?"secondary":"success",onClick:()=>l(e,n,!t.disabled),disabled:s,children:t.disabled?(0,Q.tZ)(Ct.Z,{}):(0,Q.tZ)(vt.Z,{})}),(0,Q.tZ)(Ne,{showEmptyTargets:!0,optimizationTarget:e,setTarget:t=>i(t,e,n),defaultText:u("targetSelector.selectBuildTarget")}),(0,Q.tZ)(Ee.CC,{sx:{flexBasis:150,flexGrow:1},children:(0,Q.tZ)(Ee.ZP,{float:!0,disabled:!e||s,value:null==t?void 0:t.value,placeholder:"Stat Value",onChange:p,sx:{px:1},inputProps:{sx:{textAlign:"right"}},endAdornment:g?"%":void 0})}),!!e&&void 0!==n&&(0,Q.tZ)(W.Z,{sx:m,color:"error",onClick:()=>a(e,n),disabled:s,children:(0,Q.tZ)(Jt.Z,{fontSize:"small"})})]})}let Na,Fa,qa=e=>e;function Ha({disabled:e=!1}){const{t}=(0,d.$G)("page_character_optimize"),{character:{key:n}}=(0,c.useContext)(g.V),{buildSetting:{statFilters:i},buildSettingDispatch:a}=An(n),r=(0,c.useCallback)((e=>a({statFilters:e})),[a]);return(0,Q.tZ)(l.Z,{children:(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between",flexDirection:"column"},children:(0,Q.BX)(l.Z,{display:"flex",justifyContent:"space-between",children:[(0,Q.tZ)(be.Z,{sx:{fontWeight:"bold"},children:t(Na||(Na=qa`constraintFilter.title`))}),(0,Q.tZ)(je.Z,{title:(0,Q.tZ)(be.Z,{children:t(Fa||(Fa=qa`constraintFilter.tooltip`))})})]})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(l.Z,{display:"flex",flexDirection:"column",gap:.5,children:(0,Q.tZ)(Ga,{statFilters:i,setStatFilters:r,disabled:e})})]})})}const Ua=(0,hn.yY)((0,v.I8)({dyn:Object.assign({},S.qH.art,S.qH.artSet)})),Ya={art:(0,v.K8)([...a.rW,...a._m],(e=>Ua.dyn[e])),artSet:(0,v.vU)(S.qH.artSet,((e,t)=>Ua.dyn[t]))};let Ja,Qa,er,tr,nr,ir,ar,rr=e=>e;const lr=new Audio("notification.mp3");function sr(){var e,t;const{t:n}=(0,d.$G)("page_character_optimize"),{teamId:i,team:{compareData:s},character:{key:u}}=(0,c.useContext)(g.V),h=(0,r.Wz)(),{setChartData:p,graphBuilds:f,setGraphBuilds:x}=(0,c.useContext)(m.V),{gender:b}=(0,r.Hz)(),[C,w]=(0,c.useState)(!1),B=(0,c.useRef)(!1);(0,c.useEffect)((()=>{B.current=C}),[C]);const[k,S]=(0,c.useState)({type:"inactive",tested:0,failed:0,skipped:0,total:0}),T="inactive"!==k.type,[O,E]=(0,y.NW)(),[{threads:I=ue.gk},P]=(0,c.useState)(h.displayOptimize.get());(0,c.useEffect)((()=>h.displayOptimize.follow(((e,t)=>P(t)))),[h,P]);const M=I>ue.gk?ue.gk:I,K=(0,c.useCallback)((e=>h.displayOptimize.set({threads:e})),[h]),A=(0,dn.Z)();(0,c.useEffect)((()=>{S({type:"inactive",tested:0,failed:0,skipped:0,total:0})}),[u]);const _=(0,c.useMemo)((()=>!h.arts.values.length),[h]),{buildSetting:z,buildSettingDispatch:R}=An(u),{plotBase:L,optimizationTarget:V,mainStatAssumptionLevel:$,allowPartial:N,maxBuildsToShow:H,levelLow:U,levelHigh:Y}=z,{buildResult:{builds:ee,buildDate:te},buildResultDispatch:ne}=la(u),re=j(i,$),{characterSheet:le,target:se}=null!=(e=null==re?void 0:re[u])?e:{},oe=V&&(0,v.Hm)(null==se?void 0:se.getDisplay(),V),he=["xs","sm"].includes((0,y.JT)());(0,c.useEffect)((()=>h.arts.followAny(E)),[E,h]);const Ze=(0,c.useDeferredValue)(O),pe=(0,c.useDeferredValue)(z),me=(0,c.useMemo)((()=>{const{mainStatKeys:e,excludedLocations:t,artExclusion:n,levelLow:i,levelHigh:r,allowLocationsState:l,useExcludedArts:s}=Ze&&pe;return h.arts.values.filter((o=>{if(!s&&n.includes(o.id))return!1;if(o.level<i)return!1;if(o.level>r)return!1;const c=e[o.slotKey];if(null!=c&&c.length&&!c.includes(o.mainStatKey))return!1;const d=(0,a.V7)(u),h="unequippedOnly"===l&&o.location&&o.location!==d,Z="customList"===l&&o.location&&o.location!==d&&t.includes(o.location);return!h&&!Z}))}),[h,u,Ze,pe]),fe=(0,c.useMemo)((()=>(0,v.K8)(me.map((({id:e})=>e)),(e=>!0))),[me]),{levelTotal:ge,allowListTotal:xe,excludedTotal:ye}=(0,c.useMemo)((()=>(0,Cn.A)({levelTotal:["in"],allowListTotal:["in"],excludedTotal:["in"]},(e=>Object.entries(h.arts.data).forEach((([t,n])=>{const{level:i,location:r}=n,{levelLow:l,levelHigh:s,excludedLocations:o,allowLocationsState:c,artExclusion:d}=Ze&&pe;i>=l&&i<=s&&(e.levelTotal.in.total++,fe[t]&&e.levelTotal.in.current++);const h=(0,a.V7)(u),Z="all"===c&&r&&r!==h,p="customList"===c&&r&&r!==h&&!o.includes(r);(Z||p)&&(e.allowListTotal.in.total++,fe[t]&&e.allowListTotal.in.current++),d.includes(t)&&(e.excludedTotal.in.total++,fe[t]&&e.excludedTotal.in.current++)}))))),[u,h.arts.data,Ze,pe,fe]),ve=(0,c.useRef)(!0);(0,c.useEffect)((()=>{const e=()=>ve.current=!0,t=()=>ve.current=!1;return window.addEventListener("focus",e),window.addEventListener("blur",t),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",t)}}),[ve]);const Ce=(0,c.useRef)((()=>{}));(0,c.useEffect)((()=>()=>Ce.current()),[]);const Be=function(){const[,e]=(0,c.useState)();return(0,c.useCallback)((t=>{e((()=>{throw t}))}),[])}(),ke=(0,c.useCallback)((async()=>{var e,t,i;const{artSetExclusion:r,plotBase:l,statFilters:s,optimizationTarget:o,mainStatAssumptionLevel:c,allowPartial:d,maxBuildsToShow:Z}=z;if(!u||!o)return;const m=function(e,t,n){const i={base:{},values:{flower:[],plume:[],goblet:[],circlet:[],sands:[]}},r=new Set;for(const l of e){const e=(0,Sn.Bv)(l.mainStatKey,l.rarity,Math.max(Math.min(t,a.F7[l.rarity]),l.level)),n={id:l.id,set:l.setKey,values:Object.assign({[l.setKey]:1,[l.mainStatKey]:l.mainStatKey.endsWith("_")?e/100:e},Object.fromEntries(l.substats.map((e=>[e.key,e.key.endsWith("_")?e.accurateValue/100:e.accurateValue]))))};delete n.values[""],i.values[l.slotKey].push(n),Object.keys(n.values).forEach((e=>r.add(e)))}if(i.base=(0,v.K8)([...r],(e=>0)),n)for(const a of Object.values(i.values))a.push({id:"",values:{}});return i}(me,c,d),f=(0,cn.VF)(h,u,c,[]);if(!f)return;const g=null==(e=(0,X.Qo)(f.teamData,b,u)[u])?void 0:e.target.data[0];if(!g)return;Object.assign(g,(0,X.b3)([g,Ya]));const x=(0,v.Hm)(null!=(t=g.display)?t:{},o);if(!x)return;const y=x,C=Object.entries(s).flatMap((([e,t])=>t.filter((e=>!e.disabled)).map((t=>{var n,i;const a=(0,v.Hm)(null!=(n=g.display)?n:{},JSON.parse(e));return{value:a,minimum:"%"===(null==(i=a.info)?void 0:i.unit)?t.value/100:t.value}})))).filter((e=>e.value&&e.minimum>-1/0));p(void 0);const w=new Promise((e=>Ce.current=e)),k=[...C.map((e=>e.value)),x],T=[...C.map((e=>e.minimum)),-1/0],O=l&&(0,v.Hm)(null!=(i=g.display)?i:{},l);O&&(k.push(O),T.push(-1/0));const E=(0,on.tL)(k,g,(({path:[e]})=>"dyn"!==e)),j=O?E.pop():void 0,I={arts:m,optimizationTarget:E.pop(),exclusion:r,constraints:E.map(((e,t)=>({value:e,min:T[t]}))),topN:Z,plotBase:j},P={tested:0,failed:0,skipped:0,total:0,startTime:performance.now()},K=setInterval((()=>S(Object.assign({type:"active"},P))),100),D=new Error;try{const e=new GOSolver(I,P,M);w.then((()=>e.cancel(D)));const t=await e.solve();if(e.cancel(),Ce.current=()=>{},O){var A,_;const e=function(e){let t=.01,n=new Set(e.flatMap((e=>Object.values(e).map((e=>Math.round(e.plot/t))))));for(;n.size>1500;)t*=2,n=new Set([...n].map((e=>Math.round(e/2))));const i={};for(const a of e)for(const e of Object.values(a)){const n=Math.round(e.plot/t)*t;(!i[n]||i[n].value<e.value)&&(i[n]=e)}return i}(t.map((e=>e.plotData)));let n=Object.values(e);"%"===(null==(A=y.info)?void 0:A.unit)&&(n=n.map((({value:e,plot:t,artifactIds:n})=>({value:100*e,plot:t,artifactIds:n})))),"%"===(null==(_=O.info)?void 0:_.unit)&&(n=n.map((({value:e,plot:t,artifactIds:n})=>({value:e,plot:100*(null!=t?t:0),artifactIds:n})))),p({valueNode:y,plotNode:O,data:n})}const i=function(e,t){return e.flatMap((e=>e)).sort(((e,t)=>t.value-e.value)).slice(0,t)}(t.map((e=>e.builds)),Z);0,ne({builds:i.map((e=>e.artifactIds)),buildDate:Date.now()}),setTimeout((()=>{t&&B.current&&(lr.play(),ve.current||setTimeout((()=>window.alert(n(Ja||(Ja=rr`buildCompleted`)))),1))}),100)}catch(R){R!==D&&(console.log("Failed to load worker"),console.log(R),R instanceof Error&&Be(R)),Ce.current(),P.tested=0,P.failed=0,P.skipped=0,P.total=0}finally{clearInterval(K),S(Object.assign({type:"inactive"},P,{finishTime:performance.now()}))}}),[z,u,me,h,b,p,M,ne,n,Be]),Se=null!=(t=null==le?void 0:le.name)?t:"Character Name",Te=(0,c.useCallback)((e=>{R({plotBase:e}),p(void 0)}),[R,p]),Oe=(0,c.useMemo)((()=>se&&re&&{data:se,teamData:re}),[se,re]),Ee=(0,Q.tZ)(Ne,{optimizationTarget:V,setTarget:e=>R({optimizationTarget:e}),disabled:!!T}),Ie=(0,c.useCallback)((e=>(0,Q.BX)(d.cC,{t:n,i18nKey:"graphBuildLabel",count:e+1,children:["Graph #",{count:e+1}]})),[n]),Pe=(0,c.useCallback)((e=>`#${e+1}`),[]);return(0,Q.BX)(l.Z,{display:"flex",flexDirection:"column",gap:1,children:[_&&(0,Q.tZ)(ln,{}),Oe&&(0,Q.BX)(Z.R.Provider,{value:Oe,children:[(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.BX)(Xe.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(an.Z,{characterKey:u,onClickTeammate:A})}),(0,Q.tZ)(ki,{})]}),(0,Q.BX)(Xe.ZP,{item:!0,xs:12,sm:6,lg:4,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.BX)(G.Z,{children:[(0,Q.BX)(o.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(be.Z,{sx:{fontWeight:"bold"},children:n(Qa||(Qa=rr`levelFilter`))}),(0,Q.tZ)(J.Z,{color:"info",children:ge.in})]}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(tn.Z,{levelLow:U,levelHigh:Y,setLow:e=>R({levelLow:e}),setHigh:e=>R({levelHigh:e}),setBoth:(e,t)=>R({levelLow:e,levelHigh:t}),disabled:T})})]}),(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(be.Z,{sx:{fontWeight:"bold"},children:n(er||(er=rr`mainStat.title`))})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{children:(0,Q.BX)(l.Z,{display:"flex",alignItems:"center",gap:1,children:[(0,Q.tZ)(Ci,{mainStatAssumptionLevel:$,setmainStatAssumptionLevel:e=>R({mainStatAssumptionLevel:e}),disabled:T}),(0,Q.tZ)(je.Z,{title:(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(be.Z,{variant:"h6",children:n(tr||(tr=rr`mainStat.levelAssTooltip.title`))}),(0,Q.tZ)(be.Z,{children:n(nr||(nr=rr`mainStat.levelAssTooltip.desc`))})]})})]})}),(0,Q.tZ)(Va,{disabled:T,filteredArtIdMap:fe})]})]}),(0,Q.BX)(Xe.ZP,{item:!0,xs:12,sm:6,lg:5,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(gi,{disabled:T}),(0,Q.tZ)(Da,{disabled:T,excludedTotal:ye.in}),(0,Q.tZ)(W.Z,{fullWidth:!0,startIcon:N?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),color:N?"success":"secondary",onClick:()=>R({allowPartial:!N}),disabled:T,children:n(ir||(ir=rr`allowPartial`))}),(0,Q.tZ)(Gn,{disabled:T,allowListTotal:xe.in}),(0,Q.tZ)(Ha,{disabled:T})]})]}),he&&Ee,(0,Q.BX)(we.Z,{children:[!he&&Ee,(0,Q.BX)(ie.Z,{disabled:T||!u,title:(0,Q.BX)(d.cC,{t:n,i18nKey:"build",count:H,children:[{count:H}," Builds"]}),children:[(0,Q.tZ)(F.Z,{children:(0,Q.tZ)(be.Z,{variant:"caption",color:"info.main",children:n("buildDropdownDesc")})}),(0,Q.tZ)(De.Z,{}),ue.sY.map((e=>(0,Q.tZ)(F.Z,{onClick:()=>R({maxBuildsToShow:e}),children:(0,Q.BX)(d.cC,{t:n,i18nKey:"build",count:e,children:[{count:e}," Builds"]})},e)))]}),(0,Q.BX)(ie.Z,{disabled:T||!u,sx:{borderRadius:"4px 0px 0px 4px"},title:(0,Q.BX)(d.cC,{t:n,i18nKey:"thread",count:M,children:[{count:M}," Threads"]}),children:[(0,Q.tZ)(F.Z,{children:(0,Q.tZ)(be.Z,{variant:"caption",color:"info.main",children:n("threadDropdownDesc")})}),(0,Q.tZ)(De.Z,{}),(0,v.w6)(1,ue.gk).reverse().map((e=>(0,Q.tZ)(F.Z,{onClick:()=>K(e),children:(0,Q.BX)(d.cC,{t:n,i18nKey:"thread",count:e,children:[{count:e}," Threads"]})},e)))]}),(0,Q.tZ)(nn.Z,{placement:"top",title:n(ar||(ar=rr`notifyTooltip`)),children:(0,Q.tZ)(W.Z,{sx:{borderRadius:0},color:"warning",onClick:()=>w((e=>!e)),children:C?(0,Q.tZ)(Qt.Z,{}):(0,Q.tZ)(en.Z,{})})}),(0,Q.tZ)(nn.Z,{placement:"top",title:V?"":n("selectTargetFirst"),children:(0,Q.tZ)("span",{children:(0,Q.tZ)(W.Z,{disabled:!u||!V||!oe||oe.isEmpty,color:T?"error":"success",onClick:T?()=>Ce.current():ke,startIcon:T?(0,Q.tZ)(Yt.Z,{}):(0,Q.tZ)(D.Z,{}),sx:{borderRadius:"0px 4px 4px 0px"},children:n(T?"generateButton.cancel":"generateButton.generateBuilds")})})})]}),!!u&&(0,Q.tZ)(Oi,{status:k,characterName:Se,maxBuildsToShow:H}),(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(va,{disabled:T||!V,plotBase:L,setPlotBase:Te,showTooltip:!V})}),(0,Q.tZ)(G.Z,{children:(0,Q.BX)(o.Z,{children:[(0,Q.BX)(l.Z,{display:"flex",alignItems:"center",gap:1,mb:1,children:[(0,Q.tZ)(be.Z,{sx:{flexGrow:1},children:ee?(0,Q.BX)("span",{children:["Showing"," ",(0,Q.tZ)("strong",{children:ee.length+(f?f.length:0)})," ","build generated for ",Se,"."," ",!!te&&(0,Q.BX)("span",{children:["Build generated on:"," ",(0,Q.tZ)("strong",{children:new Date(te).toLocaleString()})]})]}):(0,Q.tZ)("span",{children:"Select a character to generate builds."})}),(0,Q.tZ)(W.Z,{disabled:!ee.length,color:"error",onClick:()=>{x(void 0),ne({builds:[],buildDate:0})},children:"Clear Builds"})]}),(0,Q.BX)(Xe.ZP,{container:!0,display:"flex",spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(de,{size:"small"})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(ce,{size:"small"})}),(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.BX)(ae.Z,{exclusive:!0,value:s,onChange:(e,t)=>h.teams.set(i,{compareData:t}),size:"small",children:[(0,Q.tZ)(q.Z,{value:!1,disabled:!s,children:"Show new builds"}),(0,Q.tZ)(q.Z,{value:!0,disabled:s,children:"Compare vs. equipped"})]})})]})]})}),(0,Q.BX)(sn.o.Provider,{value:V,children:[f&&(0,Q.tZ)(or,{builds:f,characterKey:u,teamId:i,data:se,compareData:s,disabled:!!T,getLabel:Ie,setBuilds:x}),(0,Q.tZ)(or,{builds:ee,characterKey:u,teamId:i,data:se,compareData:s,disabled:!!T,getLabel:Pe})]})]})]})}function or({builds:e,setBuilds:t,teamId:n,characterKey:i,data:a,compareData:r,disabled:l,getLabel:o}){const d=(0,c.useCallback)((n=>{if(t){const i=[...e];i.splice(n,1),t(i)}}),[e,t]);return(0,c.useMemo)((()=>(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:600}),children:null==e?void 0:e.map(((e,s)=>i&&a&&(0,Q.tZ)(dr,{teamId:n,characterKey:i,build:e,oldData:a,children:(0,Q.tZ)(cr,{index:s,label:o(s),build:e,compareData:r,disabled:l,deleteBuild:t?d:void 0})},s+e.join())))})),[e,i,n,a,r,l,o,d,t])}function cr({index:e,label:t,build:n,compareData:i,disabled:a,deleteBuild:r}){const{t:l}=(0,d.$G)("page_character_optimize"),s=(0,u.TH)(),o=(0,u.s0)(),h=(0,c.useCallback)((()=>{const e=s.pathname.split("/");e.pop(),o(`${e.join("/")}/theorycraft`,{state:{build:n}})}),[o,n,s.pathname]);return(0,Q.tZ)(Gi,{label:t,compareBuild:i,disabled:a,extraButtonsLeft:(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"info",size:"small",startIcon:(0,Q.tZ)(A.Z,{}),onClick:h,children:l("theorycraftButton")}),r&&(0,Q.tZ)(W.Z,{color:"error",size:"small",startIcon:(0,Q.tZ)(Jt.Z,{}),onClick:()=>r(e),children:l("removeBuildButton")})]})})}function dr({children:e,teamId:t,characterKey:n,build:i,oldData:a}){const l=(0,r.Wz)(),{buildSetting:{mainStatAssumptionLevel:s}}=An(n),[o,d]=(0,y.NW)();(0,c.useEffect)((()=>l.arts.followAny((e=>i.includes(e)&&d()))),[l,i,d]);const u=j(t,s,(0,c.useMemo)((()=>o&&i.map((e=>l.arts.get(e))).filter((e=>e))),[o,i,l])),h=(0,c.useMemo)((()=>{const e=null==u?void 0:u[n];if(e)return{data:e.target,teamData:u,oldData:a}}),[u,a,n]);return h?(0,Q.tZ)(Z.R.Provider,{value:h,children:e}):null}var ur=n(21207),hr=n(10483),Zr=n(16068),pr=n(66147),mr=n(21194),fr=n(36674),gr=n(76260),xr=n(85469),br=n(49810),yr=n(47746),vr=n(86432),Cr=n(71179),wr=n(14836),Br=n(96580),kr=n(69614),Sr=n(73501),Xr=n(69409),Tr=n(51654);let Or,Er,jr,Ir,Pr,Mr,Kr,Dr=e=>e;const Ar=(0,c.lazy)((()=>Promise.resolve().then(n.bind(n,64262))));function _r(){var e;const{character:{equippedWeapon:t,key:n},characterSheet:i}=(0,c.useContext)(g.V),{teamData:s,data:o}=(0,c.useContext)(Z.R),d=null==(e=s[n])?void 0:e.weaponSheet,[u,h]=(0,c.useState)(""),p=(0,c.useCallback)((()=>h(t)),[t]),m=(0,c.useCallback)((()=>h("")),[]);(0,c.useEffect)((()=>{u&&u!==t&&h(t)}),[u,t]);const f=(0,yr.Z)(),x=(0,vr.Z)(f.breakpoints.up("lg")),b=(0,c.useMemo)((()=>d&&d.document.length>0&&(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(l.Z,{p:1,children:(0,Q.tZ)(wr.Z,{sections:d.document})})})),[d]),{rvFilter:y}=(0,r.xF)(n),v=(0,c.useDeferredValue)(y),C=(0,c.useMemo)((()=>new Set(v)),[v]);return(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(c.Suspense,{fallback:!1,children:(0,Q.tZ)(Ar,{weaponId:u,footer:!0,onClose:m,extraButtons:(0,Q.tZ)(Lr,{weaponTypeKey:i.weaponTypeKey})})}),(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[x&&(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,lg:3,xl:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[b&&b,(0,Q.tZ)(Vr,{})]}),(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,lg:9,xl:9,container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,sm:6,md:4,display:"flex",flexDirection:"column",gap:1,children:(0,Q.tZ)(Sr.Z,{weaponId:t,onEdit:p,canEquip:!0,extraButtons:(0,Q.tZ)(Rr,{weaponTypeKey:i.weaponTypeKey})})}),a.Ex.map((e=>{var t;return(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,sm:6,md:4,children:o.get(S.ri.art[e].id).value?(0,Q.tZ)(Ai.Z,{artifactId:null==(t=o.get(S.ri.art[e].id).value)?void 0:t.toString(),effFilter:C,extraButtons:(0,Q.tZ)(Wr,{slotKey:e}),editorProps:{},canEquip:!0}):(0,Q.tZ)(zr,{slotKey:e})},e)}))]}),!x&&(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,xl:3,container:!0,spacing:1,children:[b&&(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,md:6,lg:4,children:b}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,md:6,lg:4,sx:{display:"flex",flexDirection:"column",gap:1},children:(0,Q.tZ)(Vr,{})})]})]})]})}function zr({slotKey:e}){const{character:{key:t}}=(0,c.useContext)(g.V),n=(0,r.Wz)(),[i,s,u]=(0,y.aV)(),{t:h}=(0,d.$G)("artifact");return(0,Q.BX)(G.Z,{sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(be.Z,{children:[(0,Q.tZ)(Bn.Z,{iconProps:$.mX,slotKey:e})," ",h(`slotName.${e}`)]})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(l.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,Q.tZ)(Xr.Z,{slotKey:e,show:i,onClose:u,onChangeId:e=>n.arts.set(e,{location:(0,a.V7)(t)})}),(0,Q.tZ)(W.Z,{onClick:s,color:"info",sx:{borderRadius:"1em"},children:(0,Q.tZ)(xr.Z,{sx:{height:100,width:100}})})]})]})}function Rr({weaponTypeKey:e}){const{t}=(0,d.$G)("page_character"),{character:{key:n}}=(0,c.useContext)(g.V),i=(0,r.Wz)(),[l,s,o]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(Be.Z,{title:(0,Q.tZ)(be.Z,{children:t(Or||(Or=Dr`tabEquip.swapWeapon`))}),placement:"top",arrow:!0,children:(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:s,children:(0,Q.tZ)(xr.Z,{})})}),(0,Q.tZ)(Tr.Z,{weaponTypeKey:e,onChangeId:e=>i.weapons.set(e,{location:(0,a.V7)(n)}),show:l,onClose:o})]})}function Lr({weaponTypeKey:e}){const{t}=(0,d.$G)("page_character"),{character:{key:n}}=(0,c.useContext)(g.V),i=(0,r.Wz)(),[l,s,o]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"info",onClick:s,startIcon:(0,Q.tZ)(xr.Z,{}),children:t(Er||(Er=Dr`tabEquip.swapWeapon`))}),(0,Q.tZ)(Tr.Z,{weaponTypeKey:e,onChangeId:e=>i.weapons.set(e,{location:(0,a.V7)(n)}),show:l,onClose:o})]})}function Wr({slotKey:e}){const{t}=(0,d.$G)("page_character"),{character:{key:n}}=(0,c.useContext)(g.V),i=(0,r.Wz)(),[l,s,o]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(Be.Z,{title:(0,Q.tZ)(be.Z,{children:t(jr||(jr=Dr`tabEquip.swapArt`))}),placement:"top",arrow:!0,children:(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:s,children:(0,Q.tZ)(xr.Z,{})})}),(0,Q.tZ)(Xr.Z,{slotKey:e,show:l,onClose:o,onChangeId:e=>i.arts.set(e,{location:(0,a.V7)(n)})})]})}function Vr(){const{t:e}=(0,d.$G)(["page_character","artifact"]),t=(0,r.Wz)(),{character:n,character:{key:i,equippedArtifacts:s}}=(0,c.useContext)(g.V),{data:u}=(0,c.useContext)(Z.R),h=(0,c.useMemo)((()=>!!Object.values(s).filter((e=>e)).length),[s]),p=(0,c.useCallback)((()=>{n&&window.confirm("Do you want to move all currently equipped artifacts to inventory?")&&Object.values(s).forEach((e=>t.arts.set(e,{location:""})))}),[n,t,s]),m=(0,c.useMemo)((()=>(0,C.ND)(u)),[u]),{rvFilter:f}=(0,r.xF)(i),x=(0,c.useCallback)((e=>t.charMeta.set(i,{rvFilter:e})),[t,i]),[b,v,w]=(0,y.aV)(),B=(0,c.useDeferredValue)(f),{rvField:k,rvmField:S}=(0,c.useMemo)((()=>{const{currentEfficiency:n,currentEfficiency_:i,maxEfficiency:r,maxEfficiency_:l}=Object.values(s).reduce(((e,n)=>{const i=t.arts.get(n);if(i){const{currentEfficiency:t,maxEfficiency:n}=kr.Z.getArtifactEfficiency(i,new Set(B)),{currentEfficiency:r,maxEfficiency:l}=kr.Z.getArtifactEfficiency(i,new Set(a._m));e.currentEfficiency=e.currentEfficiency+t,e.maxEfficiency=e.maxEfficiency+n,e.currentEfficiency_=e.currentEfficiency_+r,e.maxEfficiency_=e.maxEfficiency_+l}return e}),{currentEfficiency:0,currentEfficiency_:0,maxEfficiency:0,maxEfficiency_:0});return{rvField:{text:e(Ir||(Ir=Dr`artifact:editor.curSubEff`)),value:n-i?(0,Q.BX)("span",{children:[(0,Q.tZ)(Br.Z,{value:n,max:4500,valid:!0})," /"," ",(0,Q.tZ)(Br.Z,{value:i,max:4500,valid:!0})]}):(0,Q.tZ)(Br.Z,{value:n,max:4500,valid:!0})},rvmField:{text:e(Pr||(Pr=Dr`artifact:editor.maxSubEff`)),canShow:()=>!!(i-l),value:r-l?(0,Q.BX)("span",{children:[(0,Q.tZ)(Br.Z,{value:r,max:4500,valid:!0})," /"," ",(0,Q.tZ)(Br.Z,{value:l,max:4500,valid:!0})]}):(0,Q.tZ)(Br.Z,{value:r,max:4500,valid:!0})}}}),[e,B,s,t]);return(0,Q.BX)(G.Z,{children:[h&&(0,Q.tZ)(W.Z,{color:"error",onClick:p,fullWidth:!0,sx:{borderBottomRightRadius:0,borderBottomLeftRadius:0},children:e(Mr||(Mr=Dr`tabEquip.unequipArts`))}),(0,Q.tZ)(l.Z,{p:1,children:(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(W.Z,{fullWidth:!0,color:"info",startIcon:(0,Q.tZ)(br.Z,{}),sx:{borderBottomLeftRadius:0,borderBottomRightRadius:0},onClick:v,children:"RV Filter"}),(0,Q.tZ)(Ie.Z,{open:b,onClose:w,children:(0,Q.tZ)(Oe.Z,{children:(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(be.Z,{textAlign:"center",gutterBottom:!0,variant:"h6",children:e(Kr||(Kr=Dr`artifact:efficiencyFilter.title`))}),(0,Q.tZ)(Cr.Z,{selectedKeys:f,onChange:x})]})})}),(0,Q.BX)(We.lD,{children:[(0,Q.tZ)(We.ms,{field:k,component:bt.ZP}),(null==S||null==S.canShow?void 0:S.canShow(u))&&(0,Q.tZ)(We.ms,{field:S,component:bt.ZP})]})]}),m&&Object.entries(m).flatMap((([e,t])=>t.map((t=>(0,Q.tZ)(Hn.Z,{setKey:e,setNumKey:t},e+t)))))]})})]})}function Gr(){const e=(0,c.useRef)(),t=(0,c.useCallback)((()=>{var t;return null==e||null==(t=e.current)||null==t.scrollIntoView?void 0:t.scrollIntoView({behavior:"smooth"})}),[e]);return(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.tZ)(l.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:8,sm:5,md:4,lg:2.3,children:(0,Q.tZ)(Nr,{})}),(0,Q.BX)(Xe.ZP,{item:!0,xs:12,sm:7,md:8,lg:9.7,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)($r,{onClick:t}),(0,Q.tZ)(G.Z,{sx:{flexGrow:1,p:1},children:(0,Q.tZ)(Ki.Z,{})})]})]})}),(0,Q.tZ)(l.Z,{ref:e,children:(0,Q.tZ)(_r,{})})]})}function $r({onClick:e}){const{character:{equippedWeapon:t}}=(0,c.useContext)(g.V),{data:n}=(0,c.useContext)(Z.R);return(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,columns:{xs:2,sm:2,md:3,lg:6,xl:6},children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Di.Z,{weaponId:t,BGComponent:G.Z,onClick:e})}),a.Ex.map((t=>{var i;return(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Mi.Z,{artifactId:null==(i=n.get(S.ri.art[t].id).value)?void 0:i.toString(),slotKey:t,BGComponent:G.Z,onClick:e})},t)}))]})}function Nr(){const{silly:e}=(0,c.useContext)(f.E),{characterSheet:t,character:{key:n}}=(0,c.useContext)(g.V),{gender:i}=(0,r.Hz)(),{data:a}=(0,c.useContext)(Z.R),s=(0,gr.Z)(n),o=(0,u.s0)(),d=a.get(S.ri.lvl).value,h=a.get(S.ri.asc).value,p=a.get(S.ri.constellation).value,m={auto:a.get(S.ri.total.auto).value,skill:a.get(S.ri.total.skill).value,burst:a.get(S.ri.total.burst).value},x={auto:a.get(S.ri.total.autoBoost).value,skill:a.get(S.ri.total.skillBoost).value,burst:a.get(S.ri.total.burstBoost).value},b=(0,hr.V)(n,i),y=(0,ur.r)(n,i);return(0,Q.BX)(G.Z,{sx:{height:"100%"},children:[e&&b?(0,Q.tZ)(Fr,{src:b,level:d,ascension:h}):(0,Q.tZ)(qr,{src:y,level:d,ascension:h}),(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(On.Z,{sx:{p:1},onClick:()=>o("talent"),children:(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,mt:-1,children:["auto","skill","burst"].map((e=>{var n;return(0,Q.tZ)(Xe.ZP,{item:!0,xs:4,children:(0,Q.tZ)(mr.Z,{badgeContent:m[e],color:x[e]?"info":"secondary",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{width:"100%",height:"100%","& > .MuiBadge-badge":{fontSize:"1.25em",padding:".25em .4em",borderRadius:".5em",lineHeight:1,height:"1.25em"}},children:(0,Q.tZ)(l.Z,{component:"img",src:null==(n=t.getTalentOfKey(e))?void 0:n.img,width:"100%",height:"auto"})})},e)}))})}),(0,Q.tZ)(be.Z,{sx:{textAlign:"center",mt:1},variant:"h6",children:t.constellationName}),(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,children:(0,T.w6)(1,6).map((e=>{var n;return(0,Q.tZ)(Xe.ZP,{item:!0,xs:4,children:(0,Q.tZ)(On.Z,{onClick:()=>s({constellation:e===p?e-1:e}),children:(0,Q.tZ)(l.Z,{component:"img",src:null==(n=t.getTalentOfKey(`constellation${e}`))?void 0:n.img,sx:Object.assign({},p>=e?{}:{filter:"brightness(50%)"}),width:"100%",height:"auto"})})},e)}))})]})]})}function Fr({src:e,level:t,ascension:n}){const{characterSheet:i}=(0,c.useContext)(g.V);return(0,Q.BX)(l.Z,{sx:{position:"relative"},children:[(0,Q.tZ)(l.Z,{src:e,component:"img",width:"100%",height:"auto"}),(0,Q.BX)(l.Z,{sx:{width:"100%",height:"100%"},children:[(0,Q.tZ)(l.Z,{sx:{opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:(0,Q.tZ)(Hr,{})}),(0,Q.tZ)(be.Z,{variant:"h6",sx:{width:"100%",opacity:.75,textAlign:"center"},children:(0,Q.tZ)(fr.q,{stars:i.rarity,colored:!0})}),(0,Q.tZ)(Yr,{}),(0,Q.tZ)(Ur,{level:t,ascension:n})]})]})}function qr({src:e,level:t,ascension:n}){const{characterSheet:i}=(0,c.useContext)(g.V);return(0,Q.BX)(l.Z,{sx:{position:"relative"},children:[(0,Q.BX)(l.Z,{sx:{position:"absolute",width:"100%",height:"100%"},children:[(0,Q.tZ)(be.Z,{variant:"h6",sx:{position:"absolute",width:"100%",left:"50%",bottom:0,transform:"translate(-50%, -50%)",opacity:.75,textAlign:"center"},children:(0,Q.tZ)(fr.q,{stars:i.rarity,colored:!0})}),(0,Q.tZ)(l.Z,{sx:{position:"absolute",left:"50%",bottom:"7%",transform:"translate(-50%, -50%)",opacity:.85,width:"100%",display:"flex",justifyContent:"center",px:1},children:(0,Q.tZ)(Hr,{})}),(0,Q.tZ)(Yr,{}),(0,Q.tZ)(Ur,{level:t,ascension:n})]}),(0,Q.tZ)(l.Z,{src:e,component:"img",width:"100%",height:"auto"})]})}function Hr(){var e;const{characterSheet:t}=(0,c.useContext)(g.V),n=t.elementKey;return(0,Q.tZ)(Ce.Z,{color:n,sx:{height:"auto"},label:(0,Q.BX)(be.Z,{variant:"h6",sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,Q.tZ)(U.Z,{ele:n}),(0,Q.tZ)(l.Z,{sx:{whiteSpace:"normal",textAlign:"center"},children:t.name}),(0,Q.tZ)(Ae.Z,{src:null==(e=kn.CL.weaponTypes)?void 0:e[t.weaponTypeKey]})]})})}function Ur({level:e,ascension:t}){return(0,Q.tZ)(be.Z,{sx:{p:1,position:"absolute",right:0,top:0,opacity:.8},children:(0,Q.tZ)(J.Z,{children:(0,Sn.wQ)(e,t)})})}function Yr(){const{character:{key:e}}=(0,c.useContext)(g.V),t=(0,r.Wz)(),{favorite:n}=(0,r.xF)(e);return(0,Q.tZ)(l.Z,{sx:{position:"absolute",left:0,top:0},children:(0,Q.tZ)(Bt.Z,{sx:{p:1},color:"error",onClick:()=>t.charMeta.set(e,{favorite:!n}),children:n?(0,Q.tZ)(Zr.Z,{}):(0,Q.tZ)(pr.Z,{})})})}const Jr={xs:12,sm:6,md:4};function Qr(){const{t:e}=(0,d.$G)("sheet_gen"),{character:t,characterSheet:n}=(0,c.useContext)(g.V),{data:i}=(0,c.useContext)(Z.R),r=(0,gr.Z)(t.key),s=[["auto",e("talents.auto")],["skill",e("talents.skill")],["burst",e("talents.burst")]],o=[["passive1",e("unlockPassive1"),1],["passive2",e("unlockPassive2"),4],["passive3",e("unlockPassive3"),0]],u=i.get(S.ri.asc).value,h=i.get(S.ri.constellation).value,p=(0,yr.Z)(),m=(0,vr.Z)(p.breakpoints.up("lg")),f=(0,c.useMemo)((()=>(0,T.w6)(1,a.o9).map((t=>(0,Q.tZ)(tl,{talentKey:`constellation${t}`,subtitle:e("constellationLvl",{level:t}),onClickTitle:()=>r({constellation:t===h?t-1:t})})))),[e,h,r]),x=(0,Q.tZ)(ie.Z,{fullWidth:!0,title:e("constellationLvl",{level:h}),color:"primary",sx:{borderRadius:0},children:(0,T.w6)(0,a.o9).map((t=>(0,Q.tZ)(F.Z,{selected:h===t,disabled:h===t,onClick:()=>r({constellation:t}),children:e("constellationLvl",{level:t})},t)))});return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(el,{}),(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[m&&(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)(G.Z,{children:x}),f.map(((e,t)=>(0,Q.tZ)(l.Z,{sx:{opacity:h>=t+1?1:.5},children:e},t)))]}),(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:[s.map((([e,t])=>(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},Jr,{children:(0,Q.tZ)(tl,{talentKey:e,subtitle:t})}),e))),!!n.getTalentOfKey("sprint")&&(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},Jr,{children:(0,Q.tZ)(tl,{talentKey:"sprint",subtitle:e("talents.altSprint")})})),!!n.getTalentOfKey("passive")&&(0,Q.tZ)(Xe.ZP,Object.assign({item:!0},Jr,{children:(0,Q.tZ)(tl,{talentKey:"passive",subtitle:"Passive"})})),o.map((([e,t,i])=>{const a=u>=i;return n.getTalentOfKey(e)?(0,Q.tZ)(Xe.ZP,Object.assign({item:!0,style:{opacity:a?1:.5}},Jr,{children:(0,Q.tZ)(tl,{talentKey:e,subtitle:t})}),e):null}))]}),!m&&(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,children:(0,Q.tZ)(G.Z,{children:x})}),f.map(((e,t)=>(0,Q.tZ)(Xe.ZP,Object.assign({item:!0,sx:{opacity:h>=t+1?1:.5}},Jr,{children:e}),t)))]})]})]})}function el(){const{data:e}=(0,c.useContext)(Z.R),t=e.getDisplay().reaction;return(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(Xe.ZP,{container:!0,spacing:1,children:Object.entries(t).filter((([e,t])=>!t.isEmpty)).map((([e,t])=>(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(Oe.Z,{children:(0,Q.tZ)(o.Z,{sx:{p:1,"&:last-child":{pb:1}},children:(0,Q.tZ)(We.JW,{node:t})})})},e)))})})})}function tl({talentKey:e,subtitle:t,onClickTitle:n}){const{t:i}=(0,d.$G)("sheet_gen"),{character:{talent:r,key:s},characterSheet:u}=(0,c.useContext)(g.V),{data:h}=(0,c.useContext)(Z.R),p=(0,gr.Z)(s),m=(0,c.useCallback)((e=>(0,Q.tZ)(On.Z,{onClick:n,children:e})),[n]),f=(0,c.useCallback)(((e,t)=>p({talent:Object.assign({},r,{[e]:t})})),[r,p]);let x=null;if(e in r){const t=h.get(S.ri.total[`${e}Boost`]).value,n=h.get(S.ri.total[e]).value,l=h.get(S.ri.asc).value;x=(0,Q.tZ)(ie.Z,{fullWidth:!0,title:i("talentLvl",{level:n}),color:t?"info":"primary",sx:{borderRadius:0},children:(0,T.w6)(1,a.zK[l]).map((n=>(0,Q.tZ)(F.Z,{selected:r[e]===n,disabled:r[e]===n,onClick:()=>f(e,n),children:i("talentLvl",{level:n+t})},n)))})}const b=u.getTalentOfKey(e);return(0,Q.BX)(G.Z,{sx:{height:"100%"},children:[x,(0,Q.BX)(o.Z,{children:[(0,Q.tZ)(jn.Z,{condition:!!n,wrapper:m,children:(0,Q.BX)(Xe.ZP,{container:!0,sx:{flexWrap:"nowrap"},children:[(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(l.Z,{component:"img",src:null==b?void 0:b.img,sx:{width:60,height:"auto"}})}),(0,Q.BX)(Xe.ZP,{item:!0,flexGrow:1,sx:{pl:1},children:[(0,Q.tZ)(be.Z,{variant:"h6",children:null==b?void 0:b.name}),(0,Q.tZ)(be.Z,{variant:"subtitle1",children:t})]})]})}),null!=b&&b.sections?(0,Q.tZ)(wr.Z,{sections:b.sections,hideDesc:!0,hideHeader:t=>{var n;const i=null==(n=t.header)?void 0:n.action;if(i&&"string"!=typeof i){return i.props.children.props.key18.includes(e)}return!1}}):null]})]})}n(75958);var nl=n(80680);let il,al=e=>e;function rl(){return(0,Q.tZ)(l.Z,{display:"flex",flexDirection:"column",gap:1,alignItems:"stretch",children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.BX)(Xe.ZP,{item:!0,xs:12,md:6,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)(ll,{}),(0,Q.tZ)(sl,{})]}),(0,v.w6)(0,2).map((e=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,Q.tZ)(ol,{index:e})},e)))]})})}function ll(){var e,t,n;const{data:i,oldData:a}=(0,c.useContext)(Z.R),r=i.getTeamBuff(),l=[];return Object.entries(null!=(e=r.total)?e:{}).forEach((([e,t])=>!t.isEmpty&&0!==t.value&&l.push([["total",e],t]))),Object.entries(null!=(t=r.premod)?t:{}).forEach((([e,t])=>!t.isEmpty&&0!==t.value&&l.push([["premod",e],t]))),Object.entries(null!=(n=r.enemy)?n:{}).forEach((([e,t])=>!t.isEmpty&&"number"==typeof t.value&&0!==t.value&&l.push([["enemy",e],t]))),l.length?(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(be.Z,{children:"Team Buffs"})}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(Xe.ZP,{container:!0,children:l.map((([e,t])=>{var n;return t&&(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,children:(0,Q.tZ)(We.JW,{node:t,oldValue:null==(n=(0,T.Hm)(null==a?void 0:a.getTeamBuff(),e))?void 0:n.value})},JSON.stringify(t.info))}))})})]}):null}function sl(){const{t:e}=(0,d.$G)("page_character"),{data:t}=(0,c.useContext)(Z.R),{team:{characterIds:n}}=(0,c.useContext)(g.V),i=n.reduce(((e,t)=>e+(t?1:0)),1);return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(Re.Z,{title:(0,Q.BX)("span",{children:[e("tabTeambuff.team_reso")," ",(0,Q.tZ)("strong",{children:(0,Q.BX)(Y.Z,{color:i>=4?"success":"warning",children:["(",i,"/4)"]})})," ",(0,Q.tZ)(je.L,{title:(0,Q.tZ)(be.Z,{children:e(il||(il=al`tabTeambuff.resonance_tip`))})})]}),titleTypographyProps:{variant:"subtitle2"}})}),w.J.map(((e,n)=>(0,Q.BX)(G.Z,{sx:{opacity:e.canShow(t)?1:.5},children:[(0,Q.tZ)(Re.Z,{title:(0,Q.BX)("span",{children:[e.name," ",(0,Q.tZ)(je.L,{title:(0,Q.tZ)(be.Z,{children:e.desc})})]}),action:e.icon,titleTypographyProps:{variant:"subtitle2"}}),e.canShow(t)&&(0,Q.tZ)(De.Z,{}),e.canShow(t)&&(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(wr.Z,{sections:e.sections,teamBuffOnly:!0,hideDesc:!0})})]},n)))]})}function ol({index:e}){const{teamData:t}=(0,c.useContext)(Z.R),{t:n}=(0,d.$G)("page_character"),{teamId:i,team:a}=(0,c.useContext)(g.V),l=a.characterIds[e+1],s=(0,r.rX)(l),o=null==s?void 0:s.key,u=(0,r.AU)(o),h=(0,dn.Z)(),p=t[o],m=(0,c.useMemo)((()=>p&&{teamId:i,team:a,teamCharId:l,teamChar:s,character:u,characterSheet:p.characterSheet}),[i,a,l,s,u,p]),f=(0,c.useMemo)((()=>p&&{data:p.target,teamData:t}),[p,t]);return(0,Q.tZ)(G.Z,{sx:{overflow:"visible"},children:o&&m&&(0,Q.tZ)(g.V.Provider,{value:m,children:f&&(0,Q.tZ)(Z.R.Provider,{value:f,children:(0,Q.tZ)(an.Z,{characterKey:o,onClickHeader:h,artifactChildren:(0,Q.tZ)(g.V.Provider,{value:m,children:(0,Q.tZ)(Z.R.Provider,{value:f,children:(0,Q.tZ)(cl,{})})}),weaponChildren:(0,Q.tZ)(g.V.Provider,{value:m,children:(0,Q.tZ)(Z.R.Provider,{value:f,children:(0,Q.tZ)(dl,{})})}),characterChildren:(0,Q.tZ)(g.V.Provider,{value:m,children:(0,Q.tZ)(Z.R.Provider,{value:f,children:(0,Q.tZ)(ul,{})})}),isTeammateCard:!0})})})})}function cl(){const{data:e}=(0,c.useContext)(Z.R),t=(0,c.useMemo)((()=>Object.entries((0,C.ND)(e)).flatMap((([e,t])=>t.flatMap((t=>{var n;return null!=(n=(0,C.Sk)(e).setEffectDocument(t))?n:[]}))))),[e]);return t?(0,Q.tZ)(wr.Z,{sections:t,teamBuffOnly:!0}):null}function dl(){const{character:{key:e}}=(0,c.useContext)(g.V),{teamData:t}=(0,c.useContext)(Z.R),n=t[e].weaponSheet;return n.document?(0,Q.tZ)(wr.Z,{sections:n.document,teamBuffOnly:!0}):null}function ul(){const{character:{key:e}}=(0,c.useContext)(g.V),{teamData:t}=(0,c.useContext)(Z.R),n=t[e].characterSheet,i=Object.values(n.talent).flatMap((e=>e.sections));return i?(0,Q.tZ)(wr.Z,{sections:i,teamBuffOnly:!0}):null}var hl=n(98885),Zl=n(71076),pl=n(97183),ml=n(83517),fl=n(92679),gl=n(13091),xl=n(35936),bl=n(6060),yl=n(15694),vl=n(5971),Cl=n(6480),wl=n(7794);const Bl=(0,c.createContext)({});function kl({slotKey:e,disabled:t=!1}){var n;const{charTC:{artifact:{slots:i}},setCharTC:r}=(0,c.useContext)(Bl),{level:s,statKey:o,rarity:d}=i[e],u=a.yh[e],h=(0,c.useCallback)((t=>{r((n=>{const i=n.artifact.slots[e];n.artifact.slots[e]=Object.assign({},i,t)}))}),[r,e]),Z=(0,c.useCallback)((e=>{var t;const n=null!=(t=a.F7[e])?t:0;h(s>n?{rarity:e,level:n}:{rarity:e})}),[s,h]);return(0,Q.BX)(l.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,Q.tZ)(Bn.Z,{slotKey:e}),(0,Q.tZ)(Oe.Z,{sx:{height:"100%",minWidth:"5em",flexGrow:1,display:"flex"},children:1===u.length?(0,Q.BX)(l.Z,{p:1,justifyContent:"center",alignItems:"center",width:"100%",display:"flex",gap:1,children:[(0,Q.tZ)(U.C,{statKey:u[0],iconProps:$.mX})," ",gt.d4.getStr(u[0])]}):(0,Q.tZ)(ie.Z,{sx:{px:0},fullWidth:!0,title:(0,Q.tZ)(Ra.x,{statKey:o}),color:null!=(n=gt.d4.getVariant(o))?n:"success",disabled:t,children:u.map((e=>(0,Q.tZ)(F.Z,{disabled:o===e,onClick:()=>h({statKey:e}),children:(0,Q.tZ)(Ra._,{statKey:e})},e)))})}),(0,Q.tZ)(ie.Z,{sx:{px:0},title:(0,Q.BX)(l.Z,{sx:{display:"flex",alignItems:"center"},children:[d," ",(0,Q.tZ)(qn.Z,{fontSize:"inherit"})]}),disabled:t,children:[5,4,3].map((e=>(0,Q.tZ)(F.Z,{disabled:d===e,onClick:()=>Z(e),children:(0,Q.BX)(l.Z,{sx:{display:"flex",alignItems:"center"},children:[e," ",(0,Q.tZ)(qn.Z,{fontSize:"inherit"})]})},e)))}),(0,Q.tZ)(Ee.ZP,{startAdornment:"+",value:s,color:kr.Z.levelVariant(s),onChange:e=>void 0!==e&&h({level:e}),sx:{borderRadius:1,pl:1,my:0,height:"100%"},inputProps:{sx:{pl:.5,width:"2em"},max:20,min:0},disabled:t}),(0,Q.tZ)(Oe.Z,{sx:{height:"100%",minWidth:"4em"},children:(0,Q.tZ)(l.Z,{p:1,textAlign:"center",children:`${(0,Sn.Jj)((0,Sn.Bv)(o,d,s),gt.d4.unit(o))}${gt.d4.unit(o)}`})})]})}var Sl=n(47712),Xl=n(54675),Tl=n(69208);function Ol(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function El({setKey:e,remaining:t,disabled:n=!1}){const{charTC:{artifact:{sets:i}},setCharTC:a}=(0,c.useContext)(Bl),r=i[e],s=(0,c.useCallback)((t=>{a((n=>{n.artifact.sets[e]=t}))}),[a,e]),o=(0,c.useCallback)((()=>{a((t=>{const n=t.artifact.sets,i=(0,b.Z)(n,[e].map(Ol));t.artifact.sets=i}))}),[a,e]),d=(0,C.Sk)(e),u=(0,c.useMemo)((()=>r<4?[]:Object.keys(d.setEffects).filter((e=>{var t;return null==(t=d.setEffects[e])?void 0:t.document.some((e=>"states"in e))}))),[d,r]);return(0,Q.BX)(G.Z,{children:[(0,Q.BX)(l.Z,{display:"flex",children:[(0,Q.tZ)(_i.Z,{artifactSheet:d,numInSet:r,children:(0,Q.BX)(l.Z,{flexGrow:1,p:1,display:"flex",gap:1,alignItems:"center",children:[(0,Q.tZ)(Ae.Z,{size:2,src:(0,Yn.jU)(e)}),(0,Q.tZ)(l.Z,{children:d.setName}),(0,Q.tZ)(Tl.Z,Object.assign({},$.mX))]})}),(0,Q.BX)(we.Z,{children:[(0,Q.tZ)(ie.Z,{size:"small",title:(0,Q.BX)(l.Z,{whiteSpace:"nowrap",children:[r,"-set"]}),disabled:n,children:Object.keys(d.setEffects).map((e=>parseInt(e))).map((e=>(0,Q.BX)(F.Z,{disabled:r===e||e>t+r,onClick:()=>s(e),children:[e,"-set"]},e)))}),(0,Q.tZ)(W.Z,{color:"error",size:"small",onClick:o,disabled:n,children:(0,Q.tZ)(Xl.Z,{})})]})]}),!!u.length&&(0,Q.tZ)(Ke.Z,{spacing:1,sx:{p:1},children:u.map((t=>(0,Q.tZ)(Hn.Z,{setKey:e,setNumKey:parseInt(t),hideHeader:!0,conditionalsOnly:!0,disabled:n},t)))})]})}function jl({disabled:e=!1}){const{charTC:{artifact:{sets:t}},setCharTC:n}=(0,c.useContext)(Bl),i=(0,c.useCallback)((e=>{e&&n((t=>{t.artifact.sets[e]=parseInt(Object.keys((0,C.Sk)(e).setEffects)[0])}))}),[n]),a=5-Object.values(t).reduce(((e,t)=>e+t),0);return(0,Q.BX)(Ke.Z,{spacing:1,sx:{flexGrow:1},children:[Object.keys(t).map((t=>(0,Q.tZ)(El,{setKey:t,remaining:a,disabled:e},t))),(0,Q.tZ)(G.Z,{sx:{flexGrow:1,overflow:"visible"},children:(0,Q.tZ)(Sl.Z,{artSetKey:"",setArtSetKey:i,label:"New Artifact Set",getOptionDisabled:({key:e})=>Object.keys(t).includes(e)||!e||Object.keys((0,C.Sk)(e).setEffects).every((e=>parseInt(e)>a)),disabled:e})})]})}function Il({disabled:e=!1}){return(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.tZ)(G.Z,{sx:{p:1},children:(0,Q.tZ)(Ke.Z,{spacing:1,children:a.Ex.map((t=>(0,Q.tZ)(kl,{slotKey:t,disabled:e},t)))})}),(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:200}),children:(0,Q.tZ)(jl,{disabled:e})})]})}var Pl=n(8660);let Ml,Kl,Dl=e=>e;function Al(e){const{artifact:{substats:{stats:t,rarity:n,type:i}}}=e;return Math.floor(Math.min(...Object.entries(t).map((([e,t])=>t/(0,Sn.U9)(e,n,i)))))}function _l(e){return Math.floor(Math.min(...Object.values(e.optimization.maxSubstats)))}function zl({disabled:e=!1}){const{t}=(0,d.$G)("page_character"),{charTC:n,setCharTC:r}=(0,c.useContext)(Bl),[s,o]=(0,c.useState)((()=>[Al(n)])),[u,h]=(0,c.useState)((()=>[_l(n)])),[Z]=s,[p]=u,m=(0,c.useDeferredValue)(s),f=(0,i.z9)();(0,c.useEffect)((()=>{f||r((e=>{const{artifact:{substats:{stats:t,type:n,rarity:i}}}=e;e.artifact.substats.stats=(0,v.vU)(t,((t,a)=>{const r=t,l=(0,Sn.U9)(a,i,n),s=l*m[0],o=Math.round(r/l-m[0]);return e.optimization.distributedSubstats=(0,v.re)(e.optimization.distributedSubstats+o,0,45),s}))}))}),[r,m]);const g=(0,c.useDeferredValue)(u);(0,c.useEffect)((()=>{f||r((e=>{e.optimization.maxSubstats=(0,v.vU)(e.optimization.maxSubstats,((e,t)=>g[0]))}))}),[r,g]);const x=5*(a.i0[n.artifact.substats.rarity].numUpgrades+1),b=(null!=Z?Z:-1e-4)>x;return(0,Q.BX)(l.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,Q.tZ)(Oe.Z,{sx:{px:2,flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center",overflow:"visible"},children:(0,Q.tZ)(Hi.ZP,{size:"small",value:null!=Z?Z:0,max:x,min:0,step:1,marks:!0,valueLabelDisplay:"auto",onChange:(e,t)=>o([t]),onChangeCommitted:(e,t)=>o([t]),disabled:e})}),(0,Q.tZ)(Ee.ZP,{color:Z&&b?"warning":"primary",float:!0,startAdornment:(0,Q.tZ)(l.Z,{sx:{whiteSpace:"nowrap"},children:t(Ml||(Ml=Dl`tabTheorycraft.all.rolls`))}),value:parseFloat((null!=Z?Z:0).toFixed(2)),onChange:e=>void 0!==e&&o([e]),sx:{borderRadius:1,px:1,my:0,height:"100%",width:"7em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1},disabled:e}),(0,Q.tZ)(Ee.ZP,{value:null!=p?p:0,startAdornment:(0,Q.tZ)(l.Z,{sx:{whiteSpace:"nowrap"},children:t(Kl||(Kl=Dl`tabTheorycraft.all.max`))}),onChange:e=>void 0!==e&&h([e]),color:(null!=p?p:0)>x?"warning":"primary",sx:{borderRadius:1,px:1,my:0,height:"100%",width:"6.5em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1},disabled:e})]})}let Rl,Ll=e=>e;function Wl({statKey:e,disabled:t=!1}){const{t:n}=(0,d.$G)("page_character"),{charTC:{artifact:{slots:r,substats:{type:s,stats:o,rarity:u}},optimization:{maxSubstats:h}},setCharTC:Z}=(0,c.useContext)(Bl),p=Object.values(r).map((e=>e.statKey)),m=o[e],f=(0,c.useCallback)((t=>{Z((n=>{const i=n.artifact.substats.stats[e];n.artifact.substats.stats[e]=t;const a=Math.round((i-t)/(0,Sn.U9)(e,n.artifact.substats.rarity,n.artifact.substats.type));n.optimization.distributedSubstats=(0,v.re)(n.optimization.distributedSubstats+a,0,45)}))}),[Z,e]),g=h[e],x=(0,c.useCallback)((t=>{Z((n=>{n.optimization.maxSubstats[e]=t}))}),[Z,e]),b=(0,Sn.U9)(e,u,s),[y,C]=(0,c.useState)((()=>m/b));(0,c.useEffect)((()=>C(m/b)),[m,b]);const w=gt.d4.unit(e),B=y*b,k=y*b/(0,Sn.U9)(e)*100,S=p.reduce(((t,n)=>t+(n===e?1:0)),0),X=(5-S)*(a.F7[u]/4+1),T=y-1e-4>X,O=(0,c.useCallback)((e=>f(e*b)),[f,b]);return(0,Q.BX)(Ke.Z,{spacing:.5,children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,Q.tZ)(Ee.ZP,{color:B?"success":"primary",float:"%"===gt.d4.unit(e),endAdornment:gt.d4.unit(e)||(0,Q.tZ)(l.Z,{width:"1em",component:"span"}),value:parseFloat(B.toFixed(2)),onChange:e=>void 0!==e&&f(e),sx:{borderRadius:1,px:1,height:"100%",width:"5em"},inputProps:{sx:{textAlign:"right"},min:0},disabled:t}),(0,Q.BX)(i.s8,{sx:{p:.5,minWidth:"11em",flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center"},children:[(0,Q.tZ)(U.C,{statKey:e,iconProps:{fontSize:"inherit"}}),gt.d4.getStr(e),gt.d4.unit(e)]}),(0,Q.tZ)(Ee.ZP,{color:m?T?"warning":"success":"primary",float:!0,startAdornment:(0,Q.BX)(l.Z,{sx:{whiteSpace:"nowrap",width:"6em",display:"flex",justifyContent:"space-between"},children:[(0,Q.BX)("span",{children:[(0,Sn.Jj)(b,w),w]}),(0,Q.tZ)("span",{children:"x"})]}),value:parseFloat(y.toFixed(2)),onChange:e=>void 0!==e&&f(e*b),sx:{borderRadius:1,px:1,my:0,height:"100%",width:"6.5em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1},disabled:t}),(0,Q.tZ)(i.s8,{sx:{textAlign:"center",p:.5,minWidth:"6em"},children:(0,Q.BX)(i._w,{color:T?"warning":void 0,children:["RV: ",(0,Q.BX)("strong",{children:[k.toFixed(),"%"]}),(0,Q.tZ)(i.eN,{title:(0,Q.tZ)(be.Z,{children:n(S?"tabTheorycraft.maxRollsMain":"tabTheorycraft.maxRolls",{value:X})}),placement:"top",children:(0,Q.tZ)(Tl.Z,{fontSize:"inherit",sx:{verticalAlign:"-10%"}})})]})})]}),(0,Q.BX)(l.Z,{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center",children:[(0,Q.tZ)(i.s8,{sx:{px:2,flexGrow:1,display:"flex",gap:1,alignItems:"center",justifyContent:"center",overflow:"visible"},children:(0,Q.tZ)(Hi.ZP,{size:"small",value:y,max:Math.min(X,g),min:0,step:1,marks:!0,valueLabelDisplay:"auto",onChange:(e,t)=>C(t),onChangeCommitted:(e,t)=>O(t),disabled:t})}),(0,Q.tZ)(Ee.ZP,{value:g,startAdornment:n(Rl||(Rl=Ll`tabTheorycraft.substat.max`)),onChange:e=>void 0!==e&&x(e),color:y-1e-4>g?"error":g>X?"warning":"success",sx:{borderRadius:1,px:1,my:0,height:"100%",width:"6em"},inputProps:{sx:{textAlign:"right",pr:.5},min:0,step:1},disabled:t})]})]})}function Vl({maxTotalRolls:e,disabled:t=!1}){const{t:n}=(0,d.$G)("page_character"),{charTC:{artifact:{substats:{type:r,stats:s,rarity:o}}},setCharTC:u}=(0,c.useContext)(Bl),h=(0,c.useCallback)((e=>{u((t=>{t.artifact.substats.type=e}))}),[u]),Z=(0,c.useCallback)((e=>{u((t=>{t.artifact.substats.rarity=e}))}),[u]),p=100*Object.entries(s).reduce(((e,[t,n])=>e+n/(0,Sn.U9)(t)),0),m=Object.entries(s).reduce(((e,[t,n])=>e+n/(0,Sn.U9)(t,o,r)),0),{high:f,numUpgrades:g}=a.i0[o],x=5*(f+g);return(0,Q.tZ)(i.s8,{bgt:"light",sx:{p:1,height:"100%"},children:(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(i.PS,{sx:{flexGrow:1},title:n(`tabTheorycraft.substatType.${r}`),disabled:t,children:a.Ar.map((e=>(0,Q.tZ)(F.Z,{disabled:r===e,onClick:()=>h(e),children:n(`tabTheorycraft.substatType.${e}`)},e)))}),(0,Q.tZ)(Pl.Z,{rarity:o,onChange:e=>Z(e),filter:e=>e!==o,disabled:t}),(0,Q.tZ)(i.eN,{title:(0,Q.tZ)(be.Z,{children:(0,Q.BX)(d.cC,{t:n,i18nKey:"tabTheorycraft.maxTotalRolls",children:["The current build can only have a maximum of ",(0,Q.tZ)("strong",{children:{value:e}})," rolls."]})}),placement:"top",children:(0,Q.BX)(i.s8,{sx:{textAlign:"center",py:.5,px:1,whiteSpace:"nowrap",display:"flex",gap:2,justifyContent:"flex-end",alignItems:"center",flexShrink:1},children:[(0,Q.BX)(i._w,{color:m>x?"error":void 0,children:["Rolls: ",(0,Q.tZ)("strong",{children:m.toFixed(0)})]}),(0,Q.BX)(i._w,{color:m>x?"error":void 0,children:["RV: ",(0,Q.BX)("strong",{children:[p.toFixed(),"%"]})]})]})})]}),(0,Q.tZ)(zl,{disabled:t}),Object.entries(s).map((([e])=>(0,Q.tZ)(Wl,{statKey:e,disabled:t},e)))]})})}var Gl=n(83993),$l=n(82056);let Nl,Fl,ql=e=>e;function Hl({disabled:e}){const{t}=(0,d.$G)("page_character"),{charTC:{optimization:{minTotal:n}},setCharTC:a}=(0,c.useContext)(Bl);return(0,Q.BX)(i.s8,{bgt:"light",children:[(0,Q.tZ)(Re.Z,{titleTypographyProps:{variant:"body1",sx:{fontWeight:"bold"}},title:t(Nl||(Nl=ql`tabTheorycraft.constraint.title`))}),(0,Q.tZ)(De.Z,{}),(0,Q.tZ)(l.Z,{sx:{p:1},children:(0,Q.BX)(Ke.Z,{spacing:1,children:[Object.entries(n).map((([t,n])=>(0,Q.tZ)(Ul,{statKey:t,value:n,disabled:e},t))),(0,Q.tZ)(i.PS,{disabled:e,title:t(Fl||(Fl=ql`tabTheorycraft.constraint.add`)),children:ue.t1.map((e=>(0,Q.BX)(F.Z,{disabled:Object.keys(n).includes(e),onClick:()=>a((t=>{t.optimization.minTotal[e]=0})),children:[(0,Q.tZ)(Gl.Z,{children:(0,Q.tZ)(N.ej,{statKey:e})}),(0,Q.tZ)($l.Z,{children:(0,Q.tZ)(Cl.w0,{statKey:e})})]},e)))})]})})]})}function Ul({statKey:e,value:t,disabled:n}){const{setCharTC:a}=(0,c.useContext)(Bl),r=(0,v.bf)(e)||" ";return(0,Q.BX)(we.Z,{size:"small",children:[(0,Q.tZ)(i.CC,{sx:{flexBasis:30,flexGrow:1},children:(0,Q.tZ)(i.aJ,{float:"%"===r,value:e?t:void 0,onChange:t=>e&&a((n=>{n.optimization.minTotal[e]=t})),endAdornment:(0,Q.tZ)(l.Z,{width:"1em",component:"span",children:r}),startAdornment:(0,Q.BX)(l.Z,{component:"span",sx:{whiteSpace:"nowrap"},children:[(0,Q.tZ)(N.ej,{statKey:e,iconProps:{fontSize:"inherit",sx:{verticalAlign:"-10%",mr:1}}}),(0,Q.tZ)(Cl.w0,{statKey:e})]}),disabled:!e||n,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!e&&(0,Q.tZ)(W.Z,{color:"error",disabled:n,size:"small",onClick:()=>a((t=>{delete t.optimization.minTotal[e]})),children:(0,Q.tZ)(Xl.Z,{})})]})}const Yl=n.p+"gcsim.5cadfd805391f327.png",Jl={def_:"def%",def:"def",hp:"hp",hp_:"hp%",atk:"atk",atk_:"atk%",enerRech_:"er",eleMas:"em",critRate_:"cr",critDMG_:"cd",heal_:"heal",pyro_dmg_:"pyro%",hydro_dmg_:"hydro%",cryo_dmg_:"cryo%",electro_dmg_:"electro%",anemo_dmg_:"anemo%",geo_dmg_:"geo%",dendro_dmg_:"dendro%",physical_dmg_:"phys%"};function Ql({disabled:e}){const{t}=(0,d.$G)(["page_character","settings"]),[n,a,r]=(0,y.aV)(),{character:{key:l,level:s,ascension:u,constellation:h,talent:{auto:Z,skill:p,burst:m}}}=(0,c.useContext)(g.V),{charTC:{weapon:{key:f,level:x,ascension:b,refinement:C},artifact:{slots:w,substats:{stats:B},sets:k}}}=(0,c.useContext)(Bl),S=l.toLowerCase(),X=Object.entries(k).map((([e,t])=>`${S} add set="${e.toLowerCase()}" count=${t};`)).join("\n"),T=Object.entries(w).map((([e,{level:t,statKey:n,rarity:i}])=>`${Jl[n]}=${(0,Sn.Fx)(n,i,t)}`)).join(" "),O=Object.entries(B).map((([e,t])=>`${Jl[e]}=${(0,v.YM)(t,e).toFixed(e.endsWith("_")?4:2)}`)).join(" "),E=`# Generated by Genshin Optimizer\n\n# Character\n${S} char lvl=${s}/${Sn.SJ[u]} cons=${h} talent=${Z},${p},${m};\n\n# Weapon\n${S} add weapon="${f.toLowerCase()}" refine=${C} lvl=${x}/${Sn.SJ[b]};\n\n# Artifact Set\n${X||"# No Artifact Sets"}\n\n# Main stats\n${S} add stats ${T};\n\n# Sub stats\n${S} add stats ${O};`;return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{onClick:a,startIcon:(0,Q.tZ)(Ae.Z,{src:Yl}),disabled:e,children:t("tabTheorycraft.gcsimDialog.title")}),(0,Q.BX)(gl.Z,{open:n,onClose:r,maxWidth:"lg",children:[(0,Q.tZ)(xl.Z,{children:t("tabTheorycraft.gcsimDialog.title")}),(0,Q.BX)(bl.Z,{children:[(0,Q.tZ)(yl.Z,{children:(0,Q.BX)(d.cC,{t,i18nKey:"tabTheorycraft.gcsimDialog.content",children:["Import this build into"," ",(0,Q.tZ)(rn.Z,{href:"https://gcsim.app/",target:"_blank",children:"gcsim"})," ","by copying the code below."]})}),(0,Q.tZ)(i.s8,{children:(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(i.dn,{text:E})})})]}),(0,Q.tZ)(vl.Z,{children:(0,Q.tZ)(W.Z,{fullWidth:!0,color:"info",onClick:()=>navigator.clipboard.writeText(E).then((()=>alert(t("tabTheorycraft.gcsimDialog.copied")))).catch(console.error),startIcon:(0,Q.tZ)(pe.Z,{}),children:(0,Q.tZ)(d.cC,{t,i18nKey:"settings:DatabaseCard.button.copy"})})})]})]})}const es=n.p+"kqm.539212b66c730fa6.png";function ts({action:e,disabled:t}){const{t:n}=(0,d.$G)(["page_character","ui"]),[i,a,r]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"keqing",onClick:a,startIcon:(0,Q.tZ)(Ae.Z,{src:es}),disabled:t,children:n("tabTheorycraft.kqmsDialog.kqmsBtn")}),(0,Q.BX)(gl.Z,{open:i,onClose:r,children:[(0,Q.tZ)(xl.Z,{children:n("tabTheorycraft.kqmsDialog.title")}),(0,Q.tZ)(bl.Z,{children:(0,Q.tZ)(yl.Z,{children:(0,Q.BX)(d.cC,{t:n,i18nKey:"tabTheorycraft.kqmsDialog.content",children:["This will replace your current ",(0,Q.tZ)("strong",{children:"substat setup"})," with one that adheres to the"," ",(0,Q.tZ)(rn.Z,{href:"https://compendium.keqingmains.com/kqm-standards",target:"_blank",children:"KQM Standards"}),"."]})})}),(0,Q.BX)(vl.Z,{children:[(0,Q.tZ)(W.Z,{onClick:r,color:"error",children:n("ui:close")}),(0,Q.tZ)(W.Z,{color:"success",onClick:()=>{r(),e()},autoFocus:!0,children:n("tabTheorycraft.kqmsDialog.kqmsBtn")})]})]})]})}var ns=n(86512),is=n(23128);const as=c.lazy((()=>Promise.resolve().then(n.bind(n,18571))));function rs({weaponTypeKey:e,disabled:t}){const{charTC:n,setCharTC:i}=(0,c.useContext)(Bl),a=(0,c.useCallback)((e=>{i((t=>{t.weapon=Object.assign({},t.weapon,e)}))}),[i]),r=(0,c.useMemo)((()=>Object.assign({},n.weapon,{location:"",lock:!1,id:""})),[n]),{key:s,level:o=0,refinement:d=1,ascension:u=0}=r,h=(0,B.ub)(s),[p,m,f]=(0,y.aV)(),{data:g}=(0,c.useContext)(Z.R),x=(0,c.useMemo)((()=>r&&(0,X.mP)([h.data,(0,X.v0)(r)])),[h,r]);return(0,Q.BX)(G.Z,{sx:{p:1,mb:1},children:[(0,Q.tZ)(as,{ascension:u,show:p,onHide:f,onSelect:e=>a({key:e}),weaponTypeFilter:e}),(0,Q.BX)(l.Z,{display:"flex",flexDirection:"column",gap:1,children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,children:[(0,Q.tZ)(l.Z,{className:`grad-${h.rarity}star`,component:"img",src:(0,kn.Aq)(r.key,u>=2),sx:{flexshrink:1,flexBasis:0,maxWidth:"30%",borderRadius:1}}),(0,Q.BX)(Ke.Z,{spacing:1,flexGrow:1,children:[(0,Q.tZ)(W.Z,{fullWidth:!0,color:"info",sx:{flexGrow:1},onClick:m,disabled:t,children:(0,Q.tZ)(l.Z,{sx:{maxWidth:"10em"},children:null==h?void 0:h.name})}),h.hasRefinement&&(0,Q.tZ)(is.Z,{disabled:t,refinement:d,setRefinement:e=>a({refinement:e})})]})]}),(0,Q.tZ)(ns.Z,{level:o,ascension:u,setBoth:a,useLow:!h.hasRefinement,disabled:t}),(0,Q.BX)(Oe.Z,{children:[(0,Q.tZ)(Re.Z,{title:"Main Stats",titleTypographyProps:{variant:"subtitle2"}}),(0,Q.tZ)(De.Z,{}),x&&(0,Q.tZ)(We.lD,{children:[S.ri.weapon.main,S.ri.weapon.sub,S.ri.weapon.sub2].map((e=>{const t=x.get(e);return t.isEmpty||!t.value?null:(0,Q.tZ)(We.JW,{node:t,component:bt.ZP},JSON.stringify(t.info))}))})]}),g&&(null==h?void 0:h.document)&&(0,Q.tZ)(wr.Z,{sections:h.document,disabled:t})]})]})}function ls(e,t,n){var i,r;const{artifact:{sets:l},optimization:{target:s,minTotal:o}}=n;if(!s)return{};const c=null==(i=e[t])?void 0:i.target.data[0];if(!c)return{};Object.assign(c,(0,X.b3)([c,Ya]));const d=(0,T.Hm)(null!=(r=c.display)?r:{},s);if(!d)return{};const u=Object.keys(o).map((e=>c.total[e]));let h=(0,on.tL)([d,...u],c,(({path:[e]})=>"dyn"!==e));return h=(0,un.uW)(h,(e=>{if("read"===e.operation&&"dyn"===e.path[0]){const t=l[e.path[1]];if(t)return(0,hn.a9)(t);if(!a._m.includes(e.path[1]))return(0,hn.a9)(0)}return e}),(e=>e)),h=(0,on.tL)(h,{},(e=>!1)),{nodes:h}}function ss(e,t,n=20){return n-e.reduce(((e,[n,i])=>{var a;const r=5-(null!=(a=t[n])?a:0);return e+Math.min(i,r)}),0)}function os(e){return Object.values(e).reduce(((e,{rarity:t,level:n})=>{const{high:i,low:r}=a.i0[t];return e+(n>=4?i:r)}),0)}function cs(e){const t={};return Object.values(e).forEach((({statKey:e})=>{var n;t[e]=(null!=(n=t[e])?n:0)+1}),0),t}function ds(e){const{artifact:{slots:t,substats:{stats:n},sets:i}}=e,a=(0,v.vU)(n,((e,t)=>(0,v.YM)(e,t)));return Object.values(t).forEach((({statKey:e,rarity:t,level:n})=>{var i;return a[e]=(null!=(i=a[e])?i:0)+(0,Sn.Fx)(e,t,n)})),{art:(0,v.vU)(a,((e,t)=>t.endsWith("_")?(0,hn.aQ)(e):(0,hn.a9)(e))),artSet:(0,v.vU)(i,(e=>(0,hn.a9)(e)))}}function us(e){const{weapon:{key:t,level:n,ascension:i,refinement:a}}=e;return{id:"",location:"",key:t,level:n,ascension:i,refinement:a,lock:!1}}let hs,Zs,ps,ms=e=>e;function fs(){var e,t;const{t:i}=(0,d.$G)("page_character"),o=(0,r.Wz)(),{data:h}=(0,c.useContext)(Z.R),{gender:p}=(0,r.Hz)(),{teamId:m,team:{compareData:f},character:x,character:{key:b},characterSheet:y}=(0,c.useContext)(g.V),C=function(e,t){const n=(0,r.Wz)(),[i,a]=(0,c.useState)((()=>n.charTCs.getWithInit(e,t)));return(0,c.useEffect)((()=>(a(n.charTCs.getWithInit(e,t)),n.charTCs.follow(e,((e,t,n)=>"update"===t&&a(n))))),[e,a,n,t]),i}(b,(0,wl.mT)(y.weaponTypeKey)),w=(0,c.useCallback)((e=>{o.charTCs.set(b,e)}),[b,o]),B=(0,c.useMemo)((()=>({charTC:C,setCharTC:w})),[C,w]),k=(0,c.useCallback)((()=>{w((0,ue.Oh)((0,wl.mT)(y.weaponTypeKey)))}),[w,y]),S=(0,c.useCallback)(((e,t)=>w((n=>{n.weapon.key=e.key,n.weapon.level=e.level,n.weapon.ascension=e.ascension,n.weapon.refinement=e.refinement;const i=n.artifact.substats.type;n.artifact=(0,ue.Oh)("DullBlade").artifact,n.artifact.substats.type=i;const a={};t.forEach((e=>{var t;if(!e)return;const{slotKey:i,setKey:r,substats:l,mainStatKey:s,level:o,rarity:c}=e;n.artifact.slots[i].level=o,n.artifact.slots[i].statKey=s,n.artifact.slots[i].rarity=c,a[r]=(null!=(t=a[r])?t:0)+1,l.forEach((e=>{var t;e.key&&(n.artifact.substats.stats[e.key]=(null!=(t=n.artifact.substats.stats[e.key])?t:0)+e.accurateValue)}))})),n.artifact.sets=Object.fromEntries(Object.entries(a).map((([e,t])=>[e,3===t?2:5===t?4:1!==t||e.startsWith("PrayersFor")?t:0])).filter((([,e])=>e)))}))),[w]),X=(0,u.TH)(),{build:O}=null!=(e=X.state)?e:{build:void 0};(0,c.useEffect)((()=>{if(!O)return;const e=o.weapons.get(x.equippedWeapon);S(e,O.map((e=>o.arts.get(e))))}),[O,o]);const E=(0,c.useCallback)((()=>{const e=o.weapons.get(x.equippedWeapon);S(e,Object.values(x.equippedArtifacts).map((e=>o.arts.get(e))).filter((e=>e)))}),[o,x.equippedArtifacts,x.equippedWeapon,S]),I=(0,c.useDeferredValue)(C),P=(0,c.useMemo)((()=>ds(I)),[I]),M=(0,c.useMemo)((()=>us(I)),[I]),K=j(m,0,P,M),{target:D}=null!=(t=null==K?void 0:K[b])?t:{},A=(0,c.useMemo)((()=>{if(K&&D)return{data:D,teamData:K}}),[D,K]),_=(0,c.useMemo)((()=>{if(A)return Object.assign({},A,{oldData:f?h:void 0})}),[A,f,h]),z=C.optimization.target,R=(0,c.useCallback)((e=>{const t=structuredClone(C);t.optimization.target=e,w(t)}),[C,w]),L=C.optimization.distributedSubstats,V=(0,c.useCallback)((e=>{w((t=>{t.optimization.distributedSubstats=e}))}),[w]),F=(0,c.useRef)(null);null===F.current&&(F.current=new Worker(new URL(n.p+n.u(785),n.b)));const[H,U]=(0,c.useState)((0,hl.Qe)()),Y="active"===H.type,J=(0,c.useCallback)((()=>{F.current.terminate(),F.current=null,U((0,hl.Qe)())}),[F]),{minSubLines:ee,minOtherRolls:te}=(0,c.useMemo)((()=>function(e){const{artifact:{slots:t,substats:{stats:n,type:i,rarity:a}}}=e,r=(0,v.vU)(n,((e,t)=>Math.ceil(n[t]/(0,Sn.U9)(t,a,i)))),l=cs(t),s=os(t);return{minSubLines:s,minOtherRolls:ss(Object.entries(r),l,s)}}(C)),[C]),ne=(0,c.useMemo)((()=>Object.values(C.artifact.slots).reduce(((e,{level:t,rarity:n})=>e+a.i0[n].high+Math.floor(t/4)),0)),[C]),{scalesWith:ie}=(0,c.useMemo)((()=>{const{nodes:e}=ls(K,b,C),t=e?function(e){const t=new Set;return(0,on.I3)(e,{},(e=>{const n=e.path[1];return t.add(n),n}),1),t}(e):new Set;return{nodes:e,scalesWith:t}}),[K,b,C]),re=e=>{const t=(0,cn.o_)(o,b,0,p,ds(C),us(C)),{nodes:n}=ls(t,b,C);F.current.postMessage({charTC:C,nodes:n}),U((e=>Object.assign({},e,{type:"active",startTime:performance.now(),finishTime:void 0}))),F.current.onmessage=({data:t})=>{const{resultType:n}=t;switch(n){case"total":U((e=>Object.assign({},e,{total:t.total})));break;case"count":U((e=>Object.assign({},e,{tested:t.tested,failed:t.failed})));break;case"finalize":{const{maxBuffer:n,distributed:i,tested:a,failed:r,skipped:l}=t;if(U((e=>Object.assign({},e,{type:"inactive",tested:a,failed:r,skipped:l,finishTime:performance.now()}))),!e){console.log({maxBuffer:n,distributed:i,tested:a,failed:r,skipped:l});break}w((e=>(e.artifact.substats.stats=(0,v.vU)(e.artifact.substats.stats,((e,t)=>{var i;return e+(0,v.yI)(null!=(i=n[t])?i:0,t)})),e.optimization.distributedSubstats=L-i,e)));break}}}},le=(0,c.useCallback)((()=>{w((e=>{e.artifact.substats.type="mid";const{artifact:{slots:t,substats:{stats:n,type:i,rarity:a}}}=e;e.optimization.distributedSubstats=20-(5===a?0:4===a?10:15),e.artifact.substats.stats=(0,v.vU)(n,((e,t)=>2*(0,Sn.U9)(t,a,i))),e.optimization.maxSubstats=(0,v.vU)(e.optimization.maxSubstats,((e,n)=>2+2*(5-Object.entries(t).filter((([e,{statKey:t}])=>t===n)).length)))}))}),[w]);return(0,Q.tZ)(Bl.Provider,{value:B,children:(0,Q.BX)(Ke.Z,{spacing:1,children:[(0,Q.tZ)(G.Z,{children:(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1,p:1},children:[(0,Q.BX)(l.Z,{sx:{flexGrow:1,display:"flex",gap:1},children:[(0,Q.tZ)(gs,{action:E,disabled:Y}),(0,Q.tZ)(xs,{action:k,disabled:Y}),(0,Q.tZ)(ts,{action:le,disabled:Y}),(0,Q.tZ)(Ql,{disabled:Y})]}),(0,Q.BX)(ae.Z,{exclusive:!0,value:f,onChange:(e,t)=>o.teams.set(m,{compareData:t}),size:"small",children:[(0,Q.tZ)(q.Z,{value:!1,disabled:!f,children:i(hs||(hs=ms`tabTheorycraft.compareToggle.tc`))}),(0,Q.tZ)(q.Z,{value:!0,disabled:f,children:i(Zs||(Zs=ms`tabTheorycraft.compareToggle.equipped`))})]})]})}),A?(0,Q.BX)(Z.R.Provider,{value:A,children:[(0,Q.tZ)(l.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[(0,Q.BX)(Xe.ZP,{item:!0,sx:{flexGrow:-1,maxWidth:"350px"},children:[(0,Q.tZ)(rs,{weaponTypeKey:y.weaponTypeKey,disabled:Y}),(0,Q.tZ)(Hl,{disabled:Y})]}),(0,Q.tZ)(Xe.ZP,{item:!0,sx:{flexGrow:-1},children:(0,Q.tZ)(Il,{disabled:Y})}),(0,Q.tZ)(Xe.ZP,{item:!0,sx:{flexGrow:1},children:(0,Q.tZ)(Vl,{disabled:Y,maxTotalRolls:ne})})]})}),(0,Q.BX)(l.Z,{display:"flex",flexDirection:"column",gap:1,children:[te>0&&(0,Q.tZ)(xt.Z,{severity:"warning",variant:"filled",children:(0,Q.BX)(d.cC,{t:i,i18nKey:"tabTheorycraft.feasibilityAlert",values:{minSubLines:ee,minOtherRolls:te},children:["The current substat distribution requires at least"," ",(0,Q.tZ)("strong",{children:{minSubLines:ee}})," lines of substats. Need to assign ",(0,Q.tZ)("strong",{children:{minOtherRolls:te}})," ","rolls to other substats for this solution to be feasible."]})}),(0,Q.BX)(l.Z,{display:"flex",gap:1,children:[(0,Q.tZ)(Ne,{disabled:Y,optimizationTarget:z,setTarget:e=>R(e)}),(0,Q.tZ)(Ee.ZP,{value:L,disabled:!z||Y,onChange:e=>void 0!==e&&V(e),endAdornment:"Substats",sx:{borderRadius:1,px:1,textWrap:"nowrap",flexShrink:1},inputProps:{sx:{textAlign:"right",px:1,width:"3em",minWidth:"3em"},min:0}}),Y?(0,Q.tZ)(W.Z,{onClick:J,color:"error",startIcon:(0,Q.tZ)(fl.Z,{}),children:"Cancel"}):(0,Q.tZ)(W.Z,{onClick:()=>re(!0),disabled:!z||!L||L>ne,color:"success",startIcon:(0,Q.tZ)(ml.Z,{}),children:i(ps||(ps=ms`tabTheorycraft.distribute`))})]}),T.r8&&(0,Q.tZ)(W.Z,{onClick:()=>re(!1),disabled:!z||Y,children:"Log Optimized Substats"}),!!ie.size&&(0,Q.BX)(xt.Z,{severity:"info",variant:"filled",children:[(0,Q.BX)(d.cC,{t:i,i18nKey:"tabTheorycraft.optAlert.scalesWith",children:["The selected Optimization target and constraints scales with:"," "]}),[...ie].map((e=>(0,Q.BX)("strong",{children:[(0,Q.tZ)(N.ej,{statKey:e,iconProps:$.mX}),(0,Q.tZ)(Cl.w0,{statKey:e})]},e))).flatMap(((e,t,n)=>t===n.length-2?[e,(0,Q.tZ)("span",{children:", and "},"and")]:t===n.length-1?e:[e,(0,Q.tZ)("span",{children:", "},t)])),(0,Q.tZ)(d.cC,{t:i,i18nKey:"tabTheorycraft.optAlert.distribute",children:". The solver will only distribute stats to these substats."})," ",te>0&&(0,Q.tZ)(d.cC,{t:i,i18nKey:"tabTheorycraft.optAlert.feasibilty",children:"There may be additional leftover substats that should be distributed to non-scaling stats to ensure the solution is feasible."})]}),(0,Q.tZ)(hl.g8,{status:H,characterKey:b,gender:p})]})]}):(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:500}),(0,Q.tZ)(G.Z,{sx:{flexGrow:1,p:1},children:(0,Q.tZ)(sn.o.Provider,{value:z,children:_?(0,Q.tZ)(Z.R.Provider,{value:_,children:(0,Q.tZ)(Ki.Z,{})}):(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:500})})})]})})}function gs({action:e,disabled:t}){const{t:n}=(0,d.$G)(["page_character","ui"]),[i,a,r]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"info",onClick:a,startIcon:(0,Q.tZ)(Zl.Z,{}),disabled:t,children:n("tabTheorycraft.copyDialog.copyBtn")}),(0,Q.BX)(gl.Z,{open:i,onClose:r,children:[(0,Q.tZ)(xl.Z,{children:n("tabTheorycraft.copyDialog.title")}),(0,Q.tZ)(bl.Z,{children:(0,Q.tZ)(yl.Z,{children:n("tabTheorycraft.copyDialog.content")})}),(0,Q.BX)(vl.Z,{children:[(0,Q.tZ)(W.Z,{onClick:r,color:"error",children:n("ui:close")}),(0,Q.tZ)(W.Z,{color:"success",onClick:()=>{r(),e()},autoFocus:!0,children:n("tabTheorycraft.copyDialog.copyBtn")})]})]})]})}function xs({action:e,disabled:t}){const{t:n}=(0,d.$G)(["page_character","ui"]),[i,a,r]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(W.Z,{color:"error",onClick:a,startIcon:(0,Q.tZ)(pl.Z,{}),disabled:t,children:n("ui:reset")}),(0,Q.BX)(gl.Z,{open:i,onClose:r,children:[(0,Q.tZ)(xl.Z,{children:n("tabTheorycraft.resetDialog.title")}),(0,Q.tZ)(bl.Z,{children:(0,Q.tZ)(yl.Z,{children:n("tabTheorycraft.resetDialog.content")})}),(0,Q.BX)(vl.Z,{children:[(0,Q.tZ)(W.Z,{onClick:r,color:"error",children:n("ui:close")}),(0,Q.tZ)(W.Z,{color:"success",onClick:()=>{r(),e()},autoFocus:!0,children:n("ui:reset")})]})]})]})}var bs=n(1856),ys=n(5896),vs=n(81073),Cs=n(30840),ws=n(15045);const Bs=[[1],[1,1,1,1],[1,2,3,4,3,2,1],[1,3,6,10,12,12,10,6,3,1],[1,4,10,20,31,40,44,40,31,20,10,4,1],[1,5,15,35,65,101,135,155,155,135,101,65,35,15,5,1]];function ks(e,t){var n;if(e>=Bs.length)throw Error("Input to `quadrinomial` leaves expected range 0 <= n <= 5");return null!=(n=Bs[e][t])?n:0}function Ss(e){let t=1;e<0&&(t=-1);const n=1/(1+.3275911*(e=Math.abs(e)));return t*(1-((((1.061405429*n-1.453152027)*n+1.421413741)*n-.284496736)*n+.254829592)*n*Math.exp(-e*e))}const Xs=[1,1,2,6,24,120,720];function Ts(e){for(;e>=Xs.length;)Xs.push(Xs.length*Xs[Xs.length-1]);return Xs[e]}function Os(e,t){var n,i,a,r,l;if(0!==e)for(let s=e;s>=0;s--)for(let o=e-s;o>=0;o--)for(let c=e-s-o;c>=0;c--){const d=e-s-o-c;t([s,o,c,d],(n=s)+(i=o)+(a=c)+(r=d)!==(l=e)?0:Ts(l)/Ts(n)/Ts(i)/Ts(a)/Ts(r)*4**-l)}else t([0,0,0,0],1)}function Es(e,t,n){let i=!0;return(0,un.aD)([e],(e=>{}),(e=>{const{operation:a}=e;if("read"===a){if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error(`Unsupported [${a}] node in zero_deriv`);t(e)===n&&(i=!1)}})),i}function js(e,t,n){const{operation:i}=e;switch(i){case"read":if("number"!==e.type||e.accu&&"add"!==e.accu)throw new Error(`Unsupported [${i}] node in d/dx`);return t(e)===n?(0,hn.a9)(1):(0,hn.a9)(0);case"const":return(0,hn.a9)(0);case"res":if(!Es(e,t,n))throw new Error(`[${i}] node takes only constant inputs. ${e}`);return(0,hn.a9)(0);case"add":return(0,hn.Sm)(...e.operands.map((e=>js(e,t,n))));case"mul":{const i=e.operands.map(((i,a)=>(0,hn.WV)(js(i,t,n),...e.operands.filter(((e,t)=>t!==a)))));return(0,hn.Sm)(...i)}case"sum_frac":{const i=e.operands[0],a=js(i,t,n),r=(0,hn.Sm)(...e.operands.slice(1)),l=js(r,t,n),s=(0,hn.WV)((0,hn.Sm)(...e.operands),(0,hn.Sm)(...e.operands)),o=(0,hn.Sm)((0,hn.WV)(r,a),(0,hn.WV)(-1,i,l));return(0,hn.F9)(o,(0,hn.Sm)((0,hn.WV)(-1,o),s))}case"min":case"max":{let a=js(e.operands[0],t,n);for(let r=1;r<e.operands.length;r++){const l=e.operands[r];if("min"===i){const i=(0,hn.VV)(...e.operands.slice(0,r));a=(0,hn.Lj)(l,i,a,js(l,t,n))}else if("max"===i){const i=(0,hn.Fp)(...e.operands.slice(0,r));a=(0,hn.Lj)(l,i,js(l,t,n),a)}}return a}case"threshold":{const[a,r,l,s]=e.operands;if(!Es(a,t,n)||!Es(r,t,n))throw new Error(`[${i}] node must branch on constant inputs. ${e}`);return(0,hn.Lj)(a,r,js(l,t,n),js(s,t,n))}default:(0,T.UT)(i)}}function Is(e,t,n){if(t<1e-5)return e>n?{p:1,upAvg:e-n}:{p:0,upAvg:0};const i=(n-e)/Math.sqrt(t),a=(1-Ss(i/Math.sqrt(2)))/2,r=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),n<=0?0:Math.exp(-(t-e)*(t-e)/n/2)/Math.sqrt(2*Math.PI*n)}(i),l=1/(i*i),s=i<5?r/a-i:(1-2*l*(1-l*(5+37*l)))/i;return{p:a,upAvg:Math.sqrt(t)*s}}const Ps=8.5,Ms=18.375,Ks=4.515625;let Ds=function(e){return e[e.Fast=0]="Fast",e[e.Slow=1]="Slow",e[e.Exact=2]="Exact",e}({});const As={hp:6,atk:6,def:6,hp_:4,atk_:4,def_:4,eleMas:4,enerRech_:4,critRate_:3,critDMG_:3};function _s(e,t=5){return zs(e,(0,Sn.U9)(e,t)/10)}function zs(e,t){return e.endsWith("_")?t/100:t}class UpOptCalculator{constructor(e,t,n,i){this.baseBuild=void 0,this.nodes=void 0,this.thresholds=void 0,this.calc4th=!1,this.skippableDerivatives=void 0,this.eval=void 0,this.artifacts=[],this.fixedIx=0,this.baseBuild=n,this.nodes=e,this.thresholds=t;const r=[];e.forEach((e=>{r.push(e,...a._m.map((t=>js(e,(e=>e.path[1]),t))))}));const l=(0,on.tL)(r,{},(({path:[e]})=>"dyn"!==e)),s=(0,on.I3)(l,{},(e=>e.path[1]),5);t[0]=s(Object.values(n))[0],this.skippableDerivatives=a._m.map((t=>e.every((e=>Es(e,(e=>e.path[1]),t))))),this.eval=(t,i)=>{const r=Object.assign({},n,{[i]:{id:"",values:t}}),l=s(Object.values(r));return e.map(((e,t)=>{const n=t*(1+a._m.length);return{v:l[n],grads:a._m.map(((e,t)=>l[n+1+t]))}}))},i.forEach((e=>this._addArtifact(e)))}_addArtifact(e){const t=a.F7[e.rarity],n=(0,Sn.Bv)(e.mainStatKey,e.rarity,t);this.artifacts.push({id:e.id,rollsLeft:(0,Sn.NB)(e.level,e.rarity),slotKey:e.slotKey,mainStat:e.mainStatKey,subs:e.substats.map((({key:e})=>e)).filter((e=>""!==e)),values:Object.assign({[e.setKey]:1,[e.mainStatKey]:zs(e.mainStatKey,n)},Object.fromEntries(e.substats.filter((({key:e})=>""!==e)).map((e=>[e.key,zs(e.key,e.accurateValue)]))))})}calcFastAll(){function e(e){return e.result.p*e.result.upAvg}this.artifacts.forEach(((e,t)=>this.calcFast(t,this.calc4th))),this.artifacts.sort(((t,n)=>e(n)-e(t))),this.fixedIx=0}calcSlowToIndex(e,t=5){const n=this.artifacts.slice(0,this.fixedIx),i=this.artifacts.slice(this.fixedIx);function a(e){return e.result.p*e.result.upAvg}function r(e,t){if(a(e)>1e-5||a(t)>1e-5)return a(t)-a(e);const n=e.result.distr.gmm.reduce(((e,{phi:t,mu:n})=>e+t*n),0);return t.result.distr.gmm.reduce(((e,{phi:t,mu:n})=>e+t*n),0)-n}let l=0;const s=Math.min(e-this.fixedIx+t,i.length);do{for(;l<s;l++)this.calcSlow(this.fixedIx+l,this.calc4th);for(i.sort(r),this.artifacts=[...n,...i],l=0;l<s&&i[l].result.evalMode!==Ds.Fast;l++);}while(l<s)}_toResultFast(e){let t=0,n=0;const i=e.map((({prob:e,mu:i,cov:a})=>{const r=i.map(((e,t)=>Is(e,a[t],this.thresholds[t]))),l=Math.min(...r.map((({p:e})=>e))),s=Math.min(...r.slice(1).map((({p:e})=>e)));return t+=l*e,n+=l*e*r[0].upAvg,{phi:e,cp:s,mu:i[0],sig2:a[0]}})),a=i.map((({mu:e,sig2:t})=>e-4*Math.sqrt(t))),r=i.map((({mu:e,sig2:t})=>e+4*Math.sqrt(t)));return{p:t,upAvg:t<1e-6?0:n/t,distr:{gmm:i,lower:Math.min(...a),upper:Math.max(...r)},evalMode:Ds.Fast}}calcFast(e,t=!0){4===this.artifacts[e].subs.length&&(t=!1),t?this._calcFast4th(e):this._calcFast(e)}_calcFast(e){const{subs:t,slotKey:n,rollsLeft:i}=this.artifacts[e],r=i-(t.length<4?1:0),l=Object.assign({},this.artifacts[e].values);t.forEach((e=>{l[e]+=Ps*(r/4)*_s(e)}));const s=this.eval(l,n).map((({v:e,grads:n})=>{const i=t.map((e=>n[a._m.indexOf(e)]*_s(e))),l=i.reduce(((e,t)=>e+t),0),s=i.reduce(((e,t)=>e+t*t),0);return{mu:e,sig2:(Ms*s-Ks*l**2)*r}}));this.artifacts[e].result=this._toResultFast([{prob:1,mu:s.map((({mu:e})=>e)),cov:s.map((({sig2:e})=>e))}])}_calcFast4th(e){const{mainStat:t,subs:n,slotKey:i,rollsLeft:r}=this.artifacts[e],l=r-1,s=a._m.filter((e=>!n.includes(e)&&e!==t)),o=s.reduce(((e,t)=>e+As[t]),0),c=s.map((t=>{var r;const s=As[t]/o,c=Object.assign({},this.artifacts[e].values);n.forEach((e=>{c[e]+=Ps*(l/4)*_s(e)})),c[t]=(null!=(r=c[t])?r:0)+Ps*(l/4+1)*_s(t);const d=this.eval(c,i).map((({v:e,grads:i})=>{const r=n.map((e=>i[a._m.indexOf(e)]*_s(e))),s=i[a._m.indexOf(t)]*_s(t),o=r.reduce(((e,t)=>e+t),s),c=r.reduce(((e,t)=>e+t*t),s*s);return{mu:e,sig2:(Ms*c-Ks*o**2)*l+1.25*s*s}}));return{prob:s,mu:d.map((({mu:e})=>e)),cov:d.map((({sig2:e})=>e))}}));this.artifacts[e].result=this._toResultFast(c)}_toResultSlow(e){let t=0,n=0;const i=e.map((({prob:e,mu:i,cov:a})=>{const{p:r,upAvg:l,cp:s}=function(e,t,n){let i=1,a=1;for(let l=0;l<e.length;++l){if(t[l][l]<1e-5){if(e[l]<n[l])return{p:0,upAvg:0,cp:0};continue}const r=(1-Ss((n[l]-e[l])/Math.sqrt(t[l][l])/Math.sqrt(2)))/2;i*=r,0!==l&&(a*=r)}const{upAvg:r}=Is(e[0],t[0][0],n[0]);return{p:i,upAvg:r,cp:a}}(i,a,this.thresholds);return t+=e*r,n+=e*r*l,{phi:e,cp:s,mu:i[0],sig2:a[0][0]}})),a=i.map((({mu:e,sig2:t})=>e-4*Math.sqrt(t))),r=i.map((({mu:e,sig2:t})=>e+4*Math.sqrt(t)));return{p:t,upAvg:t<1e-6?0:n/t,distr:{gmm:i,lower:Math.min(...a,this.thresholds[0]),upper:Math.max(...r,this.thresholds[0])},evalMode:Ds.Slow}}calcSlow(e,t=!0){var n,i;(null==(n=this.artifacts[e].result)?void 0:n.evalMode)!==Ds.Slow&&(null==(i=this.artifacts[e].result)?void 0:i.evalMode)!==Ds.Exact&&(4===this.artifacts[e].subs.length&&(t=!1),t?this._calcSlow4th(e):this._calcSlow(e))}_calcSlow(e){const{subs:t,slotKey:n,rollsLeft:i}=this.artifacts[e],r=i-(t.length<4?1:0),l=[];Os(r,((i,r)=>{const s=Object.assign({},this.artifacts[e].values);t.forEach(((e,t)=>{s[e]+=Ps*i[t]*_s(e)}));const o=this.eval(s,n),c=o.map((({grads:e})=>t.map((t=>e[a._m.indexOf(t)]*_s(t))))),d=o.map((e=>e.v)),u=c.map((e=>c.map((t=>e.reduce(((n,a,r)=>n+e[r]*t[r]*i[r]),0)))));l.push({prob:r,mu:d,cov:u})})),this.artifacts[e].result=this._toResultSlow(l)}_calcSlow4th(e){const{mainStat:t,subs:n,slotKey:i,rollsLeft:r}=this.artifacts[e],l=r-1,s=a._m.filter((e=>!n.includes(e)&&e!==t)),o=s.reduce(((e,t)=>e+As[t]),0),c=[];s.forEach((t=>{Os(l,((r,l)=>{var s;l*=As[t]/o;const d=Object.assign({},this.artifacts[e].values);r[3]+=1,n.forEach(((e,t)=>{d[e]+=Ps*r[t]*_s(e)})),d[t]=(null!=(s=d[t])?s:0)+Ps*r[3]*_s(t);const u=this.eval(d,i),h=u.map((({grads:e})=>{const i=n.map((t=>e[a._m.indexOf(t)]*_s(t)));return i.push(e[a._m.indexOf(t)]*_s(t)),i})),Z=u.map((e=>e.v)),p=h.map((e=>h.map((t=>e.reduce(((n,i,a)=>n+e[a]*t[a]*r[a]),0)))));c.push({prob:l,mu:Z,cov:p})}))})),this.artifacts[e].result=this._toResultSlow(c)}_toResultExact(e){let t=0,n=0;const i=e.map((({prob:e,val:i})=>{if(i.every(((e,t)=>e>=this.thresholds[t])))return t+=e,n+=e*(i[0]-this.thresholds[0]),{phi:e,cp:1,mu:i[0],sig2:0};return{phi:e,cp:i.slice(1).every(((e,t)=>e>=this.thresholds[t]))?1:0,mu:i[0],sig2:0}})),a=i.map((({mu:e})=>e));return{p:t,upAvg:t<1e-6?0:n/t,distr:{gmm:i,lower:Math.min(...a),upper:Math.max(...a)},evalMode:Ds.Exact}}calcExact(e,t=!0){var n;(null==(n=this.artifacts[e].result)?void 0:n.evalMode)!==Ds.Exact&&(4===this.artifacts[e].subs.length&&(t=!1),t?this._calcExact4th(e):this._calcExact(e))}_calcExact(e){const{subs:t,slotKey:n,rollsLeft:i}=this.artifacts[e],r=i-(t.length<4?1:0),l=[];Os(r,((i,r)=>{const s=Object.assign({},this.artifacts[e].values),o=i.map(((e,n)=>t[n]&&!this.skippableDerivatives[a._m.indexOf(t[n])]?(0,v.w6)(7*e,10*e):[NaN]));(0,v.Og)(...o).forEach((e=>{const a=Object.assign({},s);let o=1;for(let n=0;n<4;n++){var c;if(isNaN(e[n]))continue;const r=t[n],l=e[n],s=i[n];a[r]=(null!=(c=a[r])?c:0)+l*_s(r);o*=4**-s*ks(s,l-7*s)}l.push({prob:r*o,val:this.eval(a,n).map((e=>e.v))})}))})),this.artifacts[e].result=this._toResultExact(l)}_calcExact4th(e){const{mainStat:t,subs:n,slotKey:i,rollsLeft:r}=this.artifacts[e],l=r-1,s=a._m.filter((e=>!n.includes(e)&&e!==t)),o=s.reduce(((e,t)=>e+As[t]),0),c=[];s.forEach((t=>{const r=As[t]/o;Os(l,((l,s)=>{const o=l.map(((e,i)=>3===i?(e+=1,this.skippableDerivatives[a._m.indexOf(t)]?[NaN]:(0,v.w6)(7*e,10*e)):n[i]&&!this.skippableDerivatives[a._m.indexOf(n[i])]?(0,v.w6)(7*e,10*e):[NaN]));(0,v.Og)(...o).forEach((a=>{const o=Object.assign({},this.artifacts[e].values);let d=1;for(let e=0;e<3;e++){var u;if(isNaN(a[e]))continue;const t=n[e],i=a[e],r=l[e];o[t]=(null!=(u=o[t])?u:0)+i*_s(t);d*=4**-r*ks(r,i-7*r)}if(!isNaN(a[3])){var h;const e=t,n=a[3],i=l[3]+1;o[e]=(null!=(h=o[e])?h:0)+n*_s(e);d*=4**-i*ks(i,n-7*i)}c.push({prob:r*s*d,val:this.eval(o,i).map((e=>e.v))})}))}))})),this.artifacts[e].result=this._toResultExact(c)}}function Rs(e){const t=zs(e.mainStatKey,(0,Sn.Bv)(e.mainStatKey,e.rarity,e.level)),n={id:e.id,slot:e.slotKey,level:e.level,rarity:e.rarity,values:Object.assign({[e.setKey]:1,[e.mainStatKey]:t},Object.fromEntries(e.substats.map((e=>[e.key,zs(e.key,e.accurateValue)])).filter((([,e])=>0!==e)))),subs:e.substats.reduce(((e,t)=>(""!==t.key&&e.push(t.key),e)),[])};return delete n.values[""],n}const Ls=50;function Ws(e){return(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:5,sm:4,md:4,lg:3,xl:3,children:(0,Q.tZ)(Ai.Z,{artifactId:e.upgradeOpt.id,editorProps:{}})}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:7,sm:8,md:8,lg:9,xl:9,children:(0,Q.tZ)(Vs,Object.assign({},e))})]})}function Vs({upgradeOpt:e,thresholds:t,objMin:n,objMax:i,calcExactCallback:a}){const s=(0,r.Wz)().arts.get(e.id);if(!s)throw new Error(`artifact ${e.id} not found.`);const d=t.length>1,u=(t,n)=>e.result.distr.gmm.reduce(((e,{phi:i,mu:a,sig2:r})=>{const l=Math.sqrt(r);if(l<.001)return t<=a&&a<n?i+e:e;return e+i*(Ss((a-t)/l)-Ss((a-n)/l))/2}),0),h=(t,n)=>e.result.distr.gmm.reduce(((e,{cp:i,phi:a,mu:r,sig2:l})=>{const s=Math.sqrt(l);if(s<.001)return t<=r&&r<n?i*a+e:e;return e+i*a*(Ss((r-t)/s)-Ss((r-n)/s))/2}),0),Z=t[0],p=(0,c.useCallback)((e=>100*(e-Z)/Z),[Z]),m=(i-n)/Ls,f=(0,v.SX)(n,i,Ls,!1).flatMap((e=>[{x:p(e),est:u(e,e+m),estCons:h(e,e+m)},{x:p(e+m),est:u(e,e+m),estCons:h(e,e+m)}]));f.unshift({x:p(n),est:0,estCons:0}),f.push({x:p(i),est:0,estCons:0});const g=f.reduce(((e,{est:t})=>Math.max(e,t)),0),x=(Z-n)/(i-n),b=e.result.p,C=e.result.upAvg,w=f,B=e.result.evalMode===Ds.Exact,k=(0,v.SX)(n,i,Ls,!1).reduce(((e,t)=>t<Z+C?t:e)),S=h(k,k+m),X=(0,y.KS)();B||X(a,1e3);const T=(0,Q.BX)("span",{children:["Prob. upgrade",B?"":" (est.)",":"," ",(0,Q.BX)("strong",{children:[(100*b).toFixed(1),"%"]})]}),O=(0,Q.BX)("span",{children:["Average increase",B?"":" (est.)",":"," ",(0,Q.BX)("strong",{children:[C<=0?"":"+",(100*C/Z).toFixed(1),"%"]})]});return(0,Q.BX)(G.Z,{children:[(0,Q.BX)(l.Z,{sx:{display:"flex",flexDirection:"row"},children:[(0,Q.tZ)(o.Z,{sx:{flexGrow:1},children:(0,Q.BX)(l.Z,{sx:{display:"flex",flexDirection:"row",gap:2},children:[(0,Q.tZ)(be.Z,{children:T}),(0,Q.tZ)(be.Z,{sx:{flexGrow:1},children:O}),(0,Q.tZ)(be.Z,{children:"Currently Equipped"})]})}),(0,Q.tZ)(l.Z,{sx:{height:50,width:50},children:(0,Q.tZ)(Gs,{slotKey:s.slotKey})})]}),(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(Ui.h,{width:"100%",aspect:2.5,children:(0,Q.BX)(Yi.c,{data:w,margin:{top:5,right:30,left:20,bottom:20},children:[(0,Q.tZ)(Qi.K,{dataKey:"x",type:"number",domain:["auto","auto"],allowDecimals:!1,tickFormatter:e=>`${e<=0?"":"+"}${e}%`,children:(0,Q.tZ)(ea._,{value:"Relative Damage Potential",position:"insideBottom",style:{fill:"#eaebed"},offset:-10})}),(0,Q.tZ)(ta.B,{type:"number",domain:[0,g],tick:!1,children:(0,Q.tZ)(ea._,{value:"Probability",position:"insideLeft",angle:-90,style:{fill:"#eaebed"}})}),(0,Q.tZ)(ia.D,{verticalAlign:"top",height:36}),(0,Q.tZ)("defs",{children:(0,Q.BX)("linearGradient",{id:`splitOpacity${e.id}`,x1:"0",y1:"0",x2:x,y2:"0",children:[(0,Q.tZ)("stop",{offset:1,stopColor:B?"#f17704":"orange",stopOpacity:0}),(0,Q.tZ)("stop",{offset:0,stopColor:B?"#f17704":"orange",stopOpacity:1})]})}),(0,Q.tZ)(aa.x,{dataKey:"dne",stroke:"red",name:"Current Damage"}),d&&(0,Q.tZ)(vs.u,{type:"monotone",dataKey:"est",stroke:"grey",dot:!1,fill:"grey",legendType:"none",tooltipType:"none",opacity:.5,activeDot:!1}),(0,Q.tZ)(vs.u,{type:"monotone",dataKey:"estCons",stroke:B?"#f17704":"orange",dot:!1,fill:`url(#splitOpacity${e.id})`,opacity:.5,name:B?`Exact${d?" Constrained":""} Distribution`:"Estimated Distribution",activeDot:!1}),(0,Q.tZ)(Cs.d,{x:p(Z),stroke:"red",strokeDasharray:"3 3",name:"Current Damage"}),(0,Q.tZ)(ws.q,{x:p(Z+C),y:S/2,shape:(0,Q.tZ)("circle",{radius:1,opacity:.5})}),(0,Q.tZ)(na.u,{content:(0,Q.tZ)((({active:e})=>e?(0,Q.BX)("div",{className:"custom-tooltip",children:[(0,Q.tZ)("p",{className:"label"}),(0,Q.tZ)("p",{className:"desc",children:T}),(0,Q.tZ)("p",{className:"desc",children:O})]}):null),{}),cursor:!1})]})},e.id)})]})}function Gs({slotKey:e}){const t=(0,r.Wz)(),{data:n}=(0,c.useContext)(Z.R),i=(0,c.useMemo)((()=>t.arts.get(n.get(S.ri.art[e].id).value)),[e,n,t]);return(0,Q.tZ)(da.Z,{slotKey:e,artifactObj:i})}var $s=n(37214),Ns=n(83660);function Fs(){var e;const{teamId:t,character:{key:n}}=(0,c.useContext)(g.V),i=(0,r.Wz)(),{gender:d}=(0,r.Hz)(),u=(0,dn.Z)(),h=(0,c.useMemo)((()=>!i.arts.values.length),[i]),{buildSetting:p,buildSettingDispatch:m}=An(n),{optimizationTarget:f,levelLow:x,levelHigh:b}=p,C=j(t),{target:w}=null!=(e=null==C?void 0:C[n])?e:{},[B]=(0,y.NW)(),[,k]=(0,c.useState)(i.displayOptimize.get());(0,c.useEffect)((()=>i.displayOptimize.follow(((e,t)=>k(t)))),[i,k]);const S=(0,c.useDeferredValue)(B),O=(0,c.useDeferredValue)(p),E=(0,c.useMemo)((()=>{const{mainStatKeys:e,excludedLocations:t,artExclusion:r,levelLow:l,levelHigh:s,allowLocationsState:o,useExcludedArts:c}=S&&O;return i.arts.values.filter((i=>{if(!c&&r.includes(i.id))return!1;if(i.level<l)return!1;if(i.level>s)return!1;const d=e[i.slotKey];if(null!=d&&d.length&&!d.includes(i.mainStatKey))return!1;const u=(0,a.V7)(n),h="unequippedOnly"===o&&i.location&&i.location!==u,Z="customList"===o&&i.location&&i.location!==u&&t.includes(i.location);return!h&&!Z}))}),[i,n,S,O]),I=(0,c.useMemo)((()=>Object.fromEntries(E.map((({id:e})=>[e,!0])))),[E]),[P,M]=(0,c.useState)(void 0),[,K]=(0,y.NW)(),[D,A]=(0,c.useState)(!0),[_,z]=(0,c.useState)(!0),[R,L]=(0,c.useState)(!1),[V,$]=(0,c.useState)(0),{artifactsToShow:N,numPages:F,currentPageIndex:q,minObj0:H,maxObj0:U}=(0,c.useMemo)((()=>{if(!P)return{artifactsToShow:[],numPages:0,currentPageIndex:0,toShow:0,minObj0:0,maxObj0:0};const e=Math.ceil(P.artifacts.length/5),t=(0,v.re)(V,0,e-1),n=P.artifacts.slice(5*t,5*(t+1)),i=P.thresholds[0];return{artifactsToShow:n,numPages:e,currentPageIndex:t,minObj0:n.reduce(((e,t)=>Math.min(t.result.distr.lower,e)),i),maxObj0:n.reduce(((e,t)=>Math.max(t.result.distr.upper,e)),i)}}),[V,P]),Y=(0,c.useCallback)(((e,t)=>{if(!P)return;const n=5*t;P.calcSlowToIndex(n),$(t-1)}),[P]),J=(0,c.useCallback)((async()=>{var e,t,r,l;const{statFilters:s,optimizationTarget:o,mainStatKeys:c,levelLow:u,levelHigh:h,artSetExclusion:Z}=p;if(!T.dG)return;if(!n||!o)return;const m=(0,cn.VF)(i,n,0,[]);if(!m)return;const f=null==(e=(0,X.Qo)(m.teamData,d,n)[n])?void 0:e.target.data[0];if(!f)return;Object.assign(f,(0,X.b3)([f,Ya]));const g=(0,T.Hm)(null!=(t=f.display)?t:{},o);if(!g)return;M(void 0),$(0);const x=Object.entries(s).flatMap((([e,t])=>t.filter((e=>!e.disabled)).map((t=>{var n,i;const a=(0,T.Hm)(null!=(n=f.display)?n:{},JSON.parse(e));return{value:a,minimum:"%"===(null==(i=a.info)?void 0:i.unit)?t.value/100:t.value}})))),b=null!=(r=null==(l=i.chars.get(n))?void 0:l.equippedArtifacts)?r:{},y=Object.fromEntries(a.Ex.map((e=>{var t;const n=i.arts.get(null!=(t=b[e])?t:"");return[e,n?Rs(n):void 0]}))),v=Object.fromEntries(a.Ex.map((e=>{var t,n;const a=i.arts.get(null!=(t=b[e])?t:"");return[e,null!=(n=null==a?void 0:a.setKey)?n:""]})));const C=[g,...x.map((e=>e.value))],w=(0,on.tL)(C,f,(({path:[e]})=>"dyn"!==e)),B=i.arts.values.filter((e=>5===e.rarity)).filter((function(e){const t=Object.assign({},v);t[e.slotKey]=e.setKey;const n={};if(a.Ex.forEach((e=>{var i;return n[t[e]]=(null!=(i=n[t[e]])?i:0)+1})),!Object.entries(n).every((([e,t])=>{if(!Z[e])return!0;switch(t){case 0:case 1:return!0;case 2:case 3:return!Z[e].includes(2);case 4:case 5:return!Z[e].includes(4);default:throw Error("error in respectSetExclude: num > 5")}})))return!1;if(!Z.rainbow)return!0;switch(Object.values(n).reduce(((e,t)=>e+t%2),0)){case 0:case 1:return!0;case 2:case 3:return!Z.rainbow.includes(2);case 4:case 5:return!Z.rainbow.includes(4);default:throw Error("error in respectSex: nRainbow > 5")}})).filter((e=>D||20!==e.level)).filter((e=>{var t,n;return!R||!(null!=(t=c[e.slotKey])&&t.length)||(null==(n=c[e.slotKey])?void 0:n.includes(e.mainStatKey))})).filter((e=>!R||u<=e.level&&e.level<=h)),k=new UpOptCalculator(w,[-1/0,...x.map((e=>e.minimum))],y,B);k.calc4th=_,k.calcFastAll(),k.calcSlowToIndex(5),M(k)}),[p,n,i,d,D,R,_]),ee=(0,c.useMemo)((()=>w&&C&&{data:w,teamData:C}),[w,C]),te=F>1&&(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,children:[(0,Q.tZ)(Xe.ZP,{item:!0,flexGrow:1,children:(0,Q.tZ)(ys.Z,{count:F,page:q+1,onChange:Y})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(qs,{numShowing:N.length,total:null==P?void 0:P.artifacts.length})})]})})});return(0,Q.BX)(l.Z,{display:"flex",flexDirection:"column",gap:1,children:[h&&(0,Q.tZ)(ln,{}),ee&&(0,Q.tZ)(Z.R.Provider,{value:ee,children:(0,Q.BX)($s.Z,{spacing:1,children:[(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.BX)(Xe.ZP,{item:!0,xs:12,sm:6,lg:3,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(an.Z,{characterKey:n,onClickTeammate:u})}),(0,Q.tZ)(ki,{})]}),(0,Q.tZ)(Xe.ZP,{item:!0,xs:12,sm:6,lg:9,display:"flex",flexDirection:"column",gap:1,children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.BX)(Xe.ZP,{item:!0,lg:4,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(G.Z,{children:(0,Q.BX)(o.Z,{children:[(0,Q.tZ)("span",{children:"Optimization Target: "}),(0,Q.tZ)(Ne,{optimizationTarget:f,setTarget:e=>m({optimizationTarget:e}),disabled:!1})]})}),(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(Ha,{disabled:!1})})}),R&&(0,Q.BX)(G.Z,{children:[(0,Q.tZ)(o.Z,{sx:{py:1},children:"Artifact Level Filter"}),(0,Q.tZ)(tn.Z,{levelLow:x,levelHigh:b,setLow:e=>m({levelLow:e}),setHigh:e=>m({levelHigh:e}),setBoth:(e,t)=>m({levelLow:e,levelHigh:t}),disabled:!1}),(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(Va,{disabled:!1,filteredArtIdMap:I})})]})]}),(0,Q.BX)(Xe.ZP,{item:!0,lg:8,display:"flex",flexDirection:"column",gap:1,children:[(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.tZ)(gi,{disabled:!1})})}),(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{startIcon:D?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),color:D?"success":"secondary",onClick:()=>A(!D),children:"show lvl 20"})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{startIcon:_?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),color:_?"success":"secondary",onClick:()=>z(!_),children:"compute 4th sub"})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{startIcon:R?(0,Q.tZ)(vt.Z,{}):(0,Q.tZ)(Ct.Z,{}),color:R?"success":"secondary",onClick:()=>L(!R),children:"enable filters"})})]})})})]})]})})]}),(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(o.Z,{children:(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(W.Z,{disabled:!n||!f||!(0,T.Hm)(null==w?void 0:w.getDisplay(),f),color:n?"success":"warning",onClick:J,startIcon:(0,Q.tZ)(bs.Z,{}),children:"Calc Upgrade Priority"})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(de,{size:"small"})}),(0,Q.tZ)(Xe.ZP,{item:!0,children:(0,Q.tZ)(ce,{size:"small"})})]})})}),te,h&&(0,Q.tZ)(Ns.Z,{}),(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",sx:{width:"100%",height:600,minHeight:5e3}}),children:N.map(((e,t)=>{var n;return(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(Ws,{upgradeOpt:e,thresholds:null!=(n=null==P?void 0:P.thresholds)?n:[],objMax:U,objMin:H,calcExactCallback:()=>{const e=5*q+t;null==P||P.calcExact(e),K()}})},e.id)}))}),te]})})]})}function qs({numShowing:e,total:t}){return(0,Q.tZ)(be.Z,{color:"text.secondary",children:(0,Q.BX)(d.cC,{i18nKey:"showingNum",count:e,value:t,children:["Showing ",{count:e}," out of ",{value:t}," Artifacts"]})})}var Hs=n(50693),Us=n(96778),Ys=n(29754),Js=n(22973);let Qs,eo,to=e=>e;const no={xs:1,sm:2,md:3,lg:3,xl:3};function io({weaponTypeKey:e,weaponId:t,artifactIds:n,setWeapon:i,setArtifact:a}){const l=(0,r.Wz)();return(0,Q.BX)(Xe.ZP,{item:!0,columns:no,container:!0,spacing:1,children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,display:"flex",flexDirection:"column",children:l.weapons.keys.includes(t)?(0,Q.tZ)(Sr.Z,{weaponId:t,onEdit:i,extraButtons:(0,Q.tZ)(so,{weaponTypeKey:e,onChangeId:i})}):(0,Q.tZ)(ao,{weaponTypeKey:e,onChangeId:i})}),Object.entries(n).map((([e,t])=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:l.arts.keys.includes(t)?(0,Q.tZ)(Ai.Z,{artifactId:t,extraButtons:(0,Q.tZ)(lo,{slotKey:e,onChangeId:t=>a(e,t)}),editorProps:{}}):(0,Q.tZ)(ro,{slotKey:e,onChangeId:t=>a(e,t)})},t||e)))]})}function ao({weaponTypeKey:e,onChangeId:t}){const[n,a,r]=(0,y.aV)(),{t:s}=(0,d.$G)("weapon");return(0,Q.BX)(i.s8,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(be.Z,{children:[(0,Q.tZ)(Ae.Z,{src:kn.CL.weaponTypes[e]})," ",e]})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(l.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,Q.tZ)(Tr.Z,{weaponTypeKey:e,show:n,onClose:r,onChangeId:t}),(0,Q.tZ)(W.Z,{onClick:a,color:"info",sx:{borderRadius:"1em"},children:(0,Q.tZ)(Js.Z,{sx:{height:100,width:100}})})]})]})}function ro({slotKey:e,onChangeId:t}){const[n,a,r]=(0,y.aV)(),{t:s}=(0,d.$G)("artifact");return(0,Q.BX)(i.s8,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[(0,Q.tZ)(o.Z,{children:(0,Q.BX)(be.Z,{children:[(0,Q.tZ)(N.x7,{iconProps:$.mX,slotKey:e})," ",s(`slotName.${e}`)]})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(l.Z,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,Q.tZ)(Xr.Z,{slotKey:e,show:n,onClose:r,onChangeId:t}),(0,Q.tZ)(W.Z,{onClick:a,color:"info",sx:{borderRadius:"1em"},children:(0,Q.tZ)(Js.Z,{sx:{height:100,width:100}})})]})]})}function lo({slotKey:e,onChangeId:t}){const{t:n}=(0,d.$G)("page_character"),[i,a,r]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(Be.Z,{title:(0,Q.tZ)(be.Z,{children:n(Qs||(Qs=to`tabEquip.swapArt`))}),placement:"top",arrow:!0,children:(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:a,children:(0,Q.tZ)(Js.Z,{})})}),(0,Q.tZ)(Xr.Z,{slotKey:e,show:i,onClose:r,onChangeId:t})]})}function so({weaponTypeKey:e,onChangeId:t}){const{t:n}=(0,d.$G)("page_character"),[i,a,r]=(0,y.aV)();return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(Be.Z,{title:(0,Q.tZ)(be.Z,{children:n(eo||(eo=to`tabEquip.swapWeapon`))}),placement:"top",arrow:!0,children:(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:a,children:(0,Q.tZ)(Js.Z,{})})}),(0,Q.tZ)(Tr.Z,{weaponTypeKey:e,onChangeId:t,show:i,onClose:r})]})}function oo(){const e=(0,r.Wz)(),[t,n,a]=(0,y.aV)(),{teamCharId:l,teamChar:{buildType:s,buildId:d,buildIds:u,buildTcId:h,buildTcIds:Z}}=(0,c.useContext)(g.V);return(0,Q.BX)(Q.HY,{children:[(0,Q.BX)(W.Z,{startIcon:(0,Q.tZ)(Us.Z,{}),onClick:()=>{t?a():n()},children:["Loadout: ",(0,Q.tZ)("strong",{children:"Equipped"})]}),(0,Q.tZ)(i.AB,{open:t,onClose:a,children:(0,Q.BX)(i.s8,{children:[(0,Q.tZ)(Re.Z,{title:"Loadouts"}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.tZ)(co,{active:"equipped"===s}),(0,Q.tZ)(W.Z,{fullWidth:!0,color:"info",size:"small",onClick:()=>e.teamChars.newBuild(l),children:"New Loadout"}),u.map((e=>(0,Q.tZ)(uo,{buildId:e,active:"real"===s&&d===e},e)))]})]})})]})}function co({active:e=!1}){const{teamCharId:t,character:{equippedArtifacts:n,equippedWeapon:a}}=(0,c.useContext)(g.V),s=(0,r.Wz)();return(0,Q.tZ)(i.s8,{bgt:"light",sx:{undefined:void 0,boxShadow:e?"0px 0px 0px 2px green inset":void 0},children:(0,Q.BX)(l.Z,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(i.s8,{sx:{p:1,flexGrow:1},children:(0,Q.tZ)(be.Z,{variant:"h6",children:"Equipped"})}),(0,Q.tZ)(W.Z,{disabled:!0,color:"info",size:"small",children:(0,Q.tZ)(Ys.Z,{})}),(0,Q.tZ)(W.Z,{color:"success",size:"small",disabled:e,onClick:()=>s.teamChars.set(t,{buildType:"equipped"}),children:(0,Q.tZ)(Us.Z,{})}),(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:()=>s.teamChars.newBuild(t,{name:"Duplicate of Equipped",artifactIds:n,weaponId:a}),children:(0,Q.tZ)(Ze.Z,{})})]}),(0,Q.tZ)(ho,{weaponId:a,artifactIds:n})]})})}function uo({buildId:e,active:t=!1}){const[n,a,s]=(0,y.aV)(),{teamCharId:o}=(0,c.useContext)(g.V),d=(0,r.Wz)(),{name:u,description:h,weaponId:Z,artifactIds:p}=(0,r.rO)(e);return(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(i.AB,{open:n,onClose:s,children:(0,Q.tZ)(Zo,{buildId:e,onClose:s})}),(0,Q.tZ)(i.s8,{bgt:"light",sx:{undefined:void 0,boxShadow:t?"0px 0px 0px 2px green inset":void 0},children:(0,Q.BX)(l.Z,{sx:{p:1,display:"flex",flexDirection:"column",gap:1},children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(i.s8,{sx:{p:1,flexGrow:1},children:(0,Q.tZ)(i.eN,{title:(0,Q.tZ)(be.Z,{children:h}),children:(0,Q.BX)(l.Z,{component:"span",sx:{display:"flex",gap:1,alignItems:"center"},children:[(0,Q.tZ)(be.Z,{variant:"h6",children:u}),(0,Q.tZ)(Tl.Z,{})]})})}),(0,Q.tZ)(W.Z,{color:"info",size:"small",onClick:a,children:(0,Q.tZ)(Ys.Z,{})}),(0,Q.tZ)(W.Z,{color:"success",size:"small",disabled:!Z||t,onClick:()=>d.teamChars.set(o,{buildType:"real",buildId:e}),children:(0,Q.tZ)(Us.Z,{})}),(0,Q.tZ)(W.Z,{color:"error",size:"small",onClick:()=>{d.builds.remove(e),d.teamChars.set(o,{})},children:(0,Q.tZ)(me.Z,{})})]}),(0,Q.tZ)(ho,{weaponId:Z,artifactIds:p})]})})]})}function ho({weaponId:e,artifactIds:t}){const{character:{key:n}}=(0,c.useContext)(g.V),i=(0,Hs.Ru)(n).weaponType;return(0,Q.BX)(Xe.ZP,{container:!0,spacing:1,columns:{xs:2,sm:2,md:3,lg:6,xl:6},children:[(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Di.Z,{weaponId:e,weaponTypeKey:i})}),Object.entries(t).map((([e,t])=>(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:(0,Q.tZ)(Mi.Z,{artifactId:t,slotKey:e})},t||e)))]})}function Zo({buildId:e,onClose:t}){const{character:{key:n}}=(0,c.useContext)(g.V),a=(0,Hs.Ru)(n).weaponType,s=(0,r.Wz)(),d=(0,r.rO)(e),[u,Z]=(0,c.useState)(d.name),p=(0,c.useDeferredValue)(u),[m,f]=(0,c.useState)(d.description),x=(0,c.useDeferredValue)(m);return(0,c.useEffect)((()=>{const{name:t,description:n}=s.builds.get(e);Z(t),f(n)}),[s,e]),(0,c.useEffect)((()=>{s.builds.set(e,(e=>{e.name=p}))}),[s,p]),(0,c.useEffect)((()=>{s.builds.set(e,(e=>{e.description=x}))}),[s,x]),(0,Q.BX)(i.s8,{children:[(0,Q.tZ)(Re.Z,{title:"Build Settings",action:(0,Q.tZ)(h.Z,{onClick:t})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,Q.tZ)(Se.Z,{fullWidth:!0,label:"Build Name",placeholder:"Build Name",value:u,onChange:e=>Z(e.target.value)}),(0,Q.tZ)(Se.Z,{fullWidth:!0,label:"Build Description",placeholder:"Build Description",value:m,onChange:e=>f(e.target.value),multiline:!0,rows:4}),(0,Q.tZ)(l.Z,{children:(0,Q.tZ)(io,{weaponTypeKey:a,weaponId:d.weaponId,artifactIds:d.artifactIds,setWeapon:t=>s.builds.set(e,{weaponId:t}),setArtifact:(t,n)=>s.builds.set(e,(e=>{e.artifactIds[t]=n}))})})]})]})}let po,mo=e=>e;function fo({tab:e,onClose:t}){return(0,Q.BX)(Q.HY,{children:[(0,Q.BX)(l.Z,{display:"flex",children:[(0,Q.BX)(l.Z,{display:"flex",gap:1,flexWrap:"wrap",flexGrow:1,children:[(0,Q.tZ)(oo,{}),(0,Q.tZ)(bo,{}),(0,Q.tZ)(et,{}),(0,Q.tZ)(yo,{})]}),!!t&&(0,Q.tZ)(h.Z,{onClick:t})]}),(0,Q.BX)(l.Z,{display:"flex",gap:1,flexWrap:"wrap",children:[(0,Q.tZ)(de,{size:"small"}),(0,Q.tZ)(oe,{}),(0,Q.tZ)(ce,{size:"small"})]}),(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(xo,{tab:e})}),(0,Q.tZ)(go,{}),(0,Q.tZ)(G.Z,{children:(0,Q.tZ)(xo,{tab:e})})]})}function go(){return(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:500}),children:(0,Q.BX)(u.Z5,{children:[(0,Q.tZ)(u.AW,{index:!0,element:(0,Q.tZ)(Gr,{})}),(0,Q.tZ)(u.AW,{path:"/talent",element:(0,Q.tZ)(Qr,{})}),(0,Q.tZ)(u.AW,{path:"/teambuffs",element:(0,Q.tZ)(rl,{})}),(0,Q.tZ)(u.AW,{path:"/optimize",element:(0,Q.tZ)(sr,{})}),(0,Q.tZ)(u.AW,{path:"/theorycraft",element:(0,Q.tZ)(fs,{})}),T.dG&&(0,Q.tZ)(u.AW,{path:"/upopt",element:(0,Q.tZ)(Fs,{})})]})})}function xo({tab:e}){const{t}=(0,d.$G)("page_character"),n=T.dG?{minWidth:"16.6%"}:{minWidth:"20%"};return(0,Q.BX)(R.Z,{value:e,variant:"scrollable",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"}},children:[(0,Q.tZ)(L.Z,{sx:n,value:"overview",label:t("tabs.overview"),icon:(0,Q.tZ)(P.Z,{}),component:V.rU,to:""}),(0,Q.tZ)(L.Z,{sx:n,value:"talent",label:t("tabs.talent"),icon:(0,Q.tZ)(M.Z,{}),component:V.rU,to:"talent"}),(0,Q.tZ)(L.Z,{sx:n,value:"teambuffs",label:t("tabs.teambuffs"),icon:(0,Q.tZ)(K.Z,{}),component:V.rU,to:"teambuffs"}),(0,Q.tZ)(L.Z,{sx:n,value:"optimize",label:t("tabs.optimize"),icon:(0,Q.tZ)(D.Z,{}),component:V.rU,to:"optimize"}),(0,Q.tZ)(L.Z,{sx:n,value:"theorycraft",label:t("tabs.theorycraft"),icon:(0,Q.tZ)(A.Z,{}),component:V.rU,to:"theorycraft"}),T.dG&&(0,Q.tZ)(L.Z,{sx:n,value:"upopt",label:t("tabs.upgradeopt"),icon:(0,Q.tZ)(D.Z,{}),component:V.rU,to:"upopt"})]})}function bo(){const{t:e}=(0,d.$G)("page_character"),[t,n,i]=(0,y.aV)(),{teamChar:{bonusStats:a}}=(0,c.useContext)(g.V),r=Object.keys(a).length;return(0,Q.BX)(Q.HY,{children:[(0,Q.BX)(W.Z,{color:"info",startIcon:(0,Q.tZ)(_.Z,{}),onClick:n,children:[e(po||(po=mo`addStats.title`)),!!r&&(0,Q.tZ)(J.Z,{sx:{ml:1},color:"success",children:r})]}),(0,Q.tZ)(zt,{open:t,onClose:i})]})}function yo(){const{onModalOpen:e}=(0,c.useContext)(p.M);return(0,Q.BX)(Q.HY,{children:[(0,Q.BX)(W.Z,{color:"info",startIcon:(0,Q.tZ)(z.Z,{}),onClick:e,children:["Formulas ","&"," Calcs"]}),(0,Q.tZ)(Zt,{})]})}var vo=n(96703);function Co({teamId:e,currentCharIndex:t,setCurrentCharIndex:n}){const i=(0,r.Wz)(),a=i.teams.get(e),{characterIds:s}=a,[o,d]=(0,c.useState)(void 0),u=s.map((e=>i.teamChars.get(e).key));return(0,Q.BX)(l.Z,{children:[(0,Q.tZ)(c.Suspense,{fallback:!1,children:(0,Q.tZ)(vo.Z,{filter:e=>!!i.chars.get(null==e?void 0:e.key)&&!u.includes(null==e?void 0:e.key),show:void 0!==o,onHide:()=>d(void 0),onSelect:t=>{if(void 0===o)return;const n=i.teamChars.new(t);i.teams.set(e,(e=>{e.characterIds[o]=n}))}})}),(0,Q.tZ)(Xe.ZP,{container:!0,columns:4,spacing:1,children:(0,v.w6)(0,3).map((a=>{return(0,Q.tZ)(Xe.ZP,{item:!0,xs:1,children:s[a]?(0,Q.tZ)(wo,{teamCharId:s[a],active:t===a,onClick:()=>n(a),onClose:(r=a,()=>{const t=s[r];i.teams.set(e,(e=>{e.characterIds[r]=void 0})),i.teamChars.remove(t)})}):(0,Q.tZ)(W.Z,{onClick:()=>d(a),fullWidth:!0,sx:{height:"100%"},disabled:a!==s.length,startIcon:(0,Q.tZ)(he.Z,{}),children:"Add Character"})},a);var r}))})]})}function wo({teamCharId:e,onClick:t,onClose:n,active:i=!1}){const a=(0,r.Wz)(),{key:l}=a.teamChars.get(e),{gender:s}=(0,r.Hz)();return(0,Q.BX)(we.Z,{fullWidth:!0,sx:{height:"100%"},children:[(0,Q.tZ)(W.Z,{onClick:t,sx:{height:"100%"},color:i?"success":"primary",startIcon:(0,Q.tZ)(nl.Z,{characterKey:l}),children:(0,Q.tZ)(hl.EE,{characterKey:l,gender:s})}),(0,Q.tZ)(W.Z,{onClick:n,color:"error",sx:{flexBasis:"0",height:"100%"},size:"small",children:(0,Q.tZ)(fl.Z,{})})]})}var Bo=n(91267);function ko({teamId:e}){const[t,n]=(0,c.useState)(!1),a=(0,r.Wz)(),s=a.teams.get(e),[d,u]=(0,c.useState)(s.name),Z=(0,c.useDeferredValue)(d),[p,m]=(0,c.useState)(s.description),f=(0,c.useDeferredValue)(p);return(0,c.useEffect)((()=>{const{name:t,description:n}=a.teams.get(e);u(t),m(n)}),[a,e]),(0,c.useEffect)((()=>{a.teams.set(e,(e=>{e.name=Z}))}),[a,Z]),(0,c.useEffect)((()=>{a.teams.set(e,(e=>{e.description=f}))}),[a,f]),(0,Q.BX)(Q.HY,{children:[(0,Q.tZ)(l.Z,{display:"flex",gap:1,alignItems:"center",children:(0,Q.tZ)(i.eN,{title:(0,Q.tZ)(be.Z,{children:s.description}),children:(0,Q.tZ)(W.Z,{endIcon:(0,Q.tZ)(Bo.Z,{}),onClick:()=>n((e=>!e)),children:(0,Q.tZ)(be.Z,{variant:"h6",children:s.name})})})}),(0,Q.tZ)(i.AB,{open:t,onClose:()=>n(!1),children:(0,Q.BX)(i.s8,{children:[(0,Q.tZ)(Re.Z,{title:"Team Settings",action:(0,Q.tZ)(h.Z,{onClick:()=>n(!1)})}),(0,Q.tZ)(De.Z,{}),(0,Q.BX)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,Q.tZ)(Se.Z,{fullWidth:!0,label:"Team Name",placeholder:"Team Name",value:d,onChange:e=>u(e.target.value)}),(0,Q.tZ)(Se.Z,{fullWidth:!0,label:"Team Description",placeholder:"Team Description",value:p,onChange:e=>m(e.target.value),multiline:!0,rows:4})]})]})})]})}function So(){const e=(0,u.s0)(),t=(0,r.Wz)(),n=(0,c.useCallback)((()=>e("/teams")),[e]),{teamId:i}=(0,u.UO)();return!t.teams.keys.includes(i)?(0,Q.tZ)(u.Fg,{to:"/characters"}):(0,Q.tZ)(l.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:(0,Q.tZ)(c.Suspense,{fallback:(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:1e3}),children:i&&(0,Q.tZ)(Xo,{teamId:i,onClose:n})})})}function Xo({teamId:e,onClose:t}){var n,b;const{silly:y}=(0,c.useContext)(f.E),{gender:v}=(0,r.Hz)(),[C,w]=(0,c.useState)(0),B=(0,r.t7)(e),{characterIds:k}=B,{params:{tab:S="overview"}}=null!=(n=(0,u.bS)({path:"/teams/:teamId/:tab",end:!1}))?n:{params:{tab:"overview"}},X=k[C],T=(0,r.rX)(X),O=null==T?void 0:T.key,{t:E}=(0,d.$G)(["sillyWisher_charNames","charNames_gen","page_character"]);(0,I.Z)((0,c.useMemo)((()=>`${B.name} - ${E(`${y?"sillyWisher_charNames":"charNames_gen"}:${(0,a.Cs)(O,v)}`)} - ${E(`page_character:tabs.${S}`)}`),[E,B.name,y,O,v,S]));const P=j(e),M=(0,x.m)(O,v),K=(0,r.AU)(O),{target:D}=null!=(b=null==P?void 0:P[O])?b:{},A=(0,c.useMemo)((()=>{if(P&&D)return{data:D,teamData:P,oldData:void 0}}),[D,P]),_=(0,c.useMemo)((()=>{if(K&&M)return{teamId:e,team:B,teamCharId:X,teamChar:T,character:K,characterSheet:M}}),[e,B,X,T,K,M]),[z,R]=(0,c.useState)(void 0),[L,W]=(0,c.useState)(),V=(0,c.useMemo)((()=>({chartData:z,setChartData:R,graphBuilds:L,setGraphBuilds:W})),[z,L]);return(0,Q.tZ)(i.s8,{children:(0,Q.BX)(o.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,Q.BX)(l.Z,{sx:{display:"flex",gap:1},children:[(0,Q.tZ)(l.Z,{flexGrow:1,children:(0,Q.tZ)(ko,{teamId:e})}),(0,Q.tZ)(h.Z,{onClick:t})]}),(0,Q.tZ)(Co,{teamId:e,currentCharIndex:C,setCurrentCharIndex:w}),A&&_&&V?(0,Q.tZ)(g.V.Provider,{value:_,children:(0,Q.tZ)(Z.R.Provider,{value:A,children:(0,Q.tZ)(m.V.Provider,{value:V,children:(0,Q.tZ)(p.B,{children:(0,Q.tZ)(fo,{tab:S})})})})}):(0,Q.tZ)(s.Z,{variant:"rectangular",width:"100%",height:1e3})]})})}}}]);