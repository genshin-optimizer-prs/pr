"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[656],{37656:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var r=a(45492),n=a(42745),s=a(31653),l=a(83568),c=a(15944),i=a(46342),o=a(93553),h=a(67550),u=a(7671),p=a(41075),d=a(13780),Z=a(83249),g=a(79906),y=a(56961),m=a(2784),f=a(61877),x=a(11141),w=a(73557),C=a(24264),b=a(18835),v=a(14083),k=a(96703),P=a(66146),W=a(42090),I=a(89279),T=a(28265),S=a(44180),K=a(25616);var N=a(64303),$=a(2313),j=a(52903);let z,B=e=>e;const M={xs:1,sm:2,md:3,lg:4,xl:4},E={xs:6,sm:8,md:12,lg:16,xl:16},V=Object.keys(N.V3);function _(){var e;const t=(0,l.Wz)(),a=(0,w.s0)(),{params:{characterKey:_}}=null!=(e=(0,w.bS)({path:"/characters/:characterKey",end:!1}))?e:{params:{}},D=(0,m.useMemo)((()=>{if(!_)return null;if(!s.IV.includes(_))return a("/characters"),null;return t.chars.get(_)||t.chars.getWithInitWeapon(D),_}),[_,a,t]),{t:L}=(0,x.$G)(["page_character","sillyWisher_charNames","charNames_gen"]),{silly:X}=(0,m.useContext)(c.E6),[H,O]=(0,m.useState)((()=>t.displayCharacter.get()));(0,m.useEffect)((()=>t.displayCharacter.follow(((e,t)=>O(t)))),[t,O]);const[A,G]=(0,m.useState)(""),F=(0,m.useDeferredValue)(A),U=(0,m.useRef)(null),q=(0,m.useCallback)(((e,a)=>{var r;null==(r=U.current)||r.scrollIntoView({behavior:"smooth"}),t.displayCharacter.set({pageIndex:a-1})}),[t,U]),J=(0,r.JT)(),R=E[J],[Y,Q]=(0,m.useState)(!1),[ee,te]=(0,r.NW)();(0,m.useEffect)((()=>(f.ZP.send({hitType:"pageview",page:"/characters"}),t.chars.followAny(((e,t)=>("new"===t||"remove"===t)&&te())))),[te,t]),(0,m.useEffect)((()=>t.charMeta.followAny((e=>te()))),[te,t]);const{gender:ae}=(0,l.Hz)(),re=(0,m.useCallback)((async e=>{let a=(0,S.m)(e,ae).name;"object"==typeof a&&(a=L(`${X?"sillyWisher_charNames":"charNames_gen"}:${(0,s.Cs)(e,ae)}`)),window.confirm(L("removeCharacter",{value:a}))&&t.chars.remove(e)}),[t.chars,ae,X,L]),ne=function(){var e;const t=(0,l.Wz)(),a=(0,w.s0)(),{params:{tab:r=""}}=null!=(e=(0,w.bS)({path:"/characters/:charKey/:tab",end:!1}))?e:{params:{tab:""}};return(0,m.useCallback)((e=>{const n=t.chars.get(e);let s=r;n||(t.chars.getWithInitWeapon(e),s=""),a(`/characters/${e}/${s}`)}),[a,t,r])}(),se=(0,m.useDeferredValue)(H),le=(0,m.useDeferredValue)(ee),{charKeyList:ce,totalCharNum:ie}=(0,m.useMemo)((()=>{var e;const a=t.chars.keys.length,{element:r,weaponType:s,rarity:l,sortType:c,ascending:i}=se,o=t.chars.keys.filter((0,n.CZ)({element:r,weaponType:s,rarity:l,name:F},(0,N.zU)(t,X))).sort((0,n.ef)(null!=(e=N.V3[c])?e:[],i,(0,N._L)(t,X),["new","favorite"]));return le&&{charKeyList:o,totalCharNum:a}}),[t,se,F,X,le]),{weaponType:oe,element:he,rarity:ue,sortType:pe,ascending:de,pageIndex:Ze=0}=H,{charKeyListToShow:ge,numPages:ye,currentPageIndex:me}=(0,m.useMemo)((()=>{const e=Math.ceil(ce.length/R),t=(0,n.re)(Ze,0,e-1);return{charKeyListToShow:ce.slice(t*R,(t+1)*R),numPages:e,currentPageIndex:t}}),[ce,Ze,R]),fe=ce.length!==ie?`${ce.length}/${ie}`:`${ie}`,xe=(0,m.useMemo)((()=>(0,$.W)(s.yd,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=t.weapons.get(r.equippedWeapon);if(!n)return;const s=(0,K.ub)(n.key).weaponType;e[s].total++,ce.includes(a)&&e[s].current++}))))),[t,ce]),we=(0,m.useMemo)((()=>(0,$.W)(s.UB,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=(0,S.m)(r.key,t.gender).elementKey;e[n].total++,ce.includes(a)&&e[n].current++}))))),[t,ce]),Ce=(0,m.useMemo)((()=>(0,$.W)(s.ZI,(e=>Object.entries(t.chars.data).forEach((([a,r])=>{const n=(0,S.m)(r.key,t.gender).rarity;e[n].total++,ce.includes(a)&&e[n].current++}))))),[t,ce]),be={count:ye,page:me+1,onChange:q},ve={numShowing:ge.length,total:fe,t:L,namespace:"page_character"},ke={sortKeys:[...V],value:pe,onChange:e=>t.displayCharacter.set({sortType:e}),ascending:de,onChangeAsc:e=>t.displayCharacter.set({ascending:e})};return(0,j.BX)(h.Z,{my:1,display:"flex",flexDirection:"column",gap:1,children:[(0,j.tZ)(v.Z,{characterKey:D,onClose:()=>a("/characters")}),(0,j.tZ)(m.Suspense,{fallback:!1,children:(0,j.tZ)(k.Z,{newFirst:!0,show:Y,onHide:()=>Q(!1),onSelect:ne})}),(0,j.tZ)(C.Z,{ref:U,children:(0,j.BX)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,j.BX)(p.ZP,{container:!0,spacing:1,children:[(0,j.tZ)(p.ZP,{item:!0,children:(0,j.tZ)(T.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({weaponType:e}),value:oe,totals:xe,size:"small"})}),(0,j.tZ)(p.ZP,{item:!0,children:(0,j.tZ)(I.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({element:e}),value:he,totals:we,size:"small"})}),(0,j.tZ)(p.ZP,{item:!0,children:(0,j.tZ)(W.Z,{sx:{height:"100%"},onChange:e=>t.displayCharacter.set({rarity:e}),value:ue,totals:Ce,size:"small"})}),(0,j.tZ)(p.ZP,{item:!0,flexGrow:1}),(0,j.tZ)(p.ZP,{item:!0,children:(0,j.tZ)(d.Z,{autoFocus:!0,value:A,onChange:e=>G(e.target.value),label:L("characterName"),size:"small",sx:{height:"100%"},InputProps:{sx:{height:"100%"}}})})]}),(0,j.tZ)(h.Z,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:(0,j.tZ)(P.Z,{paginationProps:be,showingTextProps:ve,displaySort:!0,sortByButtonProps:ke})})]})}),(0,j.tZ)(Z.Z,{fullWidth:!0,onClick:()=>Q(!0),color:"info",startIcon:(0,j.tZ)(o.Z,{}),children:L(z||(z=B`addNew`))}),(0,j.tZ)(m.Suspense,{fallback:(0,j.tZ)(g.Z,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:(0,j.tZ)(p.ZP,{container:!0,spacing:1,columns:M,children:ge.map((e=>(0,j.tZ)(p.ZP,{item:!0,xs:1,children:(0,j.tZ)(b.Z,{characterKey:e,onClick:()=>a(`${e}`),footer:(0,j.BX)(j.HY,{children:[(0,j.tZ)(y.Z,{}),(0,j.tZ)(h.Z,{sx:{py:1,px:2,display:"flex",gap:1,justifyContent:"space-between"},children:(0,j.tZ)(Z.Z,{fullWidth:!0,color:"error",onClick:()=>re(e),startIcon:(0,j.tZ)(i.Z,{}),children:L("delete")})})]})})},e)))})}),ye>1&&(0,j.tZ)(C.Z,{children:(0,j.BX)(u.Z,{sx:{display:"flex",flexDirection:"row",gap:1},children:[(0,j.tZ)(Z.Z,{onClick:()=>Q(!0),color:"info",sx:{minWidth:0},children:(0,j.tZ)(o.Z,{})}),(0,j.tZ)(h.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",flexGrow:1,children:(0,j.tZ)(P.Z,{paginationProps:be,showingTextProps:ve})})]})})]})}}}]);