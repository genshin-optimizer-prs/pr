import{Q as O,e as a,n as i,J as n,p as t,T as w,B as A,t as D,C as m,D as U,U as K,V as ot,r as st,i as lt,j as ct,u as P,b as L,N as C,_ as V,W as St,s as ut,X as dt,K as q,Y as _t,Z as It,$ as Pt,M as Tt,R as ft,a0 as Et}from"./index-195ef3cd.js";import{u as Mt,A as Ft,P as at}from"./LocationAutocomplete-aca95dd9.js";import{f as $t,s as Rt}from"./StarDisplay-350fc356.js";import{d as ht,A as pt,a as jt,b as qt,p as Ut,c as Kt,e as it}from"./ArtifactSort-8971f1b0.js";import{S as Lt,A as Ot}from"./StatEditorList-6f0af10d.js";import{d as Wt}from"./BootstrapTooltip-7758b165.js";import{C as W}from"./CloseButton-5c9b1c20.js";import{T as Vt}from"./index-09a8d5ff.js";import{u as mt}from"./useDisplayArtifact-cc567f21.js";import{d as Bt,a as zt}from"./LockOpen-f0462ff7.js";import{S as j}from"./SqBadge-702da3c1.js";import{C as Gt}from"./ColoredText-02831cf8.js";import"./DropdownButton-c75ceb66.js";import"./SlotIcon-b76f9be8.js";import"./InfoTooltip-f4da1b36.js";import"./index-9583fde3.js";import"./Artifact-13f9d257.js";import"./CardActionArea-5feeeed2.js";import"./Link-f8490749.js";const Nt=r=>r[Math.floor(Math.random()*r.length)];function Ht({pageKey:r,text:e="",modalTitle:o="",children:u}){const[f,p,c]=O(localStorage.getItem(`infoShown_${r}`)!=="true"),[d]=a.useState(Array.isArray(e)?Nt(e):e),y=a.useCallback(()=>{c(),localStorage.setItem(`infoShown_${r}`,"true")},[c,r]);return i(D,{children:[i(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(w,{variant:"caption",pl:1,children:d})}),t(n,{item:!0,xs:"auto",children:t(A,{size:"small",color:"info",variant:"contained",onClick:p,startIcon:t(Wt,{}),children:t(Vt,{ns:"ui",key18:"info"})})})]}),t(ot,{containerProps:{maxWidth:"xl"},open:f,onClose:y,children:i(D,{children:[t(m,{sx:{py:1},children:i(n,{container:!0,children:[t(n,{item:!0,flexGrow:1,children:t(w,{variant:"h6",children:o})}),t(n,{item:!0,children:t(W,{onClick:y})})]})}),t(U,{}),t(m,{children:t(a.Suspense,{fallback:t(K,{variant:"rectangular",width:"100%",height:500}),children:u})}),t(U,{}),t(m,{sx:{py:1},children:t(W,{large:!0,onClick:y})})]})})]})}var B={},Qt=lt;Object.defineProperty(B,"__esModule",{value:!0});var yt=B.default=void 0,Xt=Qt(st()),Jt=ct,Yt=(0,Xt.default)((0,Jt.jsx)("path",{d:"M8.65 5.82C9.36 4.72 10.6 4 12 4c2.21 0 4 1.79 4 4 0 1.4-.72 2.64-1.82 3.35L8.65 5.82zM20 17.17c-.02-1.1-.63-2.11-1.61-2.62-.54-.28-1.13-.54-1.77-.76L20 17.17zm1.19 4.02L2.81 2.81 1.39 4.22l8.89 8.89c-1.81.23-3.39.79-4.67 1.45-1 .51-1.61 1.54-1.61 2.66V20h13.17l2.61 2.61 1.41-1.42z"}),"PersonOff");yt=B.default=Yt;var z={},Zt=lt;Object.defineProperty(z,"__esModule",{value:!0});var gt=z.default=void 0,te=Zt(st()),ee=ct,re=(0,te.default)((0,ee.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");gt=z.default=re;const ae=a.lazy(()=>V(()=>import("./ArtifactFilterDisplay-2acc7770.js").then(r=>r.b),["./ArtifactFilterDisplay-2acc7770.js","./index-195ef3cd.js","./index-0e21804b.css","./LockOpen-f0462ff7.js","./useDisplayArtifact-cc567f21.js","./totalUtils-d107b6bc.js","./BootstrapTooltip-7758b165.js","./StarDisplay-350fc356.js","./DropdownButton-c75ceb66.js","./ColoredText-02831cf8.js","./index-09a8d5ff.js","./SqBadge-702da3c1.js","./ArtifactStatKeyDisplay-738a64d4.js","./Artifact-13f9d257.js","./LocationAutocomplete-aca95dd9.js","./index-9583fde3.js","./SlotIcon-b76f9be8.js"],import.meta.url));function ie({numShowing:r,total:e,artifactIds:o}){const{t:u}=P(["artifact","ui"]),f=L(),{filterOption:p}=mt(),c=a.useCallback(d=>f.displayArtifact.set({filterOption:{...p,...d}}),[f,p]);return t(a.Suspense,{fallback:t(K,{variant:"rectangular",width:"100%",height:300}),children:t(D,{children:i(m,{children:[i(n,{container:!0,children:[t(n,{item:!0,children:t(w,{variant:"h6",children:t(C,{t:u,i18nKey:"artifactFilter",children:"Artifact Filter"})})}),t(n,{item:!0,flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center",children:r!==e&&i(w,{children:["Filtered ",t("strong",{children:r})," / ",e]})}),t(n,{item:!0,children:t(A,{size:"small",color:"error",onClick:()=>f.displayArtifact.set({action:"reset"}),startIcon:t(gt,{}),children:t(C,{t:u,i18nKey:"ui:reset"})})})]}),t(a.Suspense,{fallback:t(K,{variant:"rectangular",width:"100%",height:200}),children:t(ae,{filterOption:p,filterOptionDispatch:c,filteredIds:o})})]})})})}function ne({artifactIds:r}){const{t:e}=P(["artifact","ui"]),o=L(),{numDelete:u,numUnequip:f,numUnlock:p,numLock:c}=a.useMemo(()=>{const l=r.map(b=>o.arts.get(b)),h=l.reduce((b,I)=>b+(I.lock?0:1),0),S=l.length-h,_=h,v=l.reduce((b,I)=>b+(I.location?1:0),0);return{numDelete:_,numUnequip:v,numUnlock:h,numLock:S}},[r,o]);return i(n,{container:!0,spacing:1,alignItems:"center",children:[t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!f,onClick:()=>window.confirm(`Are you sure you want to unequip ${f} artifacts currently equipped on characters?`)&&r.map(l=>o.arts.set(l,{location:""})),startIcon:t(yt,{}),children:[t(C,{t:e,i18nKey:"button.unequipArtifacts",children:"Unequip Artifacts"}),t(j,{sx:{ml:1},color:f?"success":"secondary",children:f})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!u,onClick:()=>window.confirm(`Are you sure you want to delete ${u} artifacts?`)&&r.map(l=>{var h;return!((h=o.arts.get(l))!=null&&h.lock)&&o.arts.remove(l)}),startIcon:t(St,{}),children:[t(C,{t:e,i18nKey:"button.deleteArtifacts",children:"Delete Artifacts"}),t(j,{sx:{ml:1},color:u?"success":"secondary",children:u})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!c,onClick:()=>window.confirm(`Are you sure you want to unlock ${c} artifacts?`)&&r.map(l=>o.arts.set(l,{lock:!1})),startIcon:t(Bt,{}),children:[t(C,{t:e,i18nKey:"button.unlockrtifacts",children:"Unlock Artifacts"}),t(j,{sx:{ml:1},color:c?"success":"secondary",children:c})]})}),t(n,{item:!0,xs:12,sm:6,md:3,children:i(A,{fullWidth:!0,color:"error",disabled:!p,onClick:()=>window.confirm(`Are you sure you want to lock ${p} artifacts?`)&&r.map(l=>o.arts.set(l,{lock:!0})),startIcon:t(zt,{}),children:[t(C,{t:e,i18nKey:"button.lockArtifacts",children:"Lock Artifacts"}),t(j,{sx:{ml:1},color:p?"success":"secondary",children:p})]})}),t(n,{item:!0,xs:12,display:"flex",justifyContent:"space-around",children:t(w,{variant:"caption",color:"text.secondary",children:i(C,{t:e,i18nKey:"buttonHint",children:["Note: the red buttons above only apply to",t("b",{children:"currently filtered artifacts"})]})})})]})}function oe({show:r,onHide:e}){const{t:o}=P("artifact");return t(ot,{open:r,onClose:e,children:i(ut,{children:[i(m,{sx:{display:"flex",alignItems:"center"},children:[i(w,{variant:"h6",flexGrow:1,children:[t(ht,{sx:{verticalAlign:"text-top",mr:1}}),o`showDup`]}),t(W,{onClick:e})]}),t(U,{}),t(m,{children:t(se,{})})]})})}function se(){const{t:r}=P("artifact"),e=L(),[o,u]=dt();a.useEffect(()=>e.arts.followAny(u),[u,e]);const f=a.useMemo(()=>{const c=o&&[];let d=e.arts.keys;for(;d.length!==0;){const y=d.shift();if(!y)continue;const T=e.arts.get(y);if(!T)continue;const{duplicated:g}=e.arts.findDups(T,d);if(!g.length)continue;const l=g.map(h=>h.id);c.push([y,...l].sort(h=>{var S;return((S=e.arts.get(h))==null?void 0:S.location)??""?-1:1})),d=d.filter(h=>!l.includes(h))}return c},[e,o]),p=a.useMemo(()=>({}),[]);return i(It,{spacing:2,children:[f.map(c=>t(D,{sx:{overflowX:"scroll"},children:t(m,{sx:{display:"flex",gap:1},children:c.map(d=>t(q,{sx:{minWidth:300},children:t(pt,{artifactId:d,canEquip:!0,onDelete:()=>e.arts.remove(d),editorProps:p})},d))})},c.join())),!f.length&&t(_t,{variant:"filled",severity:"success",children:r`noDupAlert`})]})}const le=[...Pt];function ce({probabilityFilter:r={},setProbabilityFilter:e,disabled:o=!1}){const{t:u}=P("artifact");return i(D,{children:[t(m,{sx:{py:1},children:t(w,{variant:"h6",children:"Roll Probability Calculator"})}),t(U,{}),t(m,{children:i(n,{container:!0,spacing:1,children:[t(n,{item:!0,xs:12,md:6,children:t(ut,{children:t(m,{children:i(w,{children:['This UI only pops up when "Sort by"',t("strong",{children:"Probability"}),". In conjunction with the Artifact Filters above, this UI allows you to set a criteria for substats values, and it will sort the artifacts by those with the highest probability to roll into those criteria values.",i(Gt,{color:"warning",children:[" ","Artifacts that already reach the criteria(100%) or are at 0% are hidden."]})]})})})}),t(n,{item:!0,xs:12,md:6,spacing:1,sx:{display:"flex",flexDirection:"column",gap:1},children:t(Lt,{statKeys:le,statFilters:r,setStatFilters:e,disabled:o,label:u("probabilityFilter.label")})})]})})]})}const ue=ft.lazy(()=>V(()=>import("./ArtifactEditor-e5cb71d5.js"),["./ArtifactEditor-e5cb71d5.js","./index-195ef3cd.js","./index-0e21804b.css","./ArtifactRarityDropdown-597e7177.js","./index-9583fde3.js","./index-09a8d5ff.js","./ColoredText-02831cf8.js","./SqBadge-702da3c1.js","./LocationAutocomplete-aca95dd9.js","./StarDisplay-350fc356.js","./DropdownButton-c75ceb66.js","./ArtifactStatKeyDisplay-738a64d4.js","./Artifact-13f9d257.js","./BootstrapTooltip-7758b165.js","./LockOpen-f0462ff7.js","./SlotIcon-b76f9be8.js","./CloseButton-5c9b1c20.js","./ArtifactSort-8971f1b0.js","./InfoTooltip-f4da1b36.js","./CardActionArea-5feeeed2.js","./TextButton-0e4ede1f.js","./CardHeader-a63af426.js","./ChevronRight-3beaacf4.js"],import.meta.url)),de=ft.lazy(()=>V(()=>import("./index-c8bef5f7.js"),["./index-c8bef5f7.js","./index-195ef3cd.js","./index-0e21804b.css","./Settings-f7a2863d.js","./StarDisplay-350fc356.js","./DropdownButton-c75ceb66.js","./ColoredText-02831cf8.js","./index-09a8d5ff.js","./SqBadge-702da3c1.js","./ImgFullwidth-79f9978e.js","./ArtifactSort-8971f1b0.js","./LocationAutocomplete-aca95dd9.js","./BootstrapTooltip-7758b165.js","./SlotIcon-b76f9be8.js","./InfoTooltip-f4da1b36.js","./index-9583fde3.js","./Artifact-13f9d257.js","./CardActionArea-5feeeed2.js","./Link-f8490749.js"],import.meta.url)),nt={xs:1,sm:2,md:3,lg:3,xl:4},fe={xs:10,sm:12,md:24,lg:24,xl:24};function Fe(){const{t:r}=P(["artifact","ui"]),e=L(),o=mt(),[u,f,p]=O(!1),[c,d,y]=O(!1),T=Mt(),g=fe[T],{sortType:l,effFilter:h,ascending:S,probabilityFilter:_}=o,v=l==="probability",[b,I]=a.useState(0),G=a.useRef(null),[bt,N]=dt(),H=a.useDeferredValue(bt),E=a.useMemo(()=>new Set(h),[h]),xt=a.useCallback(s=>e.arts.remove(s),[e]);a.useEffect(()=>(Tt.send({hitType:"pageview",page:"/artifact"}),e.arts.followAny(()=>N())),[e,N]);const At=a.useCallback(s=>e.displayArtifact.set({probabilityFilter:s}),[e]),wt=a.useMemo(()=>!e.arts.values.length,[e]),Q=a.useMemo(()=>jt(E,_),[E,_]),X=a.useMemo(()=>qt(E),[E]),J=a.useDeferredValue(o),Y=a.useDeferredValue(_);a.useEffect(()=>{if(v)return e.arts.values.forEach(s=>e.arts.setProbability(s.id,Ut(s,Y))),()=>e.arts.values.forEach(s=>e.arts.setProbability(s.id,-1))},[e,v,Y]);const{artifactIds:x,totalArtNum:M}=a.useMemo(()=>{const{sortType:s=it[0],ascending:k=!1,filterOption:F}=J;let $=e.arts.values;return v&&($=$.filter(R=>R.probability&&R.probability!==1)),{artifactIds:$.filter($t(F,X)).sort(Rt(Kt[s]??[],k,Q)).map(R=>R.id),totalArtNum:$.length,...H}},[J,H,e,Q,X,v]),{artifactIdsToShow:Z,numPages:tt,currentPageIndex:vt}=a.useMemo(()=>{const s=Math.ceil(x.length/g),k=Et(b,0,s-1);return{artifactIdsToShow:x.slice(k*g,(k+1)*g),numPages:s,currentPageIndex:k}},[x,b,g]),kt=x.length!==M?`${x.length}/${M}`:`${M}`,Ct=a.useCallback((s,k)=>{var F;(F=G.current)==null||F.scrollIntoView({behavior:"smooth"}),I(k-1)},[I,G]),et={count:tt,page:vt+1,onChange:Ct},rt={numShowing:Z.length,total:kt,t:r,namespace:"artifact"},Dt={sortKeys:[...it],value:l,onChange:s=>e.displayArtifact.set({sortType:s}),ascending:S,onChangeAsc:s=>e.displayArtifact.set({ascending:s})};return i(q,{display:"flex",flexDirection:"column",gap:1,my:1,children:[t(a.Suspense,{fallback:!1,children:t(ue,{artifactIdToEdit:u?"new":"",cancelEdit:p,allowUpload:!0,allowEmpty:!0})}),t(a.Suspense,{fallback:!1,children:t(oe,{show:c,onHide:y})}),t(Ht,{pageKey:"artifactPage",modalTitle:r`info.title`,text:r("tipsOfTheDay",{returnObjects:!0}),children:t(de,{})}),wt&&t(Ot,{}),t(ie,{numShowing:x.length,total:M,artifactIds:x}),t(D,{children:i(m,{children:[t(q,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(at,{paginationProps:et,showingTextProps:rt,displaySort:!0,sortByButtonProps:Dt})}),t(ne,{artifactIds:x})]})}),v&&t(ce,{probabilityFilter:_,setProbabilityFilter:At}),i(n,{container:!0,columns:nt,spacing:1,children:[t(n,{item:!0,xs:!0,children:t(A,{fullWidth:!0,onClick:f,color:"info",startIcon:t(Ft,{}),children:r`addNew`})}),t(n,{item:!0,xs:1,children:t(A,{fullWidth:!0,onClick:d,color:"info",startIcon:t(ht,{}),children:r`showDup`})})]}),t(a.Suspense,{fallback:t(K,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:t(n,{container:!0,spacing:1,columns:nt,children:Z.map(s=>t(n,{item:!0,xs:1,children:t(pt,{artifactId:s,effFilter:E,onDelete:xt,editorProps:{},canEquip:!0})},s))})}),tt>1&&t(D,{children:t(m,{children:t(q,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:t(at,{paginationProps:et,showingTextProps:rt})})})})]})}export{Fe as default};
