import{c as j,j as N,u as B,a as H,s as T,b as F,w as G,l as P,d as t,e as a,T as p,C as D,f as L,v as R,g as k,h as A,i as M,r as c,k as W,m as z,n as U,o as _,G as u,S as C,L as q,B as J,p as $,q as Q,t as O,F as X,x as Y,M as E,D as K,y as b,z as Z,A as V,E as ee,H as te,I as ne,J as se,K as v,N as oe}from"./index-ebc9b1db.js";const ie=j(N.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");function re({lightConeId:s}){const o=B(s),i=H(T,{member:"member0",et:"self"}),n=F(G("member0",...P(o)));return o?t(L,{children:a(D,{children:[a(p,{children:["Key: ",o.key]}),a(p,{children:["Level: ",o.level]}),a(p,{children:["Ascension: ",o.ascension]}),a(p,{children:["Superimpose: ",o.superimpose]}),a(p,{children:["ATK: ",n==null?void 0:n.compute(i.base.atk.src("lightCone")).val]}),a(p,{children:["HP: ",n==null?void 0:n.compute(i.base.hp.src("lightCone")).val]}),a(p,{children:["DEF: ",n==null?void 0:n.compute(i.base.def.src("lightCone")).val]})]})}):null}function ae(s,o){const n=(()=>{switch(o.type){case"reset":return;case"overwrite":return o.lightCone;case"update":return{...s,...o.lightCone}}})();return n&&R(n)}const S={superimpose:[1,2,3,4,5]};function le({lightConeIdToEdit:s="new"}){const{t:o}=k("lightCone"),{database:i}=A(),[n,l]=M();c.useEffect(()=>i.lightCones.followAny(l),[i,l]),c.useEffect(()=>{s==="new"&&d({type:"reset"});const r=s&&n&&i.lightCones.get(s);r&&d({type:"overwrite",lightCone:W(r)})},[s,i,n]);const[e,d]=c.useReducer(ae,void 0),g=e?S:void 0,m=c.useCallback(r=>{const h=r.key?S:g;function x(y,w,I){return y&&w.includes(y)?y:I??w[0]}r.key&&(r.superimpose=x(e==null?void 0:e.superimpose,h.superimpose,Math.min(...h.superimpose))),r.level&&(r.level=z(r.level,0,U)),d({type:"update",lightCone:r})},[e,g,d]),f=c.useCallback(()=>{d({type:"reset"})},[]);return c.useEffect(()=>{s==="new"&&d({type:"reset"})},[s]),t($,{children:a(L,{bgt:"dark",children:[t(_,{title:"Light Cone Editor"}),a(D,{sx:{display:"flex",flexDirection:"column",gap:1},children:[a(u,{container:!0,spacing:1,columns:{xs:1,md:2},children:[t(u,{item:!0,xs:1,md:!0,display:"flex",flexDirection:"column",children:t(ce,{lcKey:(e==null?void 0:e.key)??"",setLCKey:r=>m({key:r}),label:e!=null&&e.key?"":o("editor.unknownLightCone")})}),t(u,{item:!0,xs:!0,md:"auto",display:"flex",children:t(de,{superimpose:e==null?void 0:e.superimpose,setSuperimposition:r=>m({superimpose:r}),disabled:!e})})]}),a(u,{container:!0,spacing:1,columns:{xs:1,md:4},marginBottom:1,children:[t(u,{item:!0,xs:1,display:"flex",flexDirection:"row",gap:1,children:t(he,{level:e==null?void 0:e.level,ascension:e==null?void 0:e.ascension,setLevelAscension:(r,h)=>{m({level:r,ascension:h})},disabled:!e})}),t(u,{item:!0,xs:1,display:"flex",gap:1,children:t(L,{bgt:"light",sx:{p:1,flexGrow:1,alignContent:"center"},children:t(c.Suspense,{fallback:t(C,{width:"60%"}),children:a(p,{color:"text.secondary",align:"center",children:["Ascension ",(e==null?void 0:e.ascension)||0]})})})}),t(u,{item:!0,xs:1,md:2,display:"flex",flexDirection:"column",gap:1,children:t(q,{locKey:(e==null?void 0:e.location)??"",setLocKey:r=>m({location:r})})})]}),t(u,{children:t(J,{startIcon:t(ie,{}),onClick:()=>{i.lightCones.new(e),f()},disabled:!e,color:"primary",children:o`editor.btnAdd`})})]})]})})}function ce({lcKey:s,setLCKey:o,label:i=""}){const{t:n}=k(["lightCone","lightConeNames_gen"]);i=i||n("lightCone:autocompleteLabels.key");const l=c.useMemo(()=>Q.map(d=>({key:d,label:n(`lightConeNames_gen:${d}`)})),[n]),e=c.useCallback(d=>o(d??""),[o]);return t(c.Suspense,{fallback:t(C,{variant:"text",width:100}),children:t(O,{options:l,valueKey:s,onChange:e,toImg:()=>t(X,{children:" "}),label:i})})}function de({superimpose:s,setSuperimposition:o,disabled:i=!1}){return t(K,{title:s?`Superimposition ${s}`:"Superimposition 1",color:"primary",disabled:i,fullWidth:!0,children:Y.map(n=>a(E,{selected:s===n,disabled:s===n,onClick:()=>o(n),children:["Superimposition ",n]},n))})}function he({level:s,ascension:o,setLevelAscension:i,disabled:n=!1}){return t(K,{title:s?`Lv. ${s}/${b[o]}`:"Select Level",color:"primary",disabled:n,fullWidth:!0,children:Z.map(([l,e])=>t(E,{selected:s===l&&o===e,disabled:s===l&&o===e,onClick:()=>i(l,e),children:l===b[e]?`Lv. ${l}`:`Lv. ${l}/${b[e]}`},`${l}/${e}`))})}const ue={xs:1,sm:2,md:3,lg:3,xl:4},pe={xs:10,sm:12,md:24,lg:24,xl:24};function me(){const{database:s}=A(),[o,i]=M();c.useEffect(()=>s.lightCones.followAny(i),[s,i]);const{lightConeIds:n,totalLightConeNum:l}=c.useMemo(()=>{const x=s.lightCones.values.length,y=s.lightCones.keys;return o&&{lightConeIds:y,totalLightConeNum:x}},[s,o]),e=V(),d=n.length!==l?`${n.length}/${l}`:`${l}`,{numShow:g,setTriggerElement:m}=ee(pe[e],n.length),f=c.useMemo(()=>n.slice(0,g),[n,g]),r={numShowing:f.length,total:d};return t($,{children:a(oe,{defaultExpanded:!0,children:[t(te,{expandIcon:t(ne,{}),children:"Light Cones"}),t(se,{children:a(c.Suspense,{fallback:t(C,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:300}}),children:[t(v,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:a(p,{color:"text.secondary",children:["Showing ",t("b",{children:r.numShowing})," out of"," ",r.total," Items"]})}),a(v,{my:1,display:"flex",flexDirection:"column",gap:1,children:[t(u,{container:!0,spacing:1,columns:ue,children:f.sort((h,x)=>h.localeCompare(x)).map(h=>t(u,{item:!0,xs:1,children:t(re,{lightConeId:h})},h))}),n.length!==f.length&&t(C,{ref:h=>{h&&m(h)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})})]})})}function fe(){return t(v,{my:1,display:"flex",flexDirection:"column",gap:1,children:a(c.Suspense,{fallback:!1,children:[t(le,{}),t(me,{})]})})}export{fe as default};
