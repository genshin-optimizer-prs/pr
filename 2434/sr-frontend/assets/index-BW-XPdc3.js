import{a as se,g as ie,s as I,_ as k,r as m,u as le,ac as Wt,ad as Kt,e as ce,U as Ie,ae as Vt,af as qt,j as w,f as H,h as de,ag as qe,P as Gt,ah as Ut,ai as Ht,aj as Ee,b as j,ak as Pe,al as Ft,l as Jt,d as Xt,q as g,n as o,H as M,E as $,m as _,am as Re,N as D,an as Qt,Z as dt,ao as Ge,X as W,L,G as E,ap as Yt,$ as ze,F as ue,aq as Zt,ar as er,i as pe,k as me,as as ut,at as J,au as P,av as ae,Y as oe,S as tr,aw as rr,a2 as F,ax as ar,ay as or,y as Ue,C as He,B as nr,az as Se,aA as pt,aB as xe,aC as sr,ab as mt,V as ft,aD as ir,I as lr,W as cr,aE as dr,aF as Fe,p as ur,aG as fe,aH as ht,aI as pr,aJ as Je,aK as gt,aL as bt,aM as mr,aN as fr,aO as hr,aP as gr,aQ as br,aR as Xe}from"./index-tGVF7vES.js";import{d as vr,b as xr,u as vt,S as _e,C as yr,a as Cr}from"./CharacterEditor-BygC5t2m.js";import{u as kr,C as $r}from"./useForceUpdate-Dw-M4J3L.js";import{s as Sr,t as wr,w as Mr,c as Rr,l as _r,r as Dr,a as Tr,d as Ir}from"./index-Bas3Zt0N.js";import{u as Er}from"./useLightCone-DdrS4GEH.js";import{T as xt,d as Pr,M as he,D as ge}from"./DropdownButton-U3vpLmK0.js";import{G as zr,d as yt}from"./LocationAutocomplete-BwVe1CRB.js";import{C as Ct}from"./CardActionArea-Bj6wfayy.js";import{u as Ar,R as Br,b as Nr,D as jr}from"./RelicCard-BBtU22gw.js";import{I as Lr}from"./InfoTooltip-B2EswVS5.js";function Or(e){return se("MuiCollapse",e)}ie("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Wr=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],Kr=e=>{const{orientation:t,classes:r}=e,a={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return de(a,Or,r)},Vr=I("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.orientation],r.state==="entered"&&t.entered,r.state==="exited"&&!r.in&&r.collapsedSize==="0px"&&t.hidden]}})(({theme:e,ownerState:t})=>k({height:0,overflow:"hidden",transition:e.transitions.create("height")},t.orientation==="horizontal"&&{height:"auto",width:0,transition:e.transitions.create("width")},t.state==="entered"&&k({height:"auto",overflow:"visible"},t.orientation==="horizontal"&&{width:"auto"}),t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&{visibility:"hidden"})),qr=I("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>k({display:"flex",width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),Gr=I("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})(({ownerState:e})=>k({width:"100%"},e.orientation==="horizontal"&&{width:"auto",height:"100%"})),kt=m.forwardRef(function(t,r){const a=le({props:t,name:"MuiCollapse"}),{addEndListener:n,children:s,className:l,collapsedSize:p="0px",component:d,easing:u,in:c,onEnter:i,onEntered:f,onEntering:h,onExit:b,onExited:v,onExiting:C,orientation:S="vertical",style:R,timeout:y=Wt.standard,TransitionComponent:z=Kt}=a,Y=ce(a,Wr),K=k({},a,{orientation:S,collapsedSize:p}),A=Kr(K),Z=Ie(),we=Vt(),B=m.useRef(null),ee=m.useRef(),V=typeof p=="number"?`${p}px`:p,O=S==="horizontal",te=O?"width":"height",be=m.useRef(null),Pt=qt(r,be),q=x=>T=>{if(x){const N=be.current;T===void 0?x(N):x(N,T)}},Me=()=>B.current?B.current[O?"clientWidth":"clientHeight"]:0,zt=q((x,T)=>{B.current&&O&&(B.current.style.position="absolute"),x.style[te]=V,i&&i(x,T)}),At=q((x,T)=>{const N=Me();B.current&&O&&(B.current.style.position="");const{duration:re,easing:ve}=qe({style:R,timeout:y,easing:u},{mode:"enter"});if(y==="auto"){const Ve=Z.transitions.getAutoHeightDuration(N);x.style.transitionDuration=`${Ve}ms`,ee.current=Ve}else x.style.transitionDuration=typeof re=="string"?re:`${re}ms`;x.style[te]=`${N}px`,x.style.transitionTimingFunction=ve,h&&h(x,T)}),Bt=q((x,T)=>{x.style[te]="auto",f&&f(x,T)}),Nt=q(x=>{x.style[te]=`${Me()}px`,b&&b(x)}),jt=q(v),Lt=q(x=>{const T=Me(),{duration:N,easing:re}=qe({style:R,timeout:y,easing:u},{mode:"exit"});if(y==="auto"){const ve=Z.transitions.getAutoHeightDuration(T);x.style.transitionDuration=`${ve}ms`,ee.current=ve}else x.style.transitionDuration=typeof N=="string"?N:`${N}ms`;x.style[te]=V,x.style.transitionTimingFunction=re,C&&C(x)}),Ot=x=>{y==="auto"&&we.start(ee.current||0,x),n&&n(be.current,x)};return w.jsx(z,k({in:c,onEnter:zt,onEntered:Bt,onEntering:At,onExit:Nt,onExited:jt,onExiting:Lt,addEndListener:Ot,nodeRef:be,timeout:y==="auto"?null:y},Y,{children:(x,T)=>w.jsx(Vr,k({as:d,className:H(A.root,l,{entered:A.entered,exited:!c&&V==="0px"&&A.hidden}[x]),style:k({[O?"minWidth":"minHeight"]:V},R),ref:Pt},T,{ownerState:k({},K,{state:x}),children:w.jsx(qr,{ownerState:k({},K,{state:x}),className:A.wrapper,ref:B,children:w.jsx(Gr,{ownerState:k({},K,{state:x}),className:A.wrapperInner,children:s})})}))}))});kt.muiSupportAuto=!0;const $t=kt,Ur=m.createContext({}),St=Ur;function Hr(e){return se("MuiAccordion",e)}const Fr=ie("MuiAccordion",["root","rounded","expanded","disabled","gutters","region"]),ye=Fr,Jr=["children","className","defaultExpanded","disabled","disableGutters","expanded","onChange","square","slots","slotProps","TransitionComponent","TransitionProps"],Xr=e=>{const{classes:t,square:r,expanded:a,disabled:n,disableGutters:s}=e;return de({root:["root",!r&&"rounded",a&&"expanded",n&&"disabled",!s&&"gutters"],region:["region"]},Hr,t)},Qr=I(Gt,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${ye.region}`]:t.region},t.root,!r.square&&t.rounded,!r.disableGutters&&t.gutters]}})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${ye.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${ye.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}},({theme:e})=>({variants:[{props:t=>!t.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:t=>!t.disableGutters,style:{[`&.${ye.expanded}`]:{margin:"16px 0"}}}]})),Yr=m.forwardRef(function(t,r){const a=le({props:t,name:"MuiAccordion"}),{children:n,className:s,defaultExpanded:l=!1,disabled:p=!1,disableGutters:d=!1,expanded:u,onChange:c,square:i=!1,slots:f={},slotProps:h={},TransitionComponent:b,TransitionProps:v}=a,C=ce(a,Jr),[S,R]=Ut({controlled:u,default:l,name:"Accordion",state:"expanded"}),y=m.useCallback(O=>{R(!S),c&&c(O,!S)},[S,c,R]),[z,...Y]=m.Children.toArray(n),K=m.useMemo(()=>({expanded:S,disabled:p,disableGutters:d,toggle:y}),[S,p,d,y]),A=k({},a,{square:i,disabled:p,disableGutters:d,expanded:S}),Z=Xr(A),we=k({transition:b},f),B=k({transition:v},h),[ee,V]=Ar("transition",{elementType:$t,externalForwardedProps:{slots:we,slotProps:B},ownerState:A});return w.jsxs(Qr,k({className:H(Z.root,s),ref:r,ownerState:A,square:i},C,{children:[w.jsx(St.Provider,{value:K,children:z}),w.jsx(ee,k({in:S,timeout:"auto"},V,{children:w.jsx("div",{"aria-labelledby":z.props.id,id:z.props["aria-controls"],role:"region",className:Z.region,children:Y})}))]}))}),Qe=Yr;function Zr(e){return se("MuiAccordionDetails",e)}ie("MuiAccordionDetails",["root"]);const ea=["className"],ta=e=>{const{classes:t}=e;return de({root:["root"]},Zr,t)},ra=I("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({padding:e.spacing(1,2,2)})),aa=m.forwardRef(function(t,r){const a=le({props:t,name:"MuiAccordionDetails"}),{className:n}=a,s=ce(a,ea),l=a,p=ta(l);return w.jsx(ra,k({className:H(p.root,n),ref:r,ownerState:l},s))}),Ye=aa;function oa(e){return se("MuiAccordionSummary",e)}const na=ie("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),G=na,sa=["children","className","expandIcon","focusVisibleClassName","onClick"],ia=e=>{const{classes:t,expanded:r,disabled:a,disableGutters:n}=e;return de({root:["root",r&&"expanded",a&&"disabled",!n&&"gutters"],focusVisible:["focusVisible"],content:["content",r&&"expanded",!n&&"contentGutters"],expandIconWrapper:["expandIconWrapper",r&&"expanded"]},oa,t)},la=I(Ht,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],t),[`&.${G.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${G.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${G.disabled})`]:{cursor:"pointer"},variants:[{props:r=>!r.disableGutters,style:{[`&.${G.expanded}`]:{minHeight:64}}}]}}),ca=I("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:t=>!t.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${G.expanded}`]:{margin:"20px 0"}}}]})),da=I("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${G.expanded}`]:{transform:"rotate(180deg)"}})),ua=m.forwardRef(function(t,r){const a=le({props:t,name:"MuiAccordionSummary"}),{children:n,className:s,expandIcon:l,focusVisibleClassName:p,onClick:d}=a,u=ce(a,sa),{disabled:c=!1,disableGutters:i,expanded:f,toggle:h}=m.useContext(St),b=S=>{h&&h(S),d&&d(S)},v=k({},a,{expanded:f,disabled:c,disableGutters:i}),C=ia(v);return w.jsxs(la,k({focusRipple:!1,disableRipple:!0,disabled:c,component:"div","aria-expanded":f,className:H(C.root,s),focusVisibleClassName:H(C.focusVisible,p),onClick:b,ref:r,ownerState:v},u,{children:[w.jsx(ca,{className:C.content,ownerState:v,children:n}),l&&w.jsx(da,{className:C.expandIconWrapper,ownerState:v,children:l})]}))}),Ze=ua;function pa(e){return se("MuiLinearProgress",e)}ie("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const ma=["className","color","value","valueBuffer","variant"];let X=e=>e,et,tt,rt,at,ot,nt;const De=4,fa=Ee(et||(et=X`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),ha=Ee(tt||(tt=X`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),ga=Ee(rt||(rt=X`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),ba=e=>{const{classes:t,variant:r,color:a}=e,n={root:["root",`color${j(a)}`,r],dashed:["dashed",`dashedColor${j(a)}`],bar1:["bar",`barColor${j(a)}`,(r==="indeterminate"||r==="query")&&"bar1Indeterminate",r==="determinate"&&"bar1Determinate",r==="buffer"&&"bar1Buffer"],bar2:["bar",r!=="buffer"&&`barColor${j(a)}`,r==="buffer"&&`color${j(a)}`,(r==="indeterminate"||r==="query")&&"bar2Indeterminate",r==="buffer"&&"bar2Buffer"]};return de(n,pa,t)},Ae=(e,t)=>t==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:e.palette.mode==="light"?Jt(e.palette[t].main,.62):Xt(e.palette[t].main,.5),va=I("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`color${j(r.color)}`],t[r.variant]]}})(({ownerState:e,theme:t})=>k({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:Ae(t,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),xa=I("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.dashed,t[`dashedColor${j(r.color)}`]]}})(({ownerState:e,theme:t})=>{const r=Ae(t,e.color);return k({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},Pe(at||(at=X`
    animation: ${0} 3s infinite linear;
  `),ga)),ya=I("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${j(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar1Indeterminate,r.variant==="determinate"&&t.bar1Determinate,r.variant==="buffer"&&t.bar1Buffer]}})(({ownerState:e,theme:t})=>k({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${De}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${De}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&Pe(ot||(ot=X`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),fa)),Ca=I("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.bar,t[`barColor${j(r.color)}`],(r.variant==="indeterminate"||r.variant==="query")&&t.bar2Indeterminate,r.variant==="buffer"&&t.bar2Buffer]}})(({ownerState:e,theme:t})=>k({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(t.vars||t).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:Ae(t,e.color),transition:`transform .${De}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&Pe(nt||(nt=X`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),ha)),ka=m.forwardRef(function(t,r){const a=le({props:t,name:"MuiLinearProgress"}),{className:n,color:s="primary",value:l,valueBuffer:p,variant:d="indeterminate"}=a,u=ce(a,ma),c=k({},a,{color:s,variant:d}),i=ba(c),f=Ft(),h={},b={bar1:{},bar2:{}};if((d==="determinate"||d==="buffer")&&l!==void 0){h["aria-valuenow"]=Math.round(l),h["aria-valuemin"]=0,h["aria-valuemax"]=100;let v=l-100;f&&(v=-v),b.bar1.transform=`translateX(${v}%)`}if(d==="buffer"&&p!==void 0){let v=(p||0)-100;f&&(v=-v),b.bar2.transform=`translateX(${v}%)`}return w.jsxs(va,k({className:H(i.root,n),ownerState:c,role:"progressbar"},h,{ref:r},u,{children:[d==="buffer"?w.jsx(xa,{className:i.dashed,ownerState:c}):null,w.jsx(ya,{className:i.bar1,ownerState:c,style:b.bar1}),d==="determinate"?null:w.jsx(Ca,{className:i.bar2,ownerState:c,style:b.bar2})]}))}),$a=ka;function Sa({avatar:e,title:t,action:r}){return g($,{display:"flex",gap:1,p:2,alignItems:"center",children:[e,o(M,{variant:"subtitle1",sx:{flexGrow:1},children:t}),r&&o(M,{variant:"caption",children:r})]})}function wa({condition:e,wrapper:t,falseWrapper:r,children:a}){return e?t(a):r?r(a):a}function Ma({value:e,onChange:t,float:r=!1,...a}){const[n,s]=m.useState(e==null?void 0:e.toString()),{min:l,max:p}=(a==null?void 0:a.inputProps)??{};m.useEffect(()=>{s(e==null?void 0:e.toString())},[e]);const d=()=>{const i=r?parseFloat(n):parseInt(n);if(l!==void 0&&i<l){t(l),s(l.toString());return}if(p!==void 0&&i>p){t(p),s(p.toString());return}t(i)},u=i=>{const f=i.target.value;if(f.match(r?/[^0-9.-]/:/[^0-9-]/))return i.preventDefault();s(f)},c=i=>{i.target.select()};return o(xt,{value:n==null?void 0:n.toString(),onChange:u,onBlur:d,onFocus:c,onKeyDown:i=>i.key==="Enter"&&!a.multiline&&d(),...a,inputProps:{inputMode:"numeric",...a.inputProps??{}}})}function st({value:e,onChange:t,...r}){const[a,n]=m.useState(e);m.useEffect(()=>{n(e)},[e]);const s=()=>t(a);return o(xt,{value:a,onChange:l=>n(l.target.value),onBlur:s,onKeyDown:l=>l.key==="Enter"&&!r.multiline&&s(),...r})}function Ra(e){const{t}=_("ui"),r=Re({path:"/:page/*"}),a=t("pageTitle"),n=e??((r==null?void 0:r.params.page)&&t(`tabs.${r==null?void 0:r.params.page}`));m.useEffect(()=>{n?document.title=`${n} - ${a}`:document.title=a},[t,a,n])}function Be(e,t){const[r,a]=kr(),n=m.useMemo(()=>r&&e.get(t),[r,e,t]);return m.useEffect(()=>e.follow(t,a),[e,t,a]),n}function _a(e){const{database:t}=D();return Be(t.builds,e??"")}function wt(e){const t=m.useMemo(()=>e||Qt(dt,()=>""),[e]),{database:r}=D(),[a,n]=m.useState(()=>Ge(t,s=>r.relics.get(s)));return m.useEffect(()=>{n(Ge(t,l=>r.relics.get(l)));const s=Object.values(t).map(l=>r.relics.follow(l,(p,d,u)=>{d==="update"&&n(c=>({...c,[u.slotKey]:u})),d==="remove"&&n(c=>({...c,[u.slotKey]:void 0}))}));return()=>s.forEach(l=>l())},[r,t]),a}function U(e){const{database:t}=D();return Be(t.loadouts,e??"")}function Mt(e){const{database:t}=D();return Be(t.teams,e)}function Da({slot:e}){const{t}=_("relic");return o(L,{sx:{height:"100%"},children:g(W,{children:[g(M,{children:[t("slot"),": ",e]}),o(M,{children:t("empty")})]})})}function Ta({build:e}){const t=wt(e);return o(E,{container:!0,columns:3,spacing:1,children:dt.map(r=>{const a=t[r];return o(E,{item:!0,xs:1,children:a?o(Br,{relic:a}):o(Da,{slot:r})},`${r}_${a==null?void 0:a.id}`)})})}function Ia({charKey:e,setCharKey:t}){const{t:r}=_(["character","charNames_gen"]),{database:a}=D(),n=m.useCallback(p=>!!a.chars.get(p),[a.chars]),s=m.useCallback(p=>a.charMeta.get(p).favorite,[a.charMeta]),l=m.useMemo(()=>[{key:"",label:r("character:autocomplete.none")},...Yt.map(p=>({key:p,label:r(`charNames_gen:${p}`),favorite:s(p),color:n(p)?void 0:"secondary"}))],[n,s,r]);return o(m.Suspense,{fallback:o(ze,{variant:"text",width:100}),children:o(zr,{options:l,toImg:()=>o(ue,{children:" "}),valueKey:e,onChange:p=>t(p??"")})})}function Ea(e){return["basic","skill","ult","talent"].includes(e)}const Pa={Arlan:Zt,RuanMei:er};var Ne={},za=me;Object.defineProperty(Ne,"__esModule",{value:!0});var $e=Ne.default=void 0,Aa=za(pe()),Ba=w,Na=(0,Aa.default)((0,Ba.jsx)("path",{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}),"Groups");$e=Ne.default=Na;function ja({document:e,bgt:t="normal",collapse:r=!1,setConditional:a}){switch(e.type){case"fields":return o(La,{fieldsDocument:e,bgt:t});case"text":return r?o(Oa,{textDocument:e}):o(Rt,{textDocument:e});case"conditional":return o(Wa,{conditional:e.conditional,setConditional:a,bgt:t});default:return null}}function La({fieldsDocument:e,bgt:t="normal"}){return g(L,{bgt:t,children:[e.header&&o(_t,{header:e.header,hideDivider:e.fields.length===0}),o(ut,{bgt:t,fields:e.fields})]})}function Rt({textDocument:e}){const t=m.useContext(J);return t?o("div",{children:P(e.text,t)}):null}function Oa({textDocument:e}){const[t,r]=m.useState(!1),[a,n]=m.useState(!1);return g($,{sx:{position:"relative"},children:[!t&&o($,{sx:{pointerEvents:"none",position:"absolute",mx:"auto",width:"100%",display:"flex",justifyContent:"center",height:"100%",alignItems:"flex-end",zIndex:"10",transition:"transform 0.3s ease",transform:a?"translate(0,-5px)":void 0},children:o(Pr,{})}),o($t,{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),collapsedSize:55,onClick:()=>r(s=>!s),in:t,sx:{cursor:"pointer",position:"relative",maskImage:t?void 0:"linear-gradient(to bottom, black 0%, transparent 100%)","&:hover":{maskImage:t?void 0:"linear-gradient(to bottom, black 50%, transparent 100%)"}},children:o(Rt,{textDocument:e})})]})}function _t({header:e,hideDivider:t}){const{icon:r,text:a,additional:n}=e;return g(ue,{children:[o(Sa,{avatar:r,title:a,action:n}),!t&&o(ae,{})]})}function Wa({conditional:e,bgt:t="normal",setConditional:r}){const{header:a,fields:n}=e;return g(L,{bgt:t,children:[!!a&&o(_t,{header:a}),o(Ka,{conditional:e,setConditional:r}),!!n&&o(ut,{bgt:t,fields:n})]})}function Ka({conditional:e,setConditional:t}){switch(e.metadata.type){case"bool":return o(Va,{conditional:e,setConditional:t});case"list":return o(qa,{conditional:e,setConditional:t});case"num":return o(Ga,{conditional:e,setConditional:t});default:return null}}function ne({children:e}){return e?o(tr,{sx:{ml:1},children:e}):null}function je(e,t,r,a){return e.compute(rr({et:"own",qt:"cond",sheet:t,q:r,src:a,dst:e.cache.tag.src},"max")).val}function Va({conditional:e,setConditional:t}){const r=m.useContext(J),{label:a,badge:n}=e,{sheet:s,name:l}=e.metadata;if(!s||!l)throw new Error("metadata missing");if(!r)return null;const p="all",d=je(r,s,l,p),u=P(a,r,d),c=P(n,r,d);return g(oe,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:d?"success":"primary",onClick:()=>t(p,s,l,+!d),startIcon:d?o(vr,{}):o(xr,{}),children:[u," ",o(ne,{children:c})]})}function qa({conditional:e,setConditional:t}){const r=m.useContext(J),{label:a,badge:n}=e,{sheet:s,name:l,list:p}=e.metadata;if(!s||!l)throw new Error("metadata missing");if(!r)return null;const d="all",u=je(r,s,l,d);return g(ge,{fullWidth:!0,size:"small",sx:{borderRadius:0},color:u?"success":"primary",title:g(ue,{children:[P(a,r,u)," ",o(ne,{children:P(n,r,u)})]}),children:[o(ae,{}),["0",...p].map((c,i)=>g(he,{onClick:()=>t(d,s,l,i),selected:u===i,disabled:u===i,children:[P(a,r,i),o(ne,{children:P(n,r,i)})]},c))]})}function Ga({conditional:e,setConditional:t}){const r=m.useContext(J),{label:a,badge:n}=e,{sheet:s,name:l,int_only:p,min:d,max:u}=e.metadata;if(!s||!l)throw new Error("metadata missing");if(!r)return null;const c="all",i=je(r,s,l,c),f=P(a,r,i),h=P(n,r,i);return typeof d>"u"||typeof u>"u"?o(Ma,{fullWidth:!0,float:!p,inputProps:{min:d,max:u},InputProps:{startAdornment:f&&o($,{sx:{mr:1},children:f}),endAdornment:o(ne,{children:P(n,r,i)})},value:i,onChange:b=>t(c,s,l,b)}):g($,{sx:{px:2},children:[(f||n)&&g(M,{display:"flex",justifyContent:"space-between",children:[f," ",o(ne,{children:h})]}),o(Ua,{max:u,min:d,value:i,onChangeCommitted:(b,v)=>t(c,s,l,v),valueLabelDisplay:"auto"})]})}function Ua(e){const[t,r]=m.useState(e.value);return o(Nr,{...e,onChange:(a,n)=>r(n),value:t})}function Q(){return m.useContext(J)}function Dt({optTarget:e,setOptTarget:t}){const{t:r}=_("optimize"),a=Q();return o(ge,{title:`${r("optTarget")}${e?`: ${e.tag.name||e.tag.q}`:""}`,children:a==null?void 0:a.listFormulas(F.listing.formulas).map((n,s)=>o(he,{onClick:()=>t(n),children:n.tag.name||n.tag.q},`${s}_${n.tag.name||n.tag.q}`))})}function Ha({statFilters:e,setStatFilters:t,disabled:r=!1}){const a=m.useCallback((d,u,c)=>{const i={...e},f=JSON.stringify(u),h=u?[...e[f]]:void 0,b=JSON.stringify(d),v=[...e[b]??[]];c!==void 0&&h?v.push(h[c]):v.push({minValue:0,maxValue:0,disabled:!1}),i[b]=v,c!==void 0&&h&&(h.splice(c,1),h.length?i[f]=h:delete i[f]),t({...i})},[t,e]),n=m.useCallback((d,u)=>{const c={...e},i=JSON.stringify(d),f=[...e[i]];f.splice(u,1),f.length?c[i]=f:delete c[i],t({...c})},[t,e]),s=m.useCallback((d,u,c)=>{const i={...e},f=JSON.stringify(d),h=[...e[f]];h[u]={...h[u],minValue:c},i[f]=h,t({...i})},[t,e]),l=m.useCallback((d,u,c)=>{const i={...e},f=JSON.stringify(d),h=[...e[f]];h[u]={...h[u],maxValue:c},i[f]=h,t({...i})},[t,e]),p=m.useCallback((d,u,c)=>{const i={...e},f=JSON.stringify(d),h=[...e[f]];h[u]={...h[u],disabled:c},i[f]=h,t({...i})},[t,e]);return g(ue,{children:[Object.entries(e).flatMap(([d,u])=>u==null?void 0:u.map((c,i)=>o(it,{path:JSON.parse(d),setting:c,index:i,setTarget:a,delTarget:n,setMinValue:s,setMaxValue:l,setDisabled:p,disabled:r},d+i))),o(it,{delTarget:n,setTarget:a,setMinValue:s,setMaxValue:l,setDisabled:p,disabled:r})]})}function it({path:e,setting:t,index:r,delTarget:a,setMinValue:n,setMaxValue:s,setDisabled:l,disabled:p}){const{t:d}=_("page_character_optimize"),u=m.useCallback(b=>e&&r!==void 0&&n(e,r,b??0),[n,e,r]),c=m.useCallback(b=>e&&r!==void 0&&s(e,r,b??1/0),[s,e,r]),[i,f]=m.useState(void 0),h={p:1,flexBasis:30,flexGrow:0,flexShrink:0};return g(nr,{sx:{"& .MuiButtonGroup-grouped":{minWidth:24},width:"100%"},children:[!!t&&!!e&&r!==void 0&&o(oe,{sx:h,color:t.disabled?"secondary":"success",onClick:()=>l(e,r,!t.disabled),disabled:p,children:t.disabled?o(ar,{}):o(or,{})}),o(He,{sx:{flexBasis:150,flexGrow:1},children:o(Ue,{float:!0,disabled:!e||p,value:t==null?void 0:t.minValue,placeholder:d("buildConstraint.minStatValue"),onChange:u,sx:{px:1},inputProps:{sx:{"& + .MuiOutlinedInput-notchedOutline":{borderRadius:0},textAlign:"right"}}})}),o(Dt,{optTarget:i,setOptTarget:f}),o(He,{sx:{flexBasis:150,flexGrow:1},children:o(Ue,{float:!0,disabled:!e||p,value:t==null?void 0:t.maxValue,placeholder:d("buildConstraint.maxStatValue"),onChange:c,sx:{px:1},inputProps:{sx:{"& + .MuiOutlinedInput-notchedOutline":{borderRadius:0},textAlign:"left"}}})}),!!e&&r!==void 0&&o(oe,{sx:h,color:"error",onClick:()=>a(e,r),disabled:p,children:o(jr,{fontSize:"small"})})]})}function Fa({disabled:e=!1}){const{t}=_("page_character_optimize"),[r,a]=m.useState({});return o($,{children:g(L,{bgt:"light",children:[o(W,{sx:{display:"flex",gap:1,justifyContent:"space-between",flexDirection:"column"},children:g($,{display:"flex",justifyContent:"space-between",children:[o(M,{sx:{fontWeight:"bold"},children:t`constraintFilter.title`}),o(Lr,{title:o(M,{children:t`constraintFilter.tooltip`})})]})}),o(ae,{}),o($,{display:"flex",flexDirection:"column",gap:.5,children:o(Ha,{statFilters:r,setStatFilters:a,disabled:e})})]})})}function Ja({numWorkers:e,setNumWorkers:t}){const{t:r}=_("optimize"),a=navigator.hardwareConcurrency||8;return o(ge,{title:`${r("numWorkers")}: ${e}`,children:Se(1,a).map(n=>o(he,{onClick:()=>t(n),children:r("workers",{count:n})},n))})}function Xa({teamId:e,src:t,children:r}){var v,C,S,R;const a=Mt(e),n=U((v=a.loadoutMetadata[0])==null?void 0:v.loadoutId),s=U((C=a.loadoutMetadata[1])==null?void 0:C.loadoutId),l=U((S=a.loadoutMetadata[2])==null?void 0:S.loadoutId),p=U((R=a.loadoutMetadata[3])==null?void 0:R.loadoutId),d=m.useMemo(()=>{const y={all:"all"};return n&&(y[n.key]="0"),s&&(y[s.key]="1"),l&&(y[l.key]="2"),p&&(y[p.key]="3"),y},[n,s,l,p]),u=Ce(a.loadoutMetadata[0],d),c=Ce(a.loadoutMetadata[1],d),i=Ce(a.loadoutMetadata[2],d),f=Ce(a.loadoutMetadata[3],d),h=m.useMemo(()=>Sr([...wr(a.loadoutMetadata.map((y,z)=>y===void 0?void 0:pt[z]).filter(y=>!!y)),...u?ke(0,u):[],...c?ke(1,c):[],...i?ke(2,i):[],...f?ke(3,f):[],xe.common.lvl.add(80),xe.common.res.add(.1),xe.common.isBroken.add(0),xe.common.maxToughness.add(100),sr.common.critMode.add("avg")]),[u,c,i,f,a.loadoutMetadata]),b=m.useMemo(()=>(h==null?void 0:h.withTag({src:t}))??null,[h,t]);return o(J.Provider,{value:b,children:r})}function Ce(e,t){const r=U(e==null?void 0:e.loadoutId),a=vt(r==null?void 0:r.key),n=_a(e==null?void 0:e.buildId),s=Er(n==null?void 0:n.lightConeId),l=wt(n==null?void 0:n.relicIds),p=m.useMemo(()=>Object.fromEntries(Object.entries((r==null?void 0:r.conditional)??{}).map(([d,u])=>[t[d],u])),[r,t]);return m.useMemo(()=>({character:a,lightCone:s,relics:l,conditionals:p}),[a,s,p,l])}function ke(e,{character:t,lightCone:r,relics:a,conditionals:n}){return t?[...Mr(`${e}`,...Rr(t),..._r(r),...Dr(Object.values(a).filter(s=>!!s).map(s=>({set:s.setKey,stats:[...s.substats.filter(({key:l})=>l!=="").map(l=>({key:l.key,value:l.accurateValue})),{key:s.mainStatKey,value:s.mainStatVal}]})))),...Tr(`${e}`,n)]:[]}var Le={},Qa=me;Object.defineProperty(Le,"__esModule",{value:!0});var Tt=Le.default=void 0,Ya=Qa(pe()),Za=w,eo=(0,Ya.default)((0,Za.jsx)("path",{d:"M22 24H2v-4h20v4zM13.06 5.19l3.75 3.75L7.75 18H4v-3.75l9.06-9.06zm4.82 2.68-3.75-3.75 1.83-1.83c.39-.39 1.02-.39 1.41 0l2.34 2.34c.39.39.39 1.02 0 1.41l-1.83 1.83z"}),"BorderColor");Tt=Le.default=eo;var Oe={},to=me;Object.defineProperty(Oe,"__esModule",{value:!0});var It=Oe.default=void 0,ro=to(pe()),ao=w,oo=(0,ro.default)((0,ao.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");It=Oe.default=oo;function no({teamId:e,charKey:t,tab:r=""}){const{t:a}=_("page_team"),n=mt(),{database:s}=D(),l=s.teams.get(e),{loadoutMetadata:p}=l,d=Ie(),u=ft(d.breakpoints.down("md")),[c,i]=m.useState(!1),f=b=>{s.teams.set(e,{name:b})},h=b=>{s.teams.set(e,{description:b})};return g($,{sx:()=>({borderBottom:"1px rgb(200,200,200,0.3) solid","& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"},"& .Mui-selected":{color:"white !important"},"& .MuiTabs-indicator":{height:"4px",backgroundColor:"rgb(200,200,200,0.5)"}}),children:[o(Ct,{onClick:()=>i(!0),children:o(ir,{placement:"top",title:g($,{children:[g($,{sx:{display:"flex",color:"info.light",gap:1},children:[o(Tt,{}),o(M,{children:o("strong",{children:a`team.editNameDesc`})})]}),!!l.description&&o(M,{children:l.description})]}),children:o(W,{sx:{display:"flex",justifyContent:"center","&:hover":{color:"info.light"}},children:g(M,{variant:"h5",sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",textShadow:"#000 0 0 10px !important"},children:[o($e,{}),l.name]})})})}),o(cr,{open:c,onClose:()=>i(!1),children:g(L,{children:[o($r,{title:a`team.editNameDesc`,avatar:o($e,{}),titleTypographyProps:{variant:"h6"},action:o(lr,{onClick:()=>i(!1),children:o(yt,{})})}),o(ae,{}),o(W,{children:g($,{display:"flex",flexDirection:"column",gap:2,sx:{mt:2},children:[o(st,{label:a`team.name`,value:l.name,onChange:b=>f(b),autoFocus:!0}),o(st,{label:a`team.desc`,value:l.description,onChange:b=>h(b),multiline:!0,minRows:4})]})})]})}),o(ae,{}),g(dr,{variant:"fullWidth",value:t??"team",orientation:u?"vertical":"horizontal",children:[o(Fe,{icon:o($e,{}),iconPosition:"start",value:"team",label:"Team Settings",onClick:()=>n(`/teams/${e}/`)}),p.map((b,v)=>{var S;const C=b&&((S=s.loadouts.get(b==null?void 0:b.loadoutId))==null?void 0:S.key);return o(Fe,{icon:o(It,{}),iconPosition:"start",value:C??v,disabled:!p[v],label:C?o(M,{children:a(`charNames_gen:${C}`)}):`Character ${v+1}`,onClick:()=>C&&n(`/teams/${e}/${C}/${r}`)},v)})]})]})}function so({teamId:e}){const{database:t}=D(),r=t.teams.get(e);return g($,{children:[e,r.loadoutMetadata.map((a,n)=>o(io,{loadoutMetadataIndex:n,teamId:e},`${n}_${a==null?void 0:a.loadoutId}`))]})}function io({loadoutMetadataIndex:e,teamId:t}){var p;const{database:r}=D(),a=r.teams.get(t),n=(p=a.loadoutMetadata[e])==null?void 0:p.loadoutId,s=r.loadouts.get(n);function l(d){if(d===""){r.teams.set(t,c=>c.loadoutMetadata[e]=void 0);return}r.chars.getOrCreate(d);const u=a.loadoutMetadata.findIndex(c=>{var i;return c&&((i=r.loadouts.get(c.loadoutId))==null?void 0:i.key)===d});if(u===-1){let c=r.loadouts.keys.find(i=>r.loadouts.get(i).key===d);c||(c=r.loadouts.new(d)),r.teams.set(t,i=>{i.loadoutMetadata[e]={loadoutId:c}})}else{if(u===e)return;const c=a.loadoutMetadata[u],i=a.loadoutMetadata[e];r.teams.set(t,f=>{f.loadoutMetadata[e]=c,f.loadoutMetadata[u]=i})}}return o(Ia,{charKey:(s==null?void 0:s.key)??"",setCharKey:l})}var We={},lo=me;Object.defineProperty(We,"__esModule",{value:!0});var Te=We.default=void 0,co=lo(pe()),uo=w,po=(0,co.default)((0,uo.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");Te=We.default=po;const mo=5e4;class fo{constructor(t,r,a,n,s){this.calc=t,this.optTarget=r,this.relicsBySlot=a,this.numWorkers=n,this.setProgress=s,this.worker=new Worker(new URL(""+new URL("parentWorker-CAAYnoOP.js",import.meta.url).href,import.meta.url),{type:"module"})}async optimize(){return await new Promise((r,a)=>{this.worker.onmessage=({data:s})=>{switch(s.resultType){case"progress":this.setProgress(s.progress);break;case"done":r(s.buildResults);break;case"err":console.log(s),a();break}};const n={command:"start",relicsBySlot:this.relicsBySlot,detachedNodes:this.detachNodes(),numWorkers:this.numWorkers};this.worker.postMessage(n)})}async terminate(){const t={command:"terminate"};this.worker.postMessage(t),await new Promise((r,a)=>{this.worker.onmessage=({data:n})=>{switch(n.resultType){case"terminated":r();break;case"err":console.log(n),a();break}}}),this.worker.terminate()}detachNodes(){const t=new Set(ur);return Ir([this.optTarget],this.calc,a=>{if(a.src==="0"&&a.et==="own"){if(a.sheet==="dyn"&&a.qt==="premod")return{q:a.q};if(a.q==="count"&&t.has(a.sheet))return{q:a.sheet}}})}}var Ke={},ho=me;Object.defineProperty(Ke,"__esModule",{value:!0});var Et=Ke.default=void 0,go=ho(pe()),bo=w,vo=(0,go.default)((0,bo.jsx)("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp");Et=Ke.default=vo;function xo(){const{t:e}=_("optimize"),{database:t}=D(),r=Q(),[a,n]=m.useState(8),[s,l]=m.useState(void 0),[p,d]=m.useState(void 0),u=m.useMemo(()=>t.relics.values.reduce((R,y)=>(R[y.slotKey].push(y),R),{head:[],hands:[],feet:[],body:[],sphere:[],rope:[]}),[t.relics.values]),c=Object.values(u).reduce((R,y)=>R*y.length,1),[i,f]=m.useState(void 0),[h,b]=m.useState(!1),v=m.useRef(()=>{});m.useEffect(()=>()=>v.current(),[]);const C=m.useCallback(async()=>{if(!p||!r)return;const R=new Promise(Y=>v.current=Y);l(void 0),b(!0);const y=new fo(r,p,u,a,l);R.then(async()=>await y.terminate());const z=await y.optimize();await y.terminate(),v.current=()=>{},b(!1),f(z[0])},[r,a,p,u]),S=m.useCallback(()=>{v.current(),b(!1)},[v]);return o(L,{bgt:"dark",children:g(W,{children:[o(Fa,{}),g(_e,{children:[o(M,{variant:"h5",children:e("optimize")}),g($,{children:[o(Dt,{optTarget:p,setOptTarget:d}),o(Ja,{numWorkers:a,setNumWorkers:n}),o(oe,{onClick:h?S:C,color:h?"error":"primary",startIcon:h?o(yt,{}):o(Et,{}),children:e(h?"cancel":"optimize")})]}),s&&o(yo,{progress:s,totalPermutations:c}),i&&g($,{children:[g(M,{children:["Best: ",i.value]}),o(Ta,{build:i.ids})]})]})]})})}function yo({progress:e,totalPermutations:t}){const{t:r}=_("optimize");return g($,{children:[g(M,{children:[r("totalProgress"),": ",e.numBuildsComputed.toLocaleString()," /"," ",t.toLocaleString()]}),g(M,{children:[r("buildsKept"),": ",e.numBuildsKept.toLocaleString()," /"," ",mo.toLocaleString()]}),o($a,{variant:"determinate",value:e.numBuildsComputed/t*100})]})}const Co={xs:12,sm:6,md:4};function ko(){const{loadout:{key:e}}=fe(),t=Q(),{t:r}=_("sheet_gen"),{database:a}=D(),n=[["basic",r("ability.basic")],["skill",r("ability.skill")],["ult",r("ability.ult")],["talent",r("ability.talent")]],s=Ie(),l=ft(s.breakpoints.up("lg")),p=Pa[e],d=(t==null?void 0:t.compute(F.char.eidolon).val)??0,u=m.useMemo(()=>p&&Se(1,gt).map(c=>{const i=p[`eidolon${c}`];return i?o(lt,{talentKey:`eidolon${c}`,subtitle:g("span",{children:[r("eidolonLvl")," ",c]}),sheetElement:i,onClickTitle:()=>a.chars.set(e,{eidolon:c===d?c-1:c})}):null}),[e,p,a.chars,d,r]);if(!(!p||!t))return o(ue,{children:g(E,{container:!0,spacing:1,children:[l&&g(E,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[o(ct,{}),u&&u.map((c,i)=>o($,{sx:{opacity:d>=i+1?1:.5},children:c},i))]}),o(E,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:n.map(([c,i])=>{const f=p[c];return f?o(E,{item:!0,...Co,children:o(lt,{talentKey:c,subtitle:i,sheetElement:f})},c):null})}),!l&&o(E,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:o(E,{item:!0,xs:12,children:o(ct,{})})})]})})}function lt({sheetElement:e,talentKey:t,subtitle:r,onClickTitle:a}){const{loadout:{key:n}}=fe(),s=m.useCallback(c=>o(Ct,{onClick:a,children:c}),[a]);let l=null;l=null,Ea(t)&&(l=o($o,{talentKey:t,dropDownButtonProps:{sx:{borderRadius:0}},setTalent:c=>d.chars.set(n,i=>{i[t]=c})}));const{loadoutId:p}=m.useContext(ht),{database:d}=D(),u=m.useCallback((c,i,f,h)=>{d.loadouts.set(p,b=>(b=structuredClone(b),pr(b.conditional,[c,i,f],h),b))},[d,p]);return g(L,{bgt:"light",sx:{height:"100%"},children:[l,g(W,{children:[o(wa,{condition:!!a,wrapper:s,children:g(E,{container:!0,sx:{flexWrap:"nowrap"},children:[o(E,{item:!0,children:o($,{component:Je?Je:"img",src:e==null?void 0:e.img,sx:{width:60,height:"auto"}})}),g(E,{item:!0,flexGrow:1,sx:{pl:1},children:[o(M,{variant:"h6",children:e==null?void 0:e.name}),o(M,{variant:"subtitle1",children:r})]})]})}),e.documents.map((c,i)=>o(ja,{document:c,collapse:!0,setConditional:u},i))]})]})}function ct(){const{t:e}=_("sheet_gen"),t=Q(),{loadout:{key:r}}=fe(),{database:a}=D();if(!t)return null;const n=t.compute(F.char.eidolon).val;return o(ge,{fullWidth:!0,title:g("span",{children:[e("eidolonLvl")," ",n]}),color:"primary",children:Se(0,gt).map(s=>o(he,{selected:n===s,disabled:n===s,onClick:()=>a.chars.set(r,{eidolon:s}),children:g("span",{children:[e("eidolonLvl")," ",s]})},s))})}function $o({talentKey:e,setTalent:t,dropDownButtonProps:r}){const{t:a}=_("sheet_gen"),{character:n}=bt(),s=Q();if(!s||!n)return null;const l=0,p=s.compute(F.char[e]).val,d=s.compute(F.char.ascension).val;return o(ge,{fullWidth:!0,title:g("span",{children:[a("lvl")," ",p]}),color:"primary",...r,children:Se(1,mr[d]).map(u=>o(he,{selected:n[e]===u,disabled:n[e]===u,onClick:()=>t(u),children:g("span",{children:[a("lvl")," ",u+l]})},u))})}function So({tab:e}){const{loadout:{key:t}}=fe(),{character:r}=bt(),a=Q(),[n,s]=m.useState(void 0);return g($,{children:[e,o(yr,{characterKey:n,onClose:()=>s(void 0)}),o(Cr,{character:r}),g(_e,{gap:1,pt:1,children:[o(L,{bgt:"dark",children:g(W,{children:[o(oe,{disabled:!t,onClick:()=>t&&s(t),children:"Edit Character"}),g(Qe,{children:[o(Ze,{expandIcon:o(Te,{}),children:"All target values, if sheet is created"}),o(Ye,{children:o(_e,{children:a==null?void 0:a.listFormulas(F.listing.formulas).map((l,p)=>{const d=a.compute(l),u=l.tag.name||l.tag.q;return g($,{children:[g(M,{children:[u,": ",d.val]}),g(Qe,{children:[g(Ze,{expandIcon:o(Te,{}),children:["debug for ",u]}),o(Ye,{children:o(M,{component:"pre",children:JSON.stringify(a.toDebug().compute(l),void 0,2)})})]})]},`${u}${p}`)})})})]})]})}),o(ko,{}),o(xo,{})]})]})}const wo=o(ze,{variant:"rectangular",width:"100%",height:1e3});function jo(){const{database:e}=D(),{teamId:t}=fr(),r=!t||!e.teams.keys.includes(t);return m.useEffect(()=>{r||e.teams.set(t,{lastEdit:Date.now()})},[t,e.teams,r]),r?o(gr,{to:"/teams"}):o($,{display:"flex",flexDirection:"column",gap:1,children:o(m.Suspense,{fallback:wo,children:t&&o(Mo,{teamId:t})})})}function Mo({teamId:e}){var b;const{database:t}=D(),r=mt(),a=Mt(e),{loadoutMetadata:n}=a,{params:{characterKey:s}}=Re({path:"/teams/:teamId/:characterKey",end:!1})??{params:{}},{params:{tab:l}}=Re({path:"/teams/:teamId/:characterKey/:tab"})??{params:{}},p=m.useMemo(()=>n.findIndex(v=>{var C;return(v==null?void 0:v.loadoutId)&&((C=t.loadouts.get(v.loadoutId))==null?void 0:C.key)===s}),[n,t.loadouts,s]),d=m.useMemo(()=>n[p],[n,p]);m.useEffect(()=>{window.scrollTo({top:0})},[]),m.useEffect(()=>{d||r("",{replace:!0})},[d,r]);const u=d==null?void 0:d.loadoutId,c=(b=t.loadouts.get(u))==null?void 0:b.key,{t:i}=_(["charNames_gen","page_character"]);Ra(m.useMemo(()=>{const v=i(c?"charNames_gen:Character":"Team Settings"),C=l?i(`page_character:tabs.${l}`):c?i("Loadout/Build"):l;return`${a.name} - ${v}${C?` - ${C}`:""}`},[c,i,l,a.name]));const f=U(u??""),h=m.useMemo(()=>{if(!(!u||!f||!d))return{teamId:e,team:a,loadoutId:u,loadout:f,loadoutMetadatum:d}},[d,a,f,u,e]);return o(Xa,{teamId:e,src:pt[p],children:g($,{sx:{display:"flex",gap:1,flexDirection:"column",mx:1,mt:2},children:[o(L,{children:o(no,{teamId:e,charKey:c,tab:l})}),o($,{children:h?o(ht.Provider,{value:h,children:o(Ro,{})}):o(so,{teamId:e})})]})})}function Ro({tab:e}){const{loadout:{key:t}}=fe(),r=vt(t),a=m.useMemo(()=>r&&{character:r},[r]);return a?o(hr.Provider,{value:a,children:o(br,{children:o(Xe,{path:":characterKey",children:o(Xe,{path:"*",index:!0,element:o(So,{tab:e})})})})}):o(ze,{variant:"rectangular",width:"100%",height:1e3})}export{jo as default};
